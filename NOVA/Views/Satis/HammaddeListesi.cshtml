

@{

    Layout = "/Views/Shared/_Layout_hammaddelistesi.cshtml";
}
@model NOVA.Models.SiparisModel

<!DOCTYPE html>

<html>
<head>

    <!-- Fonts -->
    <!-- Icons. Uncomment required icon fonts -->
    <!-- Core CSS -->



    <meta name="viewport" content="user-scalable=no, width=device-width" />

    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <!-- Page CSS -->
    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->

    <link href="~/assets/vendor/css/cssprogress.min.css" rel="stylesheet" />

    <link href="~/assets/vendor/css/accordion.css" rel="stylesheet" />
    <link href="~/assets/vendor/css/Chart.css" rel="stylesheet" />






    <style>
        .heart {
            animation: heartbeat 1s infinite alternate;
        }

        @@keyframes heartbeat {
            from {
                opacity: 0.3;
                transform: scale(0.32);
            }

            to {
                opacity: 1;
                transform: scale(0.40);
            }
        }
        tbody tr:hover {
            background-color: transparent;
            color: black;
            transform: scale(1.01);
        }

        .centercontent {
            position: absolute;
            max-width: 100%;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 5;
        }


        .btn-grad {
            background-image: linear-gradient(to right, #616161 0%, #9bc5c3 51%, #616161 100%);
            margin: 10px;
            padding: 5px 15px;
            text-align: center;
            text-transform: uppercase;
            transition: 0.5s;
            background-size: 200% auto;
            color: white;
            box-shadow: 0 0 20px #eee;
            border-radius: 10px;
            display: block;
            border-style: none;
        }

            .btn-grad:hover {
                background-position: right center; /* change the direction of the change here */
                color: #fff;
                text-decoration: none;
            }

        .btn1:hover {
            background-position: right center; /* change the direction of the change here */
            color: #009ffb;
            text-decoration: none;
        }

        .btn1 {
            display: inline-block;
            font-weight: 400;
            line-height: 1.53;
            color: #697a8d;
            text-align: center;
            vertical-align: middle;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
            background-color: transparent;
            border: 1px solid transparent;
            padding: 0.4375rem 1.25rem;
            padding-top: 0.4375rem;
            padding-right: 1.25rem;
            padding-bottom: 0.4375rem;
            padding-left: 1.25rem;
            font-size: 0.9375rem;
            border-radius: 0.375rem;
            transition: all 0.2s ease-in-out;
        }
    </style>
    <style>
        
        tr {
            animation: fadeInAnimation ease 3s;
            animation-iteration-count: 1;
            animation-fill-mode: forwards;
        }
        @@keyframes fadeInAnimation {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }
    </style>
    <script data-require="jquery@2.0.3" data-semver="2.0.3" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>

    <script src="~/assets/vendor/css/scripts.js"></script>
</head>
<body onload="move()" onclose="close()" style="background-color: #f5f5f9 !important;font-size:12px !important;overflow:hidden">
   

    <div class="container-fluid mt-1">
        <div class="centercontent" style="margin-left: 5%">
            <div class="heart"><img id="progress" src="~/images/novasaydam.png" style="max-width:15vw" /></div>
            </div>
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm">
                    <label class="text-nowrap" style="font-weight:bold">Rulo Sac Kodu</label>
                    <select class="form-select" id="rulokodufilter" name="states[]" multiple="multiple" onchange="change()">
                    </select>

                </div>
                <div class="col-sm">
                    <label style="font-weight:bold">Renk Kodu</label>
                    <select class="form-select" id="renkkodufilter" name="states[]" multiple="multiple" onchange="changerenk()">
                    </select>

                </div>
                <div class="col-sm">
                    <label style="font-weight:bold">Kalınlık</label>
                    <select class="form-select" id="kalinlikfilter" name="states[]" multiple="multiple" onchange="changekal()">
                    </select>

                </div>
                <div class="col-sm">
                    <label style="font-weight:bold">Genişlik</label>
                    <select class="form-select" id="genislikfilter" name="states[]" multiple="multiple" onchange="changegen()">
                    </select>

                </div>
                <div class="col-sm">
                    <label style="font-weight:bold">Menşei</label>
                    <select id="menseifilter" class="form-select" name="states[]" multiple="multiple" onchange="changemen()">
                    </select>

                </div>
            </div>
            <div class="row mt-2">
                <div class="col d-flex">

                    <button class="btn1 me-2" style="background-color: white; border-style: none;" onclick="white()"> <i class='bx bxs-filter-alt'></i> Hazır Stoklar</button>

                </div>
                <div class="col d-flex">


                    <button class="btn1 me-2" style="background-color: #EAFFF1; border-style: none;" onclick="kural1()"><i class='bx bxs-filter-alt'></i> İş Emri Verilen Stoklar</button>

                </div>
                <div class="col d-flex">


                    <button class="btn1 me-2" style="background-color: #EAF1FF;border-style:none;" onclick="kural3()"><i class='bx bxs-filter-alt'></i> Üretim Bekleyenler</button>

                </div>
                <div class="col d-flex">


                    <button class="btn me-2" style="background-color: #F1EAFF;cursor:default"> Opsiyonlanmış Stoklar </button>

                </div>

                <div class="col d-flex">
                    <button class="btn-grad float-end" id="genis" onclick="genislet()" data-bs-toggle="tooltip" data-bs-offset="0,4" data-bs-placement="top" data-bs-html="true" data-bs-original-title="<i class='bx bxs-filter-alt bx-flashing' ></i> <span>Genişlet</span>"><i class='bx bx-expand-horizontal'></i></button>
                    <button class="btn-grad float-end" onclick="refresh()" data-bs-toggle="tooltip" data-bs-offset="0,4" data-bs-placement="top" data-bs-html="true" data-bs-original-title="<i class='bx bxs-filter-alt bx-flashing' ></i> <span>Filtreyi Temizle</span>"><i class='bx bxs-trash'></i></button>
                </div>


            </div>
        </div>
        <div class="row mt-1 mb-1 d-flex">
            <div class="col">
                <label id="topton" class="float-start"><b>∑ Seçilen Stok Miktarı:</b> </label>
            </div>

        </div>
        <div class="row mb-1 d-flex">
            <div class="col">
                <label id="ortfiyat" class="float-start"><b>Ağ. Ort. Fiyat:</b> </label>
                <label class="float-end"><b>Son Güncelleme Tarihi: </b> @ViewBag.LastModified </label>
            </div>

        </div>
        <div class="row">
            <div class="col">



                <div class="card" style="max-height:70vh;" id="table">

                    <div role="region" aria-labelledby="HeadersCol" tabindex="0" class="rowheaders">
                        <table class="table table-responsive sorttable " id="sorttable">
                            <thead class="table-secondary ">
                                <tr class="sticky-top text-nowrap">
                                    <th style="text-align: center; position: sticky; left: 0;">RULO KODU</th>
                                    @*<th style="text-align: center; ">BOBIN NO</th>*@
                                    <th style="text-align: center; ">KONUM</th>
                                    <th style="text-align: center; ">RENKKODU</th>
                                    <th style="text-align: center; ">KALINLIK</th>
                                    <th style="text-align: center; ">GENISLIK</th>
                                    <th style="text-align: center; ">KALITE</th>
                                    <th style="text-align: center; ">KAPLAMA</th>
                                    <th style="text-align: center; ">MENSEI</th>
                                    <th style="text-align: center; ">REZERVE TARIH</th>
                                    <th style="text-align: center; ">REZERVE ACIKLAMA</th>
                                    <th style="text-align: center; ">TONAJ</th>
                                    <th style="text-align: center; ">ADET</th>
                                    <th style="text-align: center;">FIYAT</th>
                                    <th style="text-align: center; display: none">STOK SAHASI</th>
                                    <th style="text-align: center; display: none">STOĞA GİRİŞ TARİHİ</th>
                                    <th style="text-align: center; display: none">İŞ EMRİ TARİHİ</th>
                                    @*<th style="text-align: center; ">ÜRETİLME TARİHİ</th>*@
                                    <th style="text-align: center; display: none">İRSALİYE NO</th>
                                    <th style="text-align: center; display: none ">İŞ EMRİ NO</th>
                                    <th style="text-align: center; display: none">ÜRETİLECEK MALZEME ADI</th>
                                    @*<th style="text-align: center; ">KURAL</th>*@
                                    <th style="text-align: center; display: none">ÜRETİLECEK MAKİNE</th>
                                </tr>
                            </thead>
                            <tbody id="tbody">
                            </tbody>
                        </table>

                    </div>

                </div>


            </div>

        </div>






    </div>


    <script type="text/javascript" src="/assets/vendor/libs/jquery/jquery.js"></script>
    <script type="text/javascript" src="/assets/vendor/libs/popper/popper.js"></script>
    <script type="text/javascript" src="/assets/vendor/js/bootstrap.js"></script>
    <script type="text/javascript" src="/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

    <script type="text/javascript" src="/assets/vendor/js/menu.js"></script>
    <!-- endbuild -->
    <!-- Vendors JS -->
    <script type="text/javascript" src="/assets/vendor/libs/apex-charts/apexcharts.js"></script>

    <!-- Main JS -->
    <script type="text/javascript" src="/assets/js/main.js"></script>

    <!-- Page JS -->
    <script type="text/javascript" src="/assets/js/dashboards-analytics.js"></script>

    <!-- Place this tag in your head or just before your close body tag. -->


    <script type="text/javascript" async defer src="/Scripts/buttons.js"></script>
    <script type="text/javascript" src="/Scripts/boxicons.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>






    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        document.getElementById("satis").className = "menu-item open active";
        document.getElementById("fabstokfiyatli").className = "menu-item active";
        var upt = [];
        var filtereddata = [];
        var g = 0;
        var w = false;
        var k1 = false;
        var k3 = false;
        $(document).ready(function () {
            
            $.getJSON('http://192.168.2.13:83/api/ExcelTest', function (data) {
                upt=data;
                var renkfilter = [];
                var kalinlikfilter = [];
                var genislikfilter = [];
                var menseifilter = [];
              
                for (let i = 0; i < data.length; i++) {
                   
                    var tr = document.createElement("tr");
                    var td = document.createElement("td");
                    var lab = document.createElement("label");
                    if (!renkfilter.includes(data[i].RENKKODU)) {
                        renkfilter.push(data[i].RENKKODU);
                    }
                    if (!kalinlikfilter.includes(parseFloat(data[i].KALINLIK.replace(',', '.')))) {
                kalinlikfilter.push(parseFloat(data[i].KALINLIK.replace(',', '.')));
                    }
                    if (!genislikfilter.includes(parseFloat(data[i].GENISLIK.replace(',','.')))) {
                        genislikfilter.push(parseFloat(data[i].GENISLIK.replace(',', '.')));
                    }
                    if (!menseifilter.includes(data[i].MENSEI.trim())) {
                        menseifilter.push(data[i].MENSEI.trim());
                    }
                    var color = "";
                    if (data[i].KURAL == 1) {
                        color = "#EAFFF1";
                    } else if (data[i].KURAL == 0) {
                        color = "white";
                    }
                    else {
                        color = "#EAF1FF";
                    }
                    if (data[i].RESERVETARIH != "") {
                        color = "#F1EAFF";
                    }
                    tr.style = "background-color:" + color;
                    td.appendChild(lab);
                    td.className = "border-bottom-1 border-gray";
                    td.style = "background-color:" + color+";position:sticky;left:0;text-align: center";

                    if (data[i].RULOKODU.length == 6) {
                        lab.innerHTML = "0" + data[i].RULOKODU.substring(0, 4) + "." + data[i].RULOKODU.substring(data[i].RULOKODU.length - 2);
                    } else {
                        lab.innerHTML = data[i].RULOKODU.substring(0, 5) + "." + data[i].RULOKODU.substring(data[i].RULOKODU.length - 2);
                    }

                    lab.style = "font-size:12px;font-weight:bold";
                    tr.appendChild(td);
                    //var td1 = document.createElement("td");
                    //var lab1 = document.createElement("label");

                    //lab1.style = "background-color: transparent;border: none; text-align: center";

                    //td1.appendChild(lab1);
                    //td1.className = "border-bottom-1 border-gray";
                    //td1.style = "height:50px;";
                    //lab1.innerHTML = data[i].BOBINNO;
                    //tr.appendChild(td1);
                    var td2 = document.createElement("td");
                    var lab2 = document.createElement("label");

                    lab2.style = "background-color: transparent;border: none; text-align: center";

                    td2.appendChild(lab2);
                    td2.className = "border-bottom-1 border-gray";
                    td2.style = "height:50px;text-align: center";
                    if (data[i].KONUM != "") {
                        lab2.innerHTML = data[i].KONUM;
                    } else {
                        lab2.innerHTML = "-";
                    }

                    tr.appendChild(td2);
                    var td3 = document.createElement("td");
                    var lab3 = document.createElement("label");

                    lab3.style = "background-color: transparent;border: none; text-align: center";

                    td3.appendChild(lab3);
                    td3.className = "border-bottom-1 border-gray";
                    td3.style = "height:50px;text-align: center";
                    if (data[i].RENKKODU != "") {
                        lab3.innerHTML = data[i].RENKKODU;
                    } else {
                        lab3.innerHTML = "-";
                    }

                    tr.appendChild(td3);
                    var td4 = document.createElement("td");
                    var lab4 = document.createElement("label");

                    lab4.style = "background-color: transparent;border: none ;text-align: center";

                    td4.appendChild(lab4);
                    td4.className = "border-bottom-1 border-gray";
                    td4.style = "height:50px;text-align: center";
                    if (data[i].KALINLIK != "") {
                        lab4.innerHTML = (parseFloat((data[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                    } else {
                        lab4.innerHTML = "-";
                    }

                    tr.appendChild(td4);
                    var td5 = document.createElement("td");
                    var lab5 = document.createElement("label");

                    lab5.style = "background-color: transparent;border: none; text-align: center";

                    td5.appendChild(lab5);
                    td5.className = "border-bottom-1 border-gray";
                    td5.style = "height:50px;text-align: center";
                    if (data[i].GENISLIK != "") {
                        lab5.innerHTML = data[i].GENISLIK;
                    } else {
                        lab5.innerHTML = "-";
                    }


                    tr.appendChild(td5);
                    var td6 = document.createElement("td");
                    var lab6 = document.createElement("label");

                    lab6.style = "background-color: transparent;border: none ;text-align: center";

                    td6.appendChild(lab6);
                    td6.className = "border-bottom-1 border-gray";
                    td6.style = "height:50px;text-align: center";
                    if (data[i].KALITE != "") {
                        lab6.innerHTML = data[i].KALITE;
                    } else {
                        lab6.innerHTML = "-";
                    }

                    tr.appendChild(td6);
                    var td7 = document.createElement("td");
                    var lab7 = document.createElement("label");

                    lab7.style = "background-color: transparent;border: none ;text-align: center";

                    td7.appendChild(lab7);
                    td7.className = "border-bottom-1 border-gray";
                    td7.style = "height:50px;text-align: center";
                    if (data[i].KAPLAMA != "") {
                        lab7.innerHTML = data[i].KAPLAMA;
                    } else {
                        lab7.innerHTML = "-";
                    }

                    tr.appendChild(td7);




                    var td8 = document.createElement("td");
                    var lab8 = document.createElement("label");

                    lab8.style = "background-color: transparent;border: none; text-align: center";

                    td8.appendChild(lab8);
                    td8.className = "border-bottom-1 border-gray";
                    td8.style = "height:50px;text-align: center ";
                    if (data[i].MENSEI != "") {
                        lab8.innerHTML = data[i].MENSEI;
                    } else {
                        lab8.innerHTML = "-";
                    }

                    tr.appendChild(td8);
                    var td9 = document.createElement("td");
                    var lab9 = document.createElement("label");

                    lab9.style = "background-color: transparent;border: none; text-align: center";

                    td9.appendChild(lab9);
                    td9.className = "border-bottom-1 border-gray";
                    td9.style = "height:50px;text-align: center ";
                    if (data[i].RESERVETARIH != "") {
                        lab9.innerHTML = data[i].RESERVETARIH.split(' ')[0];
                    } else {
                        lab9.innerHTML = "-";
                    }

                    tr.appendChild(td9);
                    var td10 = document.createElement("td");
                    var lab10 = document.createElement("label");

                    lab10.style = "background-color: transparent;border: none ;text-align: center";

                    td10.appendChild(lab10);
                    td10.className = "border-bottom-1 border-gray";
                    td10.style = "height:50px;text-align: center";
                    if (data[i].RESERVEACIKLAMA != "") {
                        lab10.innerHTML = data[i].RESERVEACIKLAMA;
                    } else {
                        lab10.innerHTML = "-";
                    }

                    tr.appendChild(td10);
                    var td11 = document.createElement("td");
                    var lab11 = document.createElement("label");

                    lab11.style = "background-color: transparent;border: none ;text-align: center";

                    td11.appendChild(lab11);
                    td11.className = "border-bottom-1 border-gray";
                    td11.style = "height:50px;text-align: center;";
                    lab11.innerHTML = (parseFloat(data[i].TONAJ)).toLocaleString('tr-TR');
                    tr.appendChild(td11);
                    var td12 = document.createElement("td");
                    var lab12 = document.createElement("label");

                    lab12.style = "background-color: transparent;border: none ;text-align: center";

                    td12.appendChild(lab12);
                    td12.className = "border-bottom-1 border-gray";
                    td12.style = "height:50px;text-align: center;";
                    lab12.innerHTML = data[i].ADET;

                    tr.appendChild(td12);
                    var td13 = document.createElement("td");
                    var lab13 = document.createElement("label");

                    lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td13.appendChild(lab13);
                    td13.className = "border-bottom-1 border-gray";
                    td13.style = "height:50px;text-align: center;font-weight:bold";
                    if (data[i].TUTAR != "") {
                        lab13.innerHTML = "$ " + parseFloat(data[i].TUTAR).toFixed(4);
                    } else {
                        lab13.innerHTML = data[i].TUTAR;
                    }

                    tr.appendChild(td13);
                    var td14 = document.createElement("td");
                    var lab14 = document.createElement("label");

                    lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td14.appendChild(lab14);
                    td14.className = "border-bottom-1 border-gray";
                    td14.style = "height:50px;text-align: center;display:none";
                    tr.appendChild(td14);
                    if (data[i].STOKSAHASI != "") {
                        lab14.innerHTML = data[i].STOKSAHASI;
                    } else {
                        lab14.innerHTML = "-";
                    }

                    var td15 = document.createElement("td");
                    var lab15 = document.createElement("label");

                    lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td15.appendChild(lab15);
                    td15.className = "border-bottom-1 border-gray";
                    td15.style = "height:50px;text-align: center;display:none";
                    if (data[i].RULOBANTGIRISTARIH != "") {
                        lab15.innerHTML = data[i].RULOBANTGIRISTARIH;
                    } else {
                        lab15.innerHTML = "-";
                    }

                    tr.appendChild(td15);
                    var td16 = document.createElement("td");
                    var lab16 = document.createElement("label");
                    lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td16.appendChild(lab16);
                    td16.className = "border-bottom-1 border-gray";
                    td16.style = "height:50px;text-align: center;display:none";
                    if (data[i].ISEMRITARIHI != "") {
                        lab16.innerHTML = data[i].ISEMRITARIHI;
                    } else {
                        lab16.innerHTML = "-";
                    }

                    tr.appendChild(td16);
                    //var td17 = document.createElement("td");
                    //var lab17 = document.createElement("label");
                    //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    //td17.appendChild(lab17);
                    //td17.className = "border-bottom-1 border-gray";
                    //td17.style = "height:50px";
                    //lab17.innerHTML = data[i].URETILMETARIHI;
                    //tr.appendChild(td17);
                    var td17 = document.createElement("td");
                    var lab17 = document.createElement("label");

                    lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td17.appendChild(lab17);
                    td17.className = "border-bottom-1 border-gray";
                    td17.style = "height:50px;text-align: center;display:none";
                    if (data[i].IRSALIYENO != "") {
                        lab17.innerHTML = data[i].IRSALIYENO;
                    } else {
                        lab17.innerHTML = "-";
                    }

                    tr.appendChild(td17);
                    var td18 = document.createElement("td");
                    var lab18 = document.createElement("label");

                    lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                    if (data[i].ISEMRINO != "") {
                        lab18.innerHTML = data[i].ISEMRINO;
                    } else {
                        lab18.innerHTML = "-";
                    }

                    td18.appendChild(lab18);
                    td18.className = "border-bottom-1 border-gray";
                    td18.style = "height:50px;text-align: center;display:none";
                    tr.appendChild(td18);
                    var td19 = document.createElement("td");
                    var lab19 = document.createElement("label");

                    lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td19.appendChild(lab19);
                    td19.className = "border-bottom-1 border-gray";
                    td19.style = "height:50px;text-align: center;display:none";
                    if (data[i].URETILECEKMALZEMEADI != "") {
                        lab19.innerHTML = data[i].URETILECEKMALZEMEADI;
                    } else {
                        lab19.innerHTML = "-";
                    }

                    tr.appendChild(td19);
                    //var td20 = document.createElement("td");
                    //var lab20 = document.createElement("label");

                    //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    //td20.appendChild(lab20);
                    //td20.className = "border-bottom-1 border-gray";
                    //td20.style = "height:50px";
                    //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                    //tr.appendChild(td20);
                    //var td21 = document.createElement("td");
                    //var lab21 = document.createElement("label");

                    //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    //td21.appendChild(lab21);
                    //td21.className = "border-bottom-1 border-gray";
                    //td21.style = "height:50px";
                    //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                    //tr.appendChild(td21);
                    //var td22 = document.createElement("td");
                    //var lab22 = document.createElement("label");

                    //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    //td22.appendChild(lab22);
                    //td22.className = "border-bottom-1 border-gray";
                    //td22.style = "height:50px";
                    //lab22.innerHTML = data[i].KURAL;
                    //tr.appendChild(td22);
                    var td23 = document.createElement("td");
                    var lab23 = document.createElement("label");

                    lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td23.appendChild(lab23);
                    td23.className = "border-bottom-1 border-gray";
                    td23.style = "height:50px;text-align: center;display:none";
                    if (data[i].ISEMRIKOD != "") {
                        lab23.innerHTML = data[i].ISEMRIKOD;
                    } else {
                        lab23.innerHTML = "-";
                    }

                    tr.appendChild(td23);
                    document.getElementById("tbody").appendChild(tr);
                   
                }
                for (let i = 0; i < data.length; i++) {
                    var r=""
                    if (data[i].RULOKODU.length == 6) {
                        r = "0" + data[i].RULOKODU.substring(0, 4) + "." + data[i].RULOKODU.substring(data[i].RULOKODU.length - 2);
                    } else {
                        r = data[i].RULOKODU.substring(0, 5) + "." + data[i].RULOKODU.substring(data[i].RULOKODU.length - 2);
                    }
                    var option = document.createElement("option");
                    option.innerHTML = r;
                    option.value = data[i].RULOKODU;
                    document.getElementById("rulokodufilter").appendChild(option);
                   
                    
                   
                   
                   
                }
                renkfilter.sort(function (a, b) { return a - b });
                for (let i = 0; i < renkfilter.length; i++) {
                    var option1 = document.createElement("option");
                    option1.innerHTML = renkfilter[i];
                    option1.value = renkfilter[i];

                    document.getElementById("renkkodufilter").appendChild(option1);
                }
                kalinlikfilter.sort(function (a, b) { return a - b });
                for (let i = 0; i < kalinlikfilter.length; i++) {
                    var option2 = document.createElement("option");
                    option2.innerHTML = (parseFloat((kalinlikfilter[i].toString()).replace(",", ".")).toFixed(2)).replace(".", ",");
                    option2.value = (kalinlikfilter[i]).toString().replace('.', ',');
                    document.getElementById("kalinlikfilter").appendChild(option2);
                }
                genislikfilter.sort(function (a, b) { return a - b });
                for (let i = 0; i < genislikfilter.length; i++) {
                    var option3 = document.createElement("option");
                    option3.innerHTML = (genislikfilter[i]).toString().replace('.', ',');
                    option3.value = (genislikfilter[i]).toString().replace('.', ',');
                    document.getElementById("genislikfilter").appendChild(option3);
                }
                menseifilter.sort();
                for (let i = 0; i < menseifilter.length; i++) {
                    var option1 = document.createElement("option");
                    option1.innerHTML = menseifilter[i];
                    option1.value = menseifilter[i];

                    document.getElementById("menseifilter").appendChild(option1);
                }
                filtereddata = data;
            }).done(function () {
                $('#rulokodufilter').select2();
                $('#renkkodufilter').select2();
                $('#kalinlikfilter').select2();
                $('#genislikfilter').select2();
                $('#menseifilter').select2();
            });


        }).ajaxStop(function () {
            document.getElementById("progress").style.display = "none";
            var fiyatlar = [];
            var fiyatlarton = [];
            var rows = document.getElementById("tbody").getElementsByTagName("tr");
            
            
            for (let i = 1; i < rows.length; i++) {
                fiyatlar.push(parseFloat((rows[i].getElementsByTagName("label")[12].innerHTML).split(' ')[1]) * parseFloat((rows[i].getElementsByTagName("label")[10].innerHTML.replace('.', ''))));
                fiyatlarton.push(parseFloat((rows[i].getElementsByTagName("label")[10].innerHTML.replace('.',''))));
               
            }
           
            document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (fiyatlar.reduce((partialSum, a) => partialSum + a, 0) / (fiyatlarton.reduce((partialSum, a) => partialSum + a, 0))).toFixed(4);
            document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + (fiyatlarton.reduce((partialSum, a) => partialSum + a, 0)).toLocaleString('tr-TR');
        });
        
        function genislet() {
            if (g == 0) {
                var tb = document.getElementById("sorttable");
                var th = tb.getElementsByTagName("th");
                var tr = tb.getElementsByTagName("tr");
                for (let i = 12; i < th.length; i++) {

                    th[i].style.display = "table-cell";


                }
                for (let i = 1; i < tr.length; i++) {
                    var td = tr[i].getElementsByTagName("td");
                    for (let a = 12; a < th.length; a++) {

                        td[a].style.display = "table-cell";


                    }
                }
            } else {
                var tb = document.getElementById("sorttable");
                var th = tb.getElementsByTagName("th");
                var tr = tb.getElementsByTagName("tr");
                for (let i = 13; i < th.length; i++) {

                    th[i].style.display = "none";

                }
                for (let i = 1; i < tr.length; i++) {
                    var td = tr[i].getElementsByTagName("td");
                    for (let a = 13; a < th.length; a++) {

                        td[a].style.display = "none";

                    }
                }
            }

            if (g == 0) {
                g = 1;
                document.getElementById("genis").innerHTML = "<i class='bx bx-collapse-horizontal'></i>";
            } else {
                g = 0;
                document.getElementById("genis").innerHTML = "<i class='bx bx-expand-horizontal'></i>";
            }
        }
        function change() {
            
            var fiyatlar = [];
            var fiyatlarton = [];
            var values = $("#rulokodufilter").val();
            var renk = $("#renkkodufilter").val();
            var kal = $("#kalinlikfilter").val();
            var gen = $("#genislikfilter").val();
            var men = $("#menseifilter").val();
            document.getElementById("tbody").replaceChildren();
            if (values != "") {
                var fitered = upt.filter(x => values.includes(x.RULOKODU));
                if (w == true) {
                    fitered = upt.filter(x => x.KURAL == 0);
                }
                if (k1 == true) {
                    fitered = upt.filter(x => x.KURAL == 1);
                }
                if (k3 == true) {
                    fitered = upt.filter(x => x.KURAL == 3);
                }
            } else {
                var fitered = upt;
            }
            
            if (renk != "") {

                fitered = fitered.filter(x => renk.includes(x.RENKKODU));

            } else {
                var renkf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!renkf.includes(fitered[i].RENKKODU)) {
                        renkf.push(fitered[i].RENKKODU);
                    }
                }
                document.getElementById("renkkodufilter").replaceChildren();
                for (let i = 0; i < renkf.length; i++) {

                    var option = document.createElement("option");
                    option.value = renkf[i];
                    option.innerHTML = renkf[i];
                    document.getElementById("renkkodufilter").appendChild(option);
                }
            }
            if (kal != "") {

                fitered = fitered.filter(x => kal.includes(x.KALINLIK));
            } else {
                var kalf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!kalf.includes(parseFloat(fitered[i].KALINLIK.replace(",", ".")))) {
                        kalf.push(parseFloat(fitered[i].KALINLIK.replace(",", ".")));
                    }
                }
                document.getElementById("kalinlikfilter").replaceChildren();
                kalf.sort(function (a, b) { return a - b });
                for (let i = 0; i < kalf.length; i++) {

                    var option = document.createElement("option");
                    option.value = (kalf[i]).toString().replace('.', ',');
                    option.innerHTML = (parseFloat((kalf[i].toString()).replace(",", ".")).toFixed(2)).replace(".", ",");
                    document.getElementById("kalinlikfilter").appendChild(option);
                }
            }
            if (gen != "") {

                fitered = fitered.filter(x => gen.includes(x.GENISLIK));
            } else {
                var genf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!genf.includes(parseFloat(fitered[i].GENISLIK.replace(',', '.')))) {
                        genf.push(parseFloat(fitered[i].GENISLIK.replace(',', '.')));
                    }
                }
                genf.sort(function (a, b) { return a - b });
                document.getElementById("genislikfilter").replaceChildren();
                for (let i = 0; i < genf.length; i++) {

                    var option = document.createElement("option");
                    option.value = genf[i];
                    option.innerHTML = genf[i].toString().replace('.', ',');
                    document.getElementById("genislikfilter").appendChild(option);
                }
            }
            if (men != "") {

                fitered = fitered.filter(x => men.includes(x.MENSEI));
            }
            else {
                var menf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!menf.includes(fitered[i].MENSEI.trim())) {
                        menf.push(fitered[i].MENSEI.trim());
                    }
                }
                menf.sort();
                document.getElementById("menseifilter").replaceChildren();
                for (let i = 0; i < menf.length; i++) {

                    var option = document.createElement("option");
                    option.value = menf[i];
                    option.innerHTML = menf[i];
                    document.getElementById("menseifilter").appendChild(option);
                }
            }
           

            for (let i = 0; i < fitered.length; i++) {

                var tr = document.createElement("tr");
                var td = document.createElement("td");
                var lab = document.createElement("label");
                
                var color = "";
                if (fitered[i].KURAL == "1") {
                    color = "#EAFFF1";
                } else if (fitered[i].KURAL == "0") {
                    color = "white";
                }
                else {
                    color = "#EAF1FF";
                }
                if (fitered[i].RESERVETARIH != "") {
                    color = "#F1EAFF";
                }
                tr.style = "background-color:" + color;
                td.appendChild(lab);
                td.className = "border-bottom-1 border-gray";
                td.style = "background-color:" + color + ";position:sticky;left:0;text-align: center";

                if (fitered[i].RULOKODU.length == 6) {
                    lab.innerHTML = "0" + fitered[i].RULOKODU.substring(0, 4) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                } else {
                    lab.innerHTML = fitered[i].RULOKODU.substring(0, 5) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                }

                lab.style = "font-size:12px;font-weight:bold";
                tr.appendChild(td);
                //var td1 = document.createElement("td");
                //var lab1 = document.createElement("label");

                //lab1.style = "background-color: transparent;border: none; text-align: center";

                //td1.appendChild(lab1);
                //td1.className = "border-bottom-1 border-gray";
                //td1.style = "height:50px;";
                //lab1.innerHTML = data[i].BOBINNO;
                //tr.appendChild(td1);
                var td2 = document.createElement("td");
                var lab2 = document.createElement("label");

                lab2.style = "background-color: transparent;border: none; text-align: center";

                td2.appendChild(lab2);
                td2.className = "border-bottom-1 border-gray";
                td2.style = "height:50px;text-align: center";
                if (fitered[i].KONUM != "") {
                    lab2.innerHTML = fitered[i].KONUM;
                } else {
                    lab2.innerHTML = "-";
                }

                tr.appendChild(td2);
                var td3 = document.createElement("td");
                var lab3 = document.createElement("label");

                lab3.style = "background-color: transparent;border: none; text-align: center";

                td3.appendChild(lab3);
                td3.className = "border-bottom-1 border-gray";
                td3.style = "height:50px;text-align: center";
                if (fitered[i].RENKKODU != "") {
                    lab3.innerHTML = fitered[i].RENKKODU;
                } else {
                    lab3.innerHTML = "-";
                }

                tr.appendChild(td3);
                var td4 = document.createElement("td");
                var lab4 = document.createElement("label");

                lab4.style = "background-color: transparent;border: none ;text-align: center";

                td4.appendChild(lab4);
                td4.className = "border-bottom-1 border-gray";
                td4.style = "height:50px;text-align: center";
                if (fitered[i].KALINLIK != "") {
                    lab4.innerHTML = (parseFloat((fitered[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                } else {
                    lab4.innerHTML = "-";
                }

                tr.appendChild(td4);
                var td5 = document.createElement("td");
                var lab5 = document.createElement("label");

                lab5.style = "background-color: transparent;border: none; text-align: center";

                td5.appendChild(lab5);
                td5.className = "border-bottom-1 border-gray";
                td5.style = "height:50px;text-align: center";
                if (fitered[i].GENISLIK != "") {
                    lab5.innerHTML = fitered[i].GENISLIK;
                } else {
                    lab5.innerHTML = "-";
                }


                tr.appendChild(td5);
                var td6 = document.createElement("td");
                var lab6 = document.createElement("label");

                lab6.style = "background-color: transparent;border: none ;text-align: center";

                td6.appendChild(lab6);
                td6.className = "border-bottom-1 border-gray";
                td6.style = "height:50px;text-align: center";
                if (fitered[i].KALITE != "") {
                    lab6.innerHTML = fitered[i].KALITE;
                } else {
                    lab6.innerHTML = "-";
                }

                tr.appendChild(td6);
                var td7 = document.createElement("td");
                var lab7 = document.createElement("label");

                lab7.style = "background-color: transparent;border: none ;text-align: center";

                td7.appendChild(lab7);
                td7.className = "border-bottom-1 border-gray";
                td7.style = "height:50px;text-align: center";
                if (fitered[i].KAPLAMA != "") {
                    lab7.innerHTML = fitered[i].KAPLAMA;
                } else {
                    lab7.innerHTML = "-";
                }

                tr.appendChild(td7);




                var td8 = document.createElement("td");
                var lab8 = document.createElement("label");

                lab8.style = "background-color: transparent;border: none; text-align: center";

                td8.appendChild(lab8);
                td8.className = "border-bottom-1 border-gray";
                td8.style = "height:50px;text-align: center ";
                if (fitered[i].MENSEI != "") {
                    lab8.innerHTML = fitered[i].MENSEI;
                } else {
                    lab8.innerHTML = "-";
                }

                tr.appendChild(td8);
                var td9 = document.createElement("td");
                var lab9 = document.createElement("label");

                lab9.style = "background-color: transparent;border: none; text-align: center";

                td9.appendChild(lab9);
                td9.className = "border-bottom-1 border-gray";
                td9.style = "height:50px;text-align: center ";
                if (fitered[i].RESERVETARIH != "") {
                    lab9.innerHTML = fitered[i].RESERVETARIH.split(' ')[0];
                } else {
                    lab9.innerHTML = "-";
                }

                tr.appendChild(td9);
                var td10 = document.createElement("td");
                var lab10 = document.createElement("label");

                lab10.style = "background-color: transparent;border: none ;text-align: center";

                td10.appendChild(lab10);
                td10.className = "border-bottom-1 border-gray";
                td10.style = "height:50px;text-align: center";
                if (fitered[i].RESERVEACIKLAMA != "") {
                    lab10.innerHTML = fitered[i].RESERVEACIKLAMA;
                } else {
                    lab10.innerHTML = "-";
                }

                tr.appendChild(td10);
                var td11 = document.createElement("td");
                var lab11 = document.createElement("label");

                lab11.style = "background-color: transparent;border: none ;text-align: center";

                td11.appendChild(lab11);
                td11.className = "border-bottom-1 border-gray";
                td11.style = "height:50px;text-align: center;";
                lab11.innerHTML = (parseFloat(fitered[i].TONAJ)).toLocaleString('tr-TR');
                tr.appendChild(td11);
                var td12 = document.createElement("td");
                var lab12 = document.createElement("label");

                lab12.style = "background-color: transparent;border: none ;text-align: center";

                td12.appendChild(lab12);
                td12.className = "border-bottom-1 border-gray";
                td12.style = "height:50px;text-align: center;";
                lab12.innerHTML = fitered[i].ADET;

                tr.appendChild(td12);
                var td13 = document.createElement("td");
                var lab13 = document.createElement("label");

                lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td13.appendChild(lab13);
                td13.className = "border-bottom-1 border-gray";
                td13.style = "height:50px;text-align: center;font-weight:bold";
                if (fitered[i].TUTAR != "") {
                    lab13.innerHTML = "$ " + parseFloat(fitered[i].TUTAR).toFixed(4);
                } else {
                    lab13.innerHTML = fitered[i].TUTAR;
                }

                tr.appendChild(td13);
                var td14 = document.createElement("td");
                var lab14 = document.createElement("label");

                lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td14.appendChild(lab14);
                td14.className = "border-bottom-1 border-gray";
                td14.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td14);
                if (fitered[i].STOKSAHASI != "") {
                    lab14.innerHTML = fitered[i].STOKSAHASI;
                } else {
                    lab14.innerHTML = "-";
                }

                var td15 = document.createElement("td");
                var lab15 = document.createElement("label");

                lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td15.appendChild(lab15);
                td15.className = "border-bottom-1 border-gray";
                td15.style = "height:50px;text-align: center;display:none";
                if (fitered[i].RULOBANTGIRISTARIH != "") {
                    lab15.innerHTML = fitered[i].RULOBANTGIRISTARIH;
                } else {
                    lab15.innerHTML = "-";
                }

                tr.appendChild(td15);
                var td16 = document.createElement("td");
                var lab16 = document.createElement("label");
                lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td16.appendChild(lab16);
                td16.className = "border-bottom-1 border-gray";
                td16.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRITARIHI != "") {
                    lab16.innerHTML = fitered[i].ISEMRITARIHI;
                } else {
                    lab16.innerHTML = "-";
                }

                tr.appendChild(td16);
                //var td17 = document.createElement("td");
                //var lab17 = document.createElement("label");
                //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td17.appendChild(lab17);
                //td17.className = "border-bottom-1 border-gray";
                //td17.style = "height:50px";
                //lab17.innerHTML = data[i].URETILMETARIHI;
                //tr.appendChild(td17);
                var td17 = document.createElement("td");
                var lab17 = document.createElement("label");

                lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td17.appendChild(lab17);
                td17.className = "border-bottom-1 border-gray";
                td17.style = "height:50px;text-align: center;display:none";
                if (fitered[i].IRSALIYENO != "") {
                    lab17.innerHTML = fitered[i].IRSALIYENO;
                } else {
                    lab17.innerHTML = "-";
                }

                tr.appendChild(td17);
                var td18 = document.createElement("td");
                var lab18 = document.createElement("label");

                lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                if (fitered[i].ISEMRINO != "") {
                    lab18.innerHTML = fitered[i].ISEMRINO;
                } else {
                    lab18.innerHTML = "-";
                }

                td18.appendChild(lab18);
                td18.className = "border-bottom-1 border-gray";
                td18.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td18);
                var td19 = document.createElement("td");
                var lab19 = document.createElement("label");

                lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td19.appendChild(lab19);
                td19.className = "border-bottom-1 border-gray";
                td19.style = "height:50px;text-align: center;display:none";
                if (fitered[i].URETILECEKMALZEMEADI != "") {
                    lab19.innerHTML = fitered[i].URETILECEKMALZEMEADI;
                } else {
                    lab19.innerHTML = "-";
                }

                tr.appendChild(td19);
                //var td20 = document.createElement("td");
                //var lab20 = document.createElement("label");

                //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td20.appendChild(lab20);
                //td20.className = "border-bottom-1 border-gray";
                //td20.style = "height:50px";
                //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                //tr.appendChild(td20);
                //var td21 = document.createElement("td");
                //var lab21 = document.createElement("label");

                //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td21.appendChild(lab21);
                //td21.className = "border-bottom-1 border-gray";
                //td21.style = "height:50px";
                //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                //tr.appendChild(td21);
                //var td22 = document.createElement("td");
                //var lab22 = document.createElement("label");

                //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td22.appendChild(lab22);
                //td22.className = "border-bottom-1 border-gray";
                //td22.style = "height:50px";
                //lab22.innerHTML = data[i].KURAL;
                //tr.appendChild(td22);
                var td23 = document.createElement("td");
                var lab23 = document.createElement("label");

                lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td23.appendChild(lab23);
                td23.className = "border-bottom-1 border-gray";
                td23.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRIKOD != "") {
                    lab23.innerHTML = fitered[i].ISEMRIKOD;
                } else {
                    lab23.innerHTML = "-";
                }

                tr.appendChild(td23);
                document.getElementById("tbody").appendChild(tr);
                fiyatlar.push(parseFloat(fitered[i].TUTAR) * parseFloat(fitered[i].TONAJ));
                fiyatlarton.push(parseFloat(fitered[i].TONAJ));
            }
            var sum = 0;
            var sumton = 0;
            for (let i = 0; i < fiyatlar.length; i++) {
                sum = sum + fiyatlar[i];
                
            }
            for (let i = 0; i < fiyatlarton.length; i++) {
                sumton = sumton + fiyatlarton[i];
            }

            document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (sum / sumton).toFixed(4);
            document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + sumton.toLocaleString('tr-TR');
            var table = document.getElementById("tbody");
            var tr = table.getElementsByTagName("tr");
            var th = document.getElementById("sorttable").getElementsByTagName("th");
            if (g == 1) {
                for (let i = 0; i < tr.length; i++) {
                    var td = tr[i].getElementsByTagName("td");
                    for (let a = 12; a < th.length; a++) {

                        td[a].style.display = "table-cell";


                    }
                }
            }
            filtereddata = fitered;
           
        }
        function changerenk() {
            var fiyatlar = [];
            var fiyatlarton = [];
            var ton = [];
            $(function () {
                var values = $("#rulokodufilter").val();
                var renk = $("#renkkodufilter").val();
                var kal = $("#kalinlikfilter").val();
                var gen = $("#genislikfilter").val();
                var men = $("#menseifilter").val();
                document.getElementById("tbody").replaceChildren();
                if (renk != "") {
                    var fitered = upt.filter(x => renk.includes(x.RENKKODU));
                    if (w == true) {
                        fitered = upt.filter(x => x.KURAL == 0);
                    }
                    if (k1 == true) {
                        fitered = upt.filter(x => x.KURAL == 1);
                    }
                    if (k3 == true) {
                        fitered = upt.filter(x => x.KURAL == 3);
                    }
                } else {
                    var fitered = upt;
                }

                if (values != "") {

                    fitered = fitered.filter(x => values.includes(x.RULOKODU));
                } else {
                    var valf = [];
                    for (let i = 0; i < fitered.length; i++) {
                        if (!valf.includes(fitered[i].RULOKODU)) {
                            valf.push(fitered[i].RULOKODU);
                        }
                    }
                    document.getElementById("rulokodufilter").replaceChildren();
                    for (let i = 0; i < valf.length; i++) {

                        var option = document.createElement("option");
                        option.value = valf[i];
                        if (valf[i].length == 6) {
                            option.innerHTML = "0" + valf[i].substring(0, 4) + "." + valf[i].substring(valf[i].length - 2);
                        } else {
                            option.innerHTML = valf[i].substring(0, 5) + "." + valf[i].substring(valf[i].length - 2);
                        }
                        document.getElementById("rulokodufilter").appendChild(option);
                    }
                }
                if (kal != "") {

                    fitered = fitered.filter(x => kal.includes(x.KALINLIK));
                } else {
                   
                    var kalf = [];
                    for (let i = 0; i < fitered.length; i++) {
                        if (!kalf.includes(parseFloat(fitered[i].KALINLIK.replace(",", ".")))) {
                            kalf.push(parseFloat(fitered[i].KALINLIK.replace(",", ".")));
                        }
                    }
                    document.getElementById("kalinlikfilter").replaceChildren();
                    kalf.sort(function (a, b) { return a - b });
                    for (let i = 0; i < kalf.length; i++) {

                        var option = document.createElement("option");
                        option.value = (kalf[i]).toString().replace('.', ',');
                        option.innerHTML = (parseFloat((kalf[i].toString()).replace(",", ".")).toFixed(2)).replace(".", ",");
                        document.getElementById("kalinlikfilter").appendChild(option);
                    }
                }
                if (gen != "") {

                    fitered = fitered.filter(x => gen.includes(x.GENISLIK));
                } else {
                    var genf = [];
                    for (let i = 0; i < fitered.length; i++) {
                        if (!genf.includes(parseFloat(fitered[i].GENISLIK.replace(',', '.')))) {
                            genf.push(parseFloat(fitered[i].GENISLIK.replace(',', '.')));
                        }
                    }
                    genf.sort(function (a, b) { return a - b });
                    document.getElementById("genislikfilter").replaceChildren();
                    for (let i = 0; i < genf.length; i++) {

                        var option = document.createElement("option");
                        option.value = genf[i];
                        option.innerHTML = genf[i].toString().replace('.', ',');
                        document.getElementById("genislikfilter").appendChild(option);
                    }
                }
                if (men != "") {

                    fitered = fitered.filter(x => men.includes(x.MENSEI));
                } else {
                    var menf = [];
                    for (let i = 0; i < fitered.length; i++) {
                        if (!menf.includes(fitered[i].MENSEI.trim())) {
                            menf.push(fitered[i].MENSEI.trim());
                        }
                    }
                    menf.sort();
                    document.getElementById("menseifilter").replaceChildren();
                    for (let i = 0; i < menf.length; i++) {

                        var option = document.createElement("option");
                        option.value = menf[i];
                        option.innerHTML = menf[i];
                        document.getElementById("menseifilter").appendChild(option);
                    }
                }
               




               
                    for (let i = 0; i < fitered.length; i++) {

                        var tr = document.createElement("tr");
                        var td = document.createElement("td");
                        var lab = document.createElement("label");
                        
                        var color = "";
                        if (fitered[i].KURAL == 1) {
                            color = "#EAFFF1";
                        } else if (fitered[i].KURAL == 0) {
                            color = "white";
                        }
                        else {
                            color = "#EAF1FF";
                        }
                        if (fitered[i].RESERVETARIH != "") {
                            color = "#F1EAFF";
                        }
                        tr.style = "background-color:" + color;
                        td.appendChild(lab);
                        td.className = "border-bottom-1 border-gray";
                        td.style = "background-color:" + color + ";position:sticky;left:0;text-align: center";

                        if (fitered[i].RULOKODU.length == 6) {
                            lab.innerHTML = "0" + fitered[i].RULOKODU.substring(0, 4) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                        } else {
                            lab.innerHTML = fitered[i].RULOKODU.substring(0, 5) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                        }

                        lab.style = "font-size:12px;font-weight:bold";
                        tr.appendChild(td);
                        //var td1 = document.createElement("td");
                        //var lab1 = document.createElement("label");

                        //lab1.style = "background-color: transparent;border: none; text-align: center";

                        //td1.appendChild(lab1);
                        //td1.className = "border-bottom-1 border-gray";
                        //td1.style = "height:50px;";
                        //lab1.innerHTML = data[i].BOBINNO;
                        //tr.appendChild(td1);
                        var td2 = document.createElement("td");
                        var lab2 = document.createElement("label");

                        lab2.style = "background-color: transparent;border: none; text-align: center";

                        td2.appendChild(lab2);
                        td2.className = "border-bottom-1 border-gray";
                        td2.style = "height:50px;text-align: center";
                        if (fitered[i].KONUM != "") {
                            lab2.innerHTML = fitered[i].KONUM;
                        } else {
                            lab2.innerHTML = "-";
                        }

                        tr.appendChild(td2);
                        var td3 = document.createElement("td");
                        var lab3 = document.createElement("label");

                        lab3.style = "background-color: transparent;border: none; text-align: center";

                        td3.appendChild(lab3);
                        td3.className = "border-bottom-1 border-gray";
                        td3.style = "height:50px;text-align: center";
                        if (fitered[i].RENKKODU != "") {
                            lab3.innerHTML = fitered[i].RENKKODU;
                        } else {
                            lab3.innerHTML = "-";
                        }

                        tr.appendChild(td3);
                        var td4 = document.createElement("td");
                        var lab4 = document.createElement("label");

                        lab4.style = "background-color: transparent;border: none ;text-align: center";

                        td4.appendChild(lab4);
                        td4.className = "border-bottom-1 border-gray";
                        td4.style = "height:50px;text-align: center";
                        if (fitered[i].KALINLIK != "") {
                            lab4.innerHTML = (parseFloat((fitered[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                        } else {
                            lab4.innerHTML = "-";
                        }

                        tr.appendChild(td4);
                        var td5 = document.createElement("td");
                        var lab5 = document.createElement("label");

                        lab5.style = "background-color: transparent;border: none; text-align: center";

                        td5.appendChild(lab5);
                        td5.className = "border-bottom-1 border-gray";
                        td5.style = "height:50px;text-align: center";
                        if (fitered[i].GENISLIK != "") {
                            lab5.innerHTML = fitered[i].GENISLIK;
                        } else {
                            lab5.innerHTML = "-";
                        }


                        tr.appendChild(td5);
                        var td6 = document.createElement("td");
                        var lab6 = document.createElement("label");

                        lab6.style = "background-color: transparent;border: none ;text-align: center";

                        td6.appendChild(lab6);
                        td6.className = "border-bottom-1 border-gray";
                        td6.style = "height:50px;text-align: center";
                        if (fitered[i].KALITE != "") {
                            lab6.innerHTML = fitered[i].KALITE;
                        } else {
                            lab6.innerHTML = "-";
                        }

                        tr.appendChild(td6);
                        var td7 = document.createElement("td");
                        var lab7 = document.createElement("label");

                        lab7.style = "background-color: transparent;border: none ;text-align: center";

                        td7.appendChild(lab7);
                        td7.className = "border-bottom-1 border-gray";
                        td7.style = "height:50px;text-align: center";
                        if (fitered[i].KAPLAMA != "") {
                            lab7.innerHTML = fitered[i].KAPLAMA;
                        } else {
                            lab7.innerHTML = "-";
                        }

                        tr.appendChild(td7);




                        var td8 = document.createElement("td");
                        var lab8 = document.createElement("label");

                        lab8.style = "background-color: transparent;border: none; text-align: center";

                        td8.appendChild(lab8);
                        td8.className = "border-bottom-1 border-gray";
                        td8.style = "height:50px;text-align: center ";
                        if (fitered[i].MENSEI != "") {
                            lab8.innerHTML = fitered[i].MENSEI;
                        } else {
                            lab8.innerHTML = "-";
                        }

                        tr.appendChild(td8);
                        var td9 = document.createElement("td");
                        var lab9 = document.createElement("label");

                        lab9.style = "background-color: transparent;border: none; text-align: center";

                        td9.appendChild(lab9);
                        td9.className = "border-bottom-1 border-gray";
                        td9.style = "height:50px;text-align: center ";
                        if (fitered[i].RESERVETARIH != "") {
                            lab9.innerHTML = fitered[i].RESERVETARIH.split(' ')[0];
                        } else {
                            lab9.innerHTML = "-";
                        }

                        tr.appendChild(td9);
                        var td10 = document.createElement("td");
                        var lab10 = document.createElement("label");

                        lab10.style = "background-color: transparent;border: none ;text-align: center";

                        td10.appendChild(lab10);
                        td10.className = "border-bottom-1 border-gray";
                        td10.style = "height:50px;text-align: center";
                        if (fitered[i].RESERVEACIKLAMA != "") {
                            lab10.innerHTML = fitered[i].RESERVEACIKLAMA;
                        } else {
                            lab10.innerHTML = "-";
                        }

                        tr.appendChild(td10);
                        var td11 = document.createElement("td");
                        var lab11 = document.createElement("label");

                        lab11.style = "background-color: transparent;border: none ;text-align: center";

                        td11.appendChild(lab11);
                        td11.className = "border-bottom-1 border-gray";
                        td11.style = "height:50px;text-align: center;";
                        lab11.innerHTML = (parseFloat(fitered[i].TONAJ)).toLocaleString('tr-TR');
                        tr.appendChild(td11);
                        var td12 = document.createElement("td");
                        var lab12 = document.createElement("label");

                        lab12.style = "background-color: transparent;border: none ;text-align: center";

                        td12.appendChild(lab12);
                        td12.className = "border-bottom-1 border-gray";
                        td12.style = "height:50px;text-align: center;";
                        lab12.innerHTML = fitered[i].ADET;

                        tr.appendChild(td12);
                        var td13 = document.createElement("td");
                        var lab13 = document.createElement("label");

                        lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        td13.appendChild(lab13);
                        td13.className = "border-bottom-1 border-gray";
                        td13.style = "height:50px;text-align: center;font-weight:bold";
                        if (fitered[i].TUTAR != "") {
                            lab13.innerHTML = "$ " + parseFloat(fitered[i].TUTAR).toFixed(4);
                        } else {
                            lab13.innerHTML = fitered[i].TUTAR;
                        }

                        tr.appendChild(td13);
                        var td14 = document.createElement("td");
                        var lab14 = document.createElement("label");

                        lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        td14.appendChild(lab14);
                        td14.className = "border-bottom-1 border-gray";
                        td14.style = "height:50px;text-align: center;display:none";
                        tr.appendChild(td14);
                        if (fitered[i].STOKSAHASI != "") {
                            lab14.innerHTML = fitered[i].STOKSAHASI;
                        } else {
                            lab14.innerHTML = "-";
                        }

                        var td15 = document.createElement("td");
                        var lab15 = document.createElement("label");

                        lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        td15.appendChild(lab15);
                        td15.className = "border-bottom-1 border-gray";
                        td15.style = "height:50px;text-align: center;display:none";
                        if (fitered[i].RULOBANTGIRISTARIH != "") {
                            lab15.innerHTML = fitered[i].RULOBANTGIRISTARIH;
                        } else {
                            lab15.innerHTML = "-";
                        }

                        tr.appendChild(td15);
                        var td16 = document.createElement("td");
                        var lab16 = document.createElement("label");
                        lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        td16.appendChild(lab16);
                        td16.className = "border-bottom-1 border-gray";
                        td16.style = "height:50px;text-align: center;display:none";
                        if (fitered[i].ISEMRITARIHI != "") {
                            lab16.innerHTML = fitered[i].ISEMRITARIHI;
                        } else {
                            lab16.innerHTML = "-";
                        }

                        tr.appendChild(td16);
                        //var td17 = document.createElement("td");
                        //var lab17 = document.createElement("label");
                        //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        //td17.appendChild(lab17);
                        //td17.className = "border-bottom-1 border-gray";
                        //td17.style = "height:50px";
                        //lab17.innerHTML = data[i].URETILMETARIHI;
                        //tr.appendChild(td17);
                        var td17 = document.createElement("td");
                        var lab17 = document.createElement("label");

                        lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        td17.appendChild(lab17);
                        td17.className = "border-bottom-1 border-gray";
                        td17.style = "height:50px;text-align: center;display:none";
                        if (fitered[i].IRSALIYENO != "") {
                            lab17.innerHTML = fitered[i].IRSALIYENO;
                        } else {
                            lab17.innerHTML = "-";
                        }

                        tr.appendChild(td17);
                        var td18 = document.createElement("td");
                        var lab18 = document.createElement("label");

                        lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                        if (fitered[i].ISEMRINO != "") {
                            lab18.innerHTML = fitered[i].ISEMRINO;
                        } else {
                            lab18.innerHTML = "-";
                        }

                        td18.appendChild(lab18);
                        td18.className = "border-bottom-1 border-gray";
                        td18.style = "height:50px;text-align: center;display:none";
                        tr.appendChild(td18);
                        var td19 = document.createElement("td");
                        var lab19 = document.createElement("label");

                        lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        td19.appendChild(lab19);
                        td19.className = "border-bottom-1 border-gray";
                        td19.style = "height:50px;text-align: center;display:none";
                        if (fitered[i].URETILECEKMALZEMEADI != "") {
                            lab19.innerHTML = fitered[i].URETILECEKMALZEMEADI;
                        } else {
                            lab19.innerHTML = "-";
                        }

                        tr.appendChild(td19);
                        //var td20 = document.createElement("td");
                        //var lab20 = document.createElement("label");

                        //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        //td20.appendChild(lab20);
                        //td20.className = "border-bottom-1 border-gray";
                        //td20.style = "height:50px";
                        //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                        //tr.appendChild(td20);
                        //var td21 = document.createElement("td");
                        //var lab21 = document.createElement("label");

                        //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        //td21.appendChild(lab21);
                        //td21.className = "border-bottom-1 border-gray";
                        //td21.style = "height:50px";
                        //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                        //tr.appendChild(td21);
                        //var td22 = document.createElement("td");
                        //var lab22 = document.createElement("label");

                        //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        //td22.appendChild(lab22);
                        //td22.className = "border-bottom-1 border-gray";
                        //td22.style = "height:50px";
                        //lab22.innerHTML = data[i].KURAL;
                        //tr.appendChild(td22);
                        var td23 = document.createElement("td");
                        var lab23 = document.createElement("label");

                        lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                        td23.appendChild(lab23);
                        td23.className = "border-bottom-1 border-gray";
                        td23.style = "height:50px;text-align: center;display:none";
                        if (fitered[i].ISEMRIKOD != "") {
                            lab23.innerHTML = fitered[i].ISEMRIKOD;
                        } else {
                            lab23.innerHTML = "-";
                        }

                        tr.appendChild(td23);
                        document.getElementById("tbody").appendChild(tr);
                    fiyatlar.push(parseFloat(fitered[i].TUTAR) * parseFloat(fitered[i].TONAJ));
                    fiyatlarton.push(parseFloat(fitered[i].TONAJ));
                }
                var sum = 0;
                var sumton = 0;
                for (let i = 0; i < fiyatlar.length; i++) {
                    sum = sum + fiyatlar[i];

                }
                for (let i = 0; i < fiyatlarton.length; i++) {
                    sumton = sumton + fiyatlarton[i];
                }

                document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (sum / sumton).toFixed(4);
                document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + sumton.toLocaleString('tr','TR');
                
                var table = document.getElementById("tbody");
                var tr = table.getElementsByTagName("tr");
                var th = document.getElementById("sorttable").getElementsByTagName("th");
                if (g == 1) {
                    for (let i = 0; i < tr.length; i++) {
                        var td = tr[i].getElementsByTagName("td");
                        for (let a = 12; a < th.length; a++) {

                            td[a].style.display = "table-cell";


                        }
                    }
                }
                filtereddata = fitered;
            });
            
           
        }
       
        function changekal() {
            var fiyatlar = [];
            var fiyatlarton = [];
            var values = $("#rulokodufilter").val();
            var renk = $("#renkkodufilter").val();
            var kal = $("#kalinlikfilter").val();
            var gen = $("#genislikfilter").val();
            var men = $("#menseifilter").val();
            
            document.getElementById("tbody").replaceChildren();
            if (kal != "") {
               
                var fitered = upt.filter(x => kal.includes(x.KALINLIK));
               
                if (w == true) {
                   
                    fitered = fitered.filter(x => x.KURAL==0);
                }
                if (k1 == true) {
                   
                    fitered = fitered.filter(x => x.KURAL == 1);
                   
                }
                if (k3 == true) {
                   
                    fitered = fitered.filter(x => x.KURAL == 3);
                }
                
                
            } else {

                var fitered = upt;
               
            }

            
            if (values != "") {

                fitered = fitered.filter(x => values.includes(x.RULOKODU));
            } else {
                var valf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!valf.includes(fitered[i].RULOKODU)) {
                        valf.push(fitered[i].RULOKODU);
                    }
                }
                document.getElementById("rulokodufilter").replaceChildren();
                for (let i = 0; i < valf.length; i++) {

                    var option = document.createElement("option");
                    option.value = valf[i];
                    if (valf[i].length == 6) {
                        option.innerHTML = "0" + valf[i].substring(0, 4) + "." + valf[i].substring(valf[i].length - 2);
                    } else {
                        option.innerHTML = valf[i].substring(0, 5) + "." + valf[i].substring(valf[i].length - 2);
                    }
                  
                    document.getElementById("rulokodufilter").appendChild(option);
                }
            }
            if (renk != "") {

                fitered = fitered.filter(x => renk.includes(x.RENKKODU));
            } else {
                var renkf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!renkf.includes(fitered[i].RENKKODU)) {
                        renkf.push(fitered[i].RENKKODU);
                    }
                }
                document.getElementById("renkkodufilter").replaceChildren();
                for (let i = 0; i < renkf.length; i++) {

                    var option = document.createElement("option");
                    option.value = renkf[i];
                    option.innerHTML = renkf[i];
                    document.getElementById("renkkodufilter").appendChild(option);
                }
            }
            if (gen != "") {

                fitered = fitered.filter(x => gen.includes(x.GENISLIK));
            } else {
                var genf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!genf.includes(parseFloat(fitered[i].GENISLIK.replace(',', '.')))) {
                        genf.push(parseFloat(fitered[i].GENISLIK.replace(',', '.')));
                    }
                }
                genf.sort(function (a, b) { return a - b });
                document.getElementById("genislikfilter").replaceChildren();
                for (let i = 0; i < genf.length; i++) {

                    var option = document.createElement("option");
                    option.value = genf[i];
                    option.innerHTML = genf[i].toString().replace('.', ',');
                    document.getElementById("genislikfilter").appendChild(option);
                }
            }
            if (men != "") {

                fitered = fitered.filter(x => men.includes(x.MENSEI));
            } else {
                var menf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!menf.includes(fitered[i].MENSEI.trim())) {
                        menf.push(fitered[i].MENSEI.trim());
                    }
                }
                menf.sort();
                document.getElementById("menseifilter").replaceChildren();
                for (let i = 0; i < menf.length; i++) {

                    var option = document.createElement("option");
                    option.value = menf[i];
                    option.innerHTML = menf[i];
                    document.getElementById("menseifilter").appendChild(option);
                }
            }
            
            for (let i = 0; i < fitered.length; i++) {

                var tr = document.createElement("tr");
                var td = document.createElement("td");
                var lab = document.createElement("label");

                var color = "";
                if (fitered[i].KURAL == "1") {
                    color = "#EAFFF1";
                } else if (fitered[i].KURAL == "0") {
                    color = "white";
                }
                else {
                    color = "#EAF1FF";
                }
                if (fitered[i].RESERVETARIH != "") {
                    color = "#F1EAFF";
                }
                tr.style = "background-color:" + color;
                td.appendChild(lab);
                td.className = "border-bottom-1 border-gray";
                td.style = "background-color:" + color + ";position:sticky;left:0;text-align: center";

                if (fitered[i].RULOKODU.length == 6) {
                    lab.innerHTML = "0" + fitered[i].RULOKODU.substring(0, 4) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                } else {
                    lab.innerHTML = fitered[i].RULOKODU.substring(0, 5) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                }

                lab.style = "font-size:12px;font-weight:bold";
                tr.appendChild(td);
                //var td1 = document.createElement("td");
                //var lab1 = document.createElement("label");

                //lab1.style = "background-color: transparent;border: none; text-align: center";

                //td1.appendChild(lab1);
                //td1.className = "border-bottom-1 border-gray";
                //td1.style = "height:50px;";
                //lab1.innerHTML = data[i].BOBINNO;
                //tr.appendChild(td1);
                var td2 = document.createElement("td");
                var lab2 = document.createElement("label");

                lab2.style = "background-color: transparent;border: none; text-align: center";

                td2.appendChild(lab2);
                td2.className = "border-bottom-1 border-gray";
                td2.style = "height:50px;text-align: center";
                if (fitered[i].KONUM != "") {
                    lab2.innerHTML = fitered[i].KONUM;
                } else {
                    lab2.innerHTML = "-";
                }

                tr.appendChild(td2);
                var td3 = document.createElement("td");
                var lab3 = document.createElement("label");

                lab3.style = "background-color: transparent;border: none; text-align: center";

                td3.appendChild(lab3);
                td3.className = "border-bottom-1 border-gray";
                td3.style = "height:50px;text-align: center";
                if (fitered[i].RENKKODU != "") {
                    lab3.innerHTML = fitered[i].RENKKODU;
                } else {
                    lab3.innerHTML = "-";
                }

                tr.appendChild(td3);
                var td4 = document.createElement("td");
                var lab4 = document.createElement("label");

                lab4.style = "background-color: transparent;border: none ;text-align: center";

                td4.appendChild(lab4);
                td4.className = "border-bottom-1 border-gray";
                td4.style = "height:50px;text-align: center";
                if (fitered[i].KALINLIK != "") {
                    lab4.innerHTML = (parseFloat((fitered[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                } else {
                    lab4.innerHTML = "-";
                }

                tr.appendChild(td4);
                var td5 = document.createElement("td");
                var lab5 = document.createElement("label");

                lab5.style = "background-color: transparent;border: none; text-align: center";

                td5.appendChild(lab5);
                td5.className = "border-bottom-1 border-gray";
                td5.style = "height:50px;text-align: center";
                if (fitered[i].GENISLIK != "") {
                    lab5.innerHTML = fitered[i].GENISLIK;
                } else {
                    lab5.innerHTML = "-";
                }


                tr.appendChild(td5);
                var td6 = document.createElement("td");
                var lab6 = document.createElement("label");

                lab6.style = "background-color: transparent;border: none ;text-align: center";

                td6.appendChild(lab6);
                td6.className = "border-bottom-1 border-gray";
                td6.style = "height:50px;text-align: center";
                if (fitered[i].KALITE != "") {
                    lab6.innerHTML = fitered[i].KALITE;
                } else {
                    lab6.innerHTML = "-";
                }

                tr.appendChild(td6);
                var td7 = document.createElement("td");
                var lab7 = document.createElement("label");

                lab7.style = "background-color: transparent;border: none ;text-align: center";

                td7.appendChild(lab7);
                td7.className = "border-bottom-1 border-gray";
                td7.style = "height:50px;text-align: center";
                if (fitered[i].KAPLAMA != "") {
                    lab7.innerHTML = fitered[i].KAPLAMA;
                } else {
                    lab7.innerHTML = "-";
                }

                tr.appendChild(td7);




                var td8 = document.createElement("td");
                var lab8 = document.createElement("label");

                lab8.style = "background-color: transparent;border: none; text-align: center";

                td8.appendChild(lab8);
                td8.className = "border-bottom-1 border-gray";
                td8.style = "height:50px;text-align: center ";
                if (fitered[i].MENSEI != "") {
                    lab8.innerHTML = fitered[i].MENSEI;
                } else {
                    lab8.innerHTML = "-";
                }

                tr.appendChild(td8);
                var td9 = document.createElement("td");
                var lab9 = document.createElement("label");

                lab9.style = "background-color: transparent;border: none; text-align: center";

                td9.appendChild(lab9);
                td9.className = "border-bottom-1 border-gray";
                td9.style = "height:50px;text-align: center ";
                if (fitered[i].RESERVETARIH != "") {
                    lab9.innerHTML = fitered[i].RESERVETARIH.split(' ')[0];
                } else {
                    lab9.innerHTML = "-";
                }

                tr.appendChild(td9);
                var td10 = document.createElement("td");
                var lab10 = document.createElement("label");

                lab10.style = "background-color: transparent;border: none ;text-align: center";

                td10.appendChild(lab10);
                td10.className = "border-bottom-1 border-gray";
                td10.style = "height:50px;text-align: center";
                if (fitered[i].RESERVEACIKLAMA != "") {
                    lab10.innerHTML = fitered[i].RESERVEACIKLAMA;
                } else {
                    lab10.innerHTML = "-";
                }

                tr.appendChild(td10);
                var td11 = document.createElement("td");
                var lab11 = document.createElement("label");

                lab11.style = "background-color: transparent;border: none ;text-align: center";

                td11.appendChild(lab11);
                td11.className = "border-bottom-1 border-gray";
                td11.style = "height:50px;text-align: center;";
                lab11.innerHTML = (parseFloat(fitered[i].TONAJ)).toLocaleString('tr-TR');
                tr.appendChild(td11);
                var td12 = document.createElement("td");
                var lab12 = document.createElement("label");

                lab12.style = "background-color: transparent;border: none ;text-align: center";

                td12.appendChild(lab12);
                td12.className = "border-bottom-1 border-gray";
                td12.style = "height:50px;text-align: center;";
                lab12.innerHTML = fitered[i].ADET;

                tr.appendChild(td12);
                var td13 = document.createElement("td");
                var lab13 = document.createElement("label");

                lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td13.appendChild(lab13);
                td13.className = "border-bottom-1 border-gray";
                td13.style = "height:50px;text-align: center;font-weight:bold";
                if (fitered[i].TUTAR != "") {
                    lab13.innerHTML = "$ " + parseFloat(fitered[i].TUTAR).toFixed(4);
                } else {
                    lab13.innerHTML = fitered[i].TUTAR;
                }

                tr.appendChild(td13);
                var td14 = document.createElement("td");
                var lab14 = document.createElement("label");

                lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td14.appendChild(lab14);
                td14.className = "border-bottom-1 border-gray";
                td14.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td14);
                if (fitered[i].STOKSAHASI != "") {
                    lab14.innerHTML = fitered[i].STOKSAHASI;
                } else {
                    lab14.innerHTML = "-";
                }

                var td15 = document.createElement("td");
                var lab15 = document.createElement("label");

                lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td15.appendChild(lab15);
                td15.className = "border-bottom-1 border-gray";
                td15.style = "height:50px;text-align: center;display:none";
                if (fitered[i].RULOBANTGIRISTARIH != "") {
                    lab15.innerHTML = fitered[i].RULOBANTGIRISTARIH;
                } else {
                    lab15.innerHTML = "-";
                }

                tr.appendChild(td15);
                var td16 = document.createElement("td");
                var lab16 = document.createElement("label");
                lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td16.appendChild(lab16);
                td16.className = "border-bottom-1 border-gray";
                td16.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRITARIHI != "") {
                    lab16.innerHTML = fitered[i].ISEMRITARIHI;
                } else {
                    lab16.innerHTML = "-";
                }

                tr.appendChild(td16);
                //var td17 = document.createElement("td");
                //var lab17 = document.createElement("label");
                //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td17.appendChild(lab17);
                //td17.className = "border-bottom-1 border-gray";
                //td17.style = "height:50px";
                //lab17.innerHTML = data[i].URETILMETARIHI;
                //tr.appendChild(td17);
                var td17 = document.createElement("td");
                var lab17 = document.createElement("label");

                lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td17.appendChild(lab17);
                td17.className = "border-bottom-1 border-gray";
                td17.style = "height:50px;text-align: center;display:none";
                if (fitered[i].IRSALIYENO != "") {
                    lab17.innerHTML = fitered[i].IRSALIYENO;
                } else {
                    lab17.innerHTML = "-";
                }

                tr.appendChild(td17);
                var td18 = document.createElement("td");
                var lab18 = document.createElement("label");

                lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                if (fitered[i].ISEMRINO != "") {
                    lab18.innerHTML = fitered[i].ISEMRINO;
                } else {
                    lab18.innerHTML = "-";
                }

                td18.appendChild(lab18);
                td18.className = "border-bottom-1 border-gray";
                td18.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td18);
                var td19 = document.createElement("td");
                var lab19 = document.createElement("label");

                lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td19.appendChild(lab19);
                td19.className = "border-bottom-1 border-gray";
                td19.style = "height:50px;text-align: center;display:none";
                if (fitered[i].URETILECEKMALZEMEADI != "") {
                    lab19.innerHTML = fitered[i].URETILECEKMALZEMEADI;
                } else {
                    lab19.innerHTML = "-";
                }

                tr.appendChild(td19);
                //var td20 = document.createElement("td");
                //var lab20 = document.createElement("label");

                //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td20.appendChild(lab20);
                //td20.className = "border-bottom-1 border-gray";
                //td20.style = "height:50px";
                //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                //tr.appendChild(td20);
                //var td21 = document.createElement("td");
                //var lab21 = document.createElement("label");

                //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td21.appendChild(lab21);
                //td21.className = "border-bottom-1 border-gray";
                //td21.style = "height:50px";
                //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                //tr.appendChild(td21);
                //var td22 = document.createElement("td");
                //var lab22 = document.createElement("label");

                //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td22.appendChild(lab22);
                //td22.className = "border-bottom-1 border-gray";
                //td22.style = "height:50px";
                //lab22.innerHTML = data[i].KURAL;
                //tr.appendChild(td22);
                var td23 = document.createElement("td");
                var lab23 = document.createElement("label");

                lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td23.appendChild(lab23);
                td23.className = "border-bottom-1 border-gray";
                td23.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRIKOD != "") {
                    lab23.innerHTML = fitered[i].ISEMRIKOD;
                } else {
                    lab23.innerHTML = "-";
                }

                tr.appendChild(td23);
                document.getElementById("tbody").appendChild(tr);
                fiyatlar.push(parseFloat(fitered[i].TUTAR) * parseFloat(fitered[i].TONAJ));
                fiyatlarton.push(parseFloat(fitered[i].TONAJ));
            }
            var sum = 0;
            var sumton = 0;
            for (let i = 0; i < fiyatlar.length; i++) {
                sum = sum + fiyatlar[i];

            }
            for (let i = 0; i < fiyatlarton.length; i++) {
                sumton = sumton + fiyatlarton[i];
            }

            document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (sum / sumton).toFixed(4);
            document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + sumton.toLocaleString('tr', 'TR');
            var table = document.getElementById("tbody");
            var tr = table.getElementsByTagName("tr");
            var th = document.getElementById("sorttable").getElementsByTagName("th");
            if (g == 1) {
                for (let i = 0; i < tr.length; i++) {
                    var td = tr[i].getElementsByTagName("td");
                    for (let a = 12; a < th.length; a++) {

                        td[a].style.display = "table-cell";


                    }
                }
            }
            filtereddata = fitered;
        }
        function changegen() {
            var fiyatlar = [];
            var fiyatlarton = [];
            var values = $("#rulokodufilter").val();
            var renk = $("#renkkodufilter").val();
            var kal = $("#kalinlikfilter").val();
            var gen = $("#genislikfilter").val();
            var men = $("#menseifilter").val();
            document.getElementById("tbody").replaceChildren();
            
            if (gen != "") {
                var fitered = upt.filter(x => gen.includes(x.GENISLIK));
                if (w == true) {
                    fitered = upt.filter(x => x.KURAL == 0);
                }
                if (k1 == true) {
                    fitered = upt.filter(x => x.KURAL == 1);
                }
                if (k3 == true) {
                    fitered = upt.filter(x => x.KURAL == 3);
                }
            } else {
                var fitered = upt;
            }
            if (values != "") {

                fitered = fitered.filter(x => values.includes(x.RULOKODU));
            } else {
                var valf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!valf.includes(fitered[i].RULOKODU)) {
                        valf.push(fitered[i].RULOKODU);
                    }
                }
                document.getElementById("rulokodufilter").replaceChildren();
                for (let i = 0; i < valf.length; i++) {

                    var option = document.createElement("option");
                    option.value = valf[i];
                    if (valf[i].length == 6) {
                        option.innerHTML = "0" + valf[i].substring(0, 4) + "." + valf[i].substring(valf[i].length - 2);
                    } else {
                        option.innerHTML = valf[i].substring(0, 5) + "." + valf[i].substring(valf[i].length - 2);
                    }
                    document.getElementById("rulokodufilter").appendChild(option);
                }
            }
            if (renk != "") {

                fitered = fitered.filter(x => renk.includes(x.RENKKODU));
            } else {
                var renkf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!renkf.includes(fitered[i].RENKKODU)) {
                        renkf.push(fitered[i].RENKKODU);
                    }
                }
                document.getElementById("renkkodufilter").replaceChildren();
                for (let i = 0; i < renkf.length; i++) {

                    var option = document.createElement("option");
                    option.value = renkf[i];
                    option.innerHTML = renkf[i];
                    document.getElementById("renkkodufilter").appendChild(option);
                }
            }
            if (kal != "") {

                fitered = fitered.filter(x => kal.includes(x.KALINLIK));
            } else {
                var kalf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!kalf.includes(parseFloat(fitered[i].KALINLIK.replace(",", ".")))) {
                        kalf.push(parseFloat(fitered[i].KALINLIK.replace(",", ".")));
                    }
                }
                document.getElementById("kalinlikfilter").replaceChildren();
                kalf.sort(function (a, b) { return a - b });
                for (let i = 0; i < kalf.length; i++) {

                    var option = document.createElement("option");
                    option.value = (kalf[i]).toString().replace('.', ',');
                    option.innerHTML = kalf[i].toFixed(2).toString().replace(".", ",");
                    document.getElementById("kalinlikfilter").appendChild(option);
                }
            }
            if (men != "") {

                fitered = fitered.filter(x => men.includes(x.MENSEI));
            } else {
                var menf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!menf.includes(fitered[i].MENSEI.trim())) {
                        menf.push(fitered[i].MENSEI.trim());
                    }
                }
                menf.sort();
                document.getElementById("menseifilter").replaceChildren();
                for (let i = 0; i < menf.length; i++) {

                    var option = document.createElement("option");
                    option.value = menf[i];
                    option.innerHTML = menf[i];
                    document.getElementById("menseifilter").appendChild(option);
                }
            }
           

            for (let i = 0; i < fitered.length; i++) {

                var tr = document.createElement("tr");
                var td = document.createElement("td");
                var lab = document.createElement("label");

                var color = "";
                if (fitered[i].KURAL == 1) {
                    color = "#EAFFF1";
                } else if (fitered[i].KURAL == 0) {
                    color = "white";
                }
                else {
                    color = "#EAF1FF";
                }
                if (fitered[i].RESERVETARIH != "") {
                    color = "#F1EAFF";
                }
                tr.style = "background-color:" + color;
                td.appendChild(lab);
                td.className = "border-bottom-1 border-gray";
                td.style = "background-color:" + color + ";position:sticky;left:0;text-align: center";

                if (fitered[i].RULOKODU.length == 6) {
                    lab.innerHTML = "0" + fitered[i].RULOKODU.substring(0, 4) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                } else {
                    lab.innerHTML = fitered[i].RULOKODU.substring(0, 5) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                }

                lab.style = "font-size:12px;font-weight:bold";
                tr.appendChild(td);
                //var td1 = document.createElement("td");
                //var lab1 = document.createElement("label");

                //lab1.style = "background-color: transparent;border: none; text-align: center";

                //td1.appendChild(lab1);
                //td1.className = "border-bottom-1 border-gray";
                //td1.style = "height:50px;";
                //lab1.innerHTML = data[i].BOBINNO;
                //tr.appendChild(td1);
                var td2 = document.createElement("td");
                var lab2 = document.createElement("label");

                lab2.style = "background-color: transparent;border: none; text-align: center";

                td2.appendChild(lab2);
                td2.className = "border-bottom-1 border-gray";
                td2.style = "height:50px;text-align: center";
                if (fitered[i].KONUM != "") {
                    lab2.innerHTML = fitered[i].KONUM;
                } else {
                    lab2.innerHTML = "-";
                }

                tr.appendChild(td2);
                var td3 = document.createElement("td");
                var lab3 = document.createElement("label");

                lab3.style = "background-color: transparent;border: none; text-align: center";

                td3.appendChild(lab3);
                td3.className = "border-bottom-1 border-gray";
                td3.style = "height:50px;text-align: center";
                if (fitered[i].RENKKODU != "") {
                    lab3.innerHTML = fitered[i].RENKKODU;
                } else {
                    lab3.innerHTML = "-";
                }

                tr.appendChild(td3);
                var td4 = document.createElement("td");
                var lab4 = document.createElement("label");

                lab4.style = "background-color: transparent;border: none ;text-align: center";

                td4.appendChild(lab4);
                td4.className = "border-bottom-1 border-gray";
                td4.style = "height:50px;text-align: center";
                if (fitered[i].KALINLIK != "") {
                    lab4.innerHTML = (parseFloat((fitered[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                } else {
                    lab4.innerHTML = "-";
                }

                tr.appendChild(td4);
                var td5 = document.createElement("td");
                var lab5 = document.createElement("label");

                lab5.style = "background-color: transparent;border: none; text-align: center";

                td5.appendChild(lab5);
                td5.className = "border-bottom-1 border-gray";
                td5.style = "height:50px;text-align: center";
                if (fitered[i].GENISLIK != "") {
                    lab5.innerHTML = fitered[i].GENISLIK;
                } else {
                    lab5.innerHTML = "-";
                }


                tr.appendChild(td5);
                var td6 = document.createElement("td");
                var lab6 = document.createElement("label");

                lab6.style = "background-color: transparent;border: none ;text-align: center";

                td6.appendChild(lab6);
                td6.className = "border-bottom-1 border-gray";
                td6.style = "height:50px;text-align: center";
                if (fitered[i].KALITE != "") {
                    lab6.innerHTML = fitered[i].KALITE;
                } else {
                    lab6.innerHTML = "-";
                }

                tr.appendChild(td6);
                var td7 = document.createElement("td");
                var lab7 = document.createElement("label");

                lab7.style = "background-color: transparent;border: none ;text-align: center";

                td7.appendChild(lab7);
                td7.className = "border-bottom-1 border-gray";
                td7.style = "height:50px;text-align: center";
                if (fitered[i].KAPLAMA != "") {
                    lab7.innerHTML = fitered[i].KAPLAMA;
                } else {
                    lab7.innerHTML = "-";
                }

                tr.appendChild(td7);




                var td8 = document.createElement("td");
                var lab8 = document.createElement("label");

                lab8.style = "background-color: transparent;border: none; text-align: center";

                td8.appendChild(lab8);
                td8.className = "border-bottom-1 border-gray";
                td8.style = "height:50px;text-align: center ";
                if (fitered[i].MENSEI != "") {
                    lab8.innerHTML = fitered[i].MENSEI;
                } else {
                    lab8.innerHTML = "-";
                }

                tr.appendChild(td8);
                var td9 = document.createElement("td");
                var lab9 = document.createElement("label");

                lab9.style = "background-color: transparent;border: none; text-align: center";

                td9.appendChild(lab9);
                td9.className = "border-bottom-1 border-gray";
                td9.style = "height:50px;text-align: center ";
                if (fitered[i].RESERVETARIH != "") {
                    lab9.innerHTML = fitered[i].RESERVETARIH.split(' ')[0];
                } else {
                    lab9.innerHTML = "-";
                }

                tr.appendChild(td9);
                var td10 = document.createElement("td");
                var lab10 = document.createElement("label");

                lab10.style = "background-color: transparent;border: none ;text-align: center";

                td10.appendChild(lab10);
                td10.className = "border-bottom-1 border-gray";
                td10.style = "height:50px;text-align: center";
                if (fitered[i].RESERVEACIKLAMA != "") {
                    lab10.innerHTML = fitered[i].RESERVEACIKLAMA;
                } else {
                    lab10.innerHTML = "-";
                }

                tr.appendChild(td10);
                var td11 = document.createElement("td");
                var lab11 = document.createElement("label");

                lab11.style = "background-color: transparent;border: none ;text-align: center";

                td11.appendChild(lab11);
                td11.className = "border-bottom-1 border-gray";
                td11.style = "height:50px;text-align: center;";
                lab11.innerHTML = (parseFloat(fitered[i].TONAJ)).toLocaleString('tr-TR');
                tr.appendChild(td11);
                var td12 = document.createElement("td");
                var lab12 = document.createElement("label");

                lab12.style = "background-color: transparent;border: none ;text-align: center";

                td12.appendChild(lab12);
                td12.className = "border-bottom-1 border-gray";
                td12.style = "height:50px;text-align: center;";
                lab12.innerHTML = fitered[i].ADET;

                tr.appendChild(td12);
                var td13 = document.createElement("td");
                var lab13 = document.createElement("label");

                lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td13.appendChild(lab13);
                td13.className = "border-bottom-1 border-gray";
                td13.style = "height:50px;text-align: center;font-weight:bold";
                if (fitered[i].TUTAR != "") {
                    lab13.innerHTML = "$ " + parseFloat(fitered[i].TUTAR).toFixed(4);
                } else {
                    lab13.innerHTML = fitered[i].TUTAR;
                }

                tr.appendChild(td13);
                var td14 = document.createElement("td");
                var lab14 = document.createElement("label");

                lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td14.appendChild(lab14);
                td14.className = "border-bottom-1 border-gray";
                td14.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td14);
                if (fitered[i].STOKSAHASI != "") {
                    lab14.innerHTML = fitered[i].STOKSAHASI;
                } else {
                    lab14.innerHTML = "-";
                }

                var td15 = document.createElement("td");
                var lab15 = document.createElement("label");

                lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td15.appendChild(lab15);
                td15.className = "border-bottom-1 border-gray";
                td15.style = "height:50px;text-align: center;display:none";
                if (fitered[i].RULOBANTGIRISTARIH != "") {
                    lab15.innerHTML = fitered[i].RULOBANTGIRISTARIH;
                } else {
                    lab15.innerHTML = "-";
                }

                tr.appendChild(td15);
                var td16 = document.createElement("td");
                var lab16 = document.createElement("label");
                lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td16.appendChild(lab16);
                td16.className = "border-bottom-1 border-gray";
                td16.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRITARIHI != "") {
                    lab16.innerHTML = fitered[i].ISEMRITARIHI;
                } else {
                    lab16.innerHTML = "-";
                }

                tr.appendChild(td16);
                //var td17 = document.createElement("td");
                //var lab17 = document.createElement("label");
                //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td17.appendChild(lab17);
                //td17.className = "border-bottom-1 border-gray";
                //td17.style = "height:50px";
                //lab17.innerHTML = data[i].URETILMETARIHI;
                //tr.appendChild(td17);
                var td17 = document.createElement("td");
                var lab17 = document.createElement("label");

                lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td17.appendChild(lab17);
                td17.className = "border-bottom-1 border-gray";
                td17.style = "height:50px;text-align: center;display:none";
                if (fitered[i].IRSALIYENO != "") {
                    lab17.innerHTML = fitered[i].IRSALIYENO;
                } else {
                    lab17.innerHTML = "-";
                }

                tr.appendChild(td17);
                var td18 = document.createElement("td");
                var lab18 = document.createElement("label");

                lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                if (fitered[i].ISEMRINO != "") {
                    lab18.innerHTML = fitered[i].ISEMRINO;
                } else {
                    lab18.innerHTML = "-";
                }

                td18.appendChild(lab18);
                td18.className = "border-bottom-1 border-gray";
                td18.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td18);
                var td19 = document.createElement("td");
                var lab19 = document.createElement("label");

                lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td19.appendChild(lab19);
                td19.className = "border-bottom-1 border-gray";
                td19.style = "height:50px;text-align: center;display:none";
                if (fitered[i].URETILECEKMALZEMEADI != "") {
                    lab19.innerHTML = fitered[i].URETILECEKMALZEMEADI;
                } else {
                    lab19.innerHTML = "-";
                }

                tr.appendChild(td19);
                //var td20 = document.createElement("td");
                //var lab20 = document.createElement("label");

                //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td20.appendChild(lab20);
                //td20.className = "border-bottom-1 border-gray";
                //td20.style = "height:50px";
                //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                //tr.appendChild(td20);
                //var td21 = document.createElement("td");
                //var lab21 = document.createElement("label");

                //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td21.appendChild(lab21);
                //td21.className = "border-bottom-1 border-gray";
                //td21.style = "height:50px";
                //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                //tr.appendChild(td21);
                //var td22 = document.createElement("td");
                //var lab22 = document.createElement("label");

                //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td22.appendChild(lab22);
                //td22.className = "border-bottom-1 border-gray";
                //td22.style = "height:50px";
                //lab22.innerHTML = data[i].KURAL;
                //tr.appendChild(td22);
                var td23 = document.createElement("td");
                var lab23 = document.createElement("label");

                lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td23.appendChild(lab23);
                td23.className = "border-bottom-1 border-gray";
                td23.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRIKOD != "") {
                    lab23.innerHTML = fitered[i].ISEMRIKOD;
                } else {
                    lab23.innerHTML = "-";
                }

                tr.appendChild(td23);
                document.getElementById("tbody").appendChild(tr);
                fiyatlar.push(parseFloat(fitered[i].TUTAR) * parseFloat(fitered[i].TONAJ));
                fiyatlarton.push(parseFloat(fitered[i].TONAJ));
            }
            var sum = 0;
            var sumton = 0;
            for (let i = 0; i < fiyatlar.length; i++) {
                sum = sum + fiyatlar[i];

            }
            for (let i = 0; i < fiyatlarton.length; i++) {
                sumton = sumton + fiyatlarton[i];
            }

            document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (sum / sumton).toFixed(4);
            document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + sumton.toLocaleString('tr', 'TR');
            var table = document.getElementById("tbody");
            var tr = table.getElementsByTagName("tr");
            var th = document.getElementById("sorttable").getElementsByTagName("th");
            if (g == 1) {
                for (let i = 0; i < tr.length; i++) {
                    var td = tr[i].getElementsByTagName("td");
                    for (let a = 12; a < th.length; a++) {

                        td[a].style.display = "table-cell";


                    }
                }
            }
            filtereddata = fitered;
        }
        function changemen() {
            var fiyatlar = [];
            var fiyatlarton = [];
            var values = $("#rulokodufilter").val();
            var renk = $("#renkkodufilter").val();
            var kal = $("#kalinlikfilter").val();
            var gen = $("#genislikfilter").val();
            var men = $("#menseifilter").val();
            document.getElementById("tbody").replaceChildren();
            
            if (men != "") {
                var fitered = upt.filter(x => men.includes(x.MENSEI));
                if (w == true) {
                    fitered = upt.filter(x => x.KURAL == 0);
                }
                if (k1 == true) {
                    fitered = upt.filter(x => x.KURAL == 1);
                }
                if (k3 == true) {
                    fitered = upt.filter(x => x.KURAL == 3);
                }
            } else {
                var fitered = upt;
            }
            if (values != "") {

                fitered = fitered.filter(x => values.includes(x.RULOKODU));
            } else {
                var valf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!valf.includes(fitered[i].RULOKODU)) {
                        valf.push(fitered[i].RULOKODU);
                    }
                }
                document.getElementById("rulokodufilter").replaceChildren();
                for (let i = 0; i < valf.length; i++) {

                    var option = document.createElement("option");
                    option.value = valf[i];
                    if (valf[i].length == 6) {
                        option.innerHTML = "0" + valf[i].substring(0, 4) + "." + valf[i].substring(valf[i].length - 2);
                    } else {
                        option.innerHTML = valf[i].substring(0, 5) + "." + valf[i].substring(valf[i].length - 2);
                    }
                    document.getElementById("rulokodufilter").appendChild(option);
                }
            }
            if (renk != "") {

                fitered = fitered.filter(x => renk.includes(x.RENKKODU));
            } else {
                var renkf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!renkf.includes(fitered[i].RENKKODU)) {
                        renkf.push(fitered[i].RENKKODU);
                    }
                }
                document.getElementById("renkkodufilter").replaceChildren();
                for (let i = 0; i < renkf.length; i++) {

                    var option = document.createElement("option");
                    option.value = renkf[i];
                    option.innerHTML = renkf[i];
                    document.getElementById("renkkodufilter").appendChild(option);
                }
            }
            if (kal != "") {

                fitered = fitered.filter(x => kal.includes(x.KALINLIK));
            } else {
                var kalf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!kalf.includes(parseFloat(fitered[i].KALINLIK.replace(",", ".")))) {
                        kalf.push(parseFloat(fitered[i].KALINLIK.replace(",", ".")));
                    }
                }
                document.getElementById("kalinlikfilter").replaceChildren();
                kalf.sort(function (a, b) { return a - b });
                for (let i = 0; i < kalf.length; i++) {

                    var option = document.createElement("option");
                    option.value = (kalf[i]).toString().replace('.', ',');
                    option.innerHTML = kalf[i].toFixed(2).toString().replace(",", ".");
                    document.getElementById("kalinlikfilter").appendChild(option);
                }
            }
            if (gen != "") {

                fitered = fitered.filter(x => gen.includes(x.GENISLIK));
            } else {
                var genf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!genf.includes(parseFloat(fitered[i].GENISLIK.replace(',', '.')))) {
                        genf.push(parseFloat(fitered[i].GENISLIK.replace(',', '.')));
                    }
                }
                genf.sort(function (a, b) { return a - b });
                document.getElementById("genislikfilter").replaceChildren();
                for (let i = 0; i < genf.length; i++) {

                    var option = document.createElement("option");
                    option.value = genf[i];
                    option.innerHTML = genf[i].toString().replace('.',',');
                    document.getElementById("genislikfilter").appendChild(option);
                }
            }
            

            for (let i = 0; i < fitered.length; i++) {

                var tr = document.createElement("tr");
                var td = document.createElement("td");
                var lab = document.createElement("label");

                var color = "";
                if (fitered[i].KURAL == 1) {
                    color = "#EAFFF1";
                } else if (fitered[i].KURAL == 0) {
                    color = "white";
                }
                else {
                    color = "#EAF1FF";
                }
                if (fitered[i].RESERVETARIH != "") {
                    color = "#F1EAFF";
                }
                tr.style = "background-color:" + color;
                td.appendChild(lab);
                td.className = "border-bottom-1 border-gray";
                td.style = "background-color:" + color + ";position:sticky;left:0;text-align: center";

                if (fitered[i].RULOKODU.length == 6) {
                    lab.innerHTML = "0" + fitered[i].RULOKODU.substring(0, 4) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                } else {
                    lab.innerHTML = fitered[i].RULOKODU.substring(0, 5) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                }

                lab.style = "font-size:12px;font-weight:bold";
                tr.appendChild(td);
                //var td1 = document.createElement("td");
                //var lab1 = document.createElement("label");

                //lab1.style = "background-color: transparent;border: none; text-align: center";

                //td1.appendChild(lab1);
                //td1.className = "border-bottom-1 border-gray";
                //td1.style = "height:50px;";
                //lab1.innerHTML = data[i].BOBINNO;
                //tr.appendChild(td1);
                var td2 = document.createElement("td");
                var lab2 = document.createElement("label");

                lab2.style = "background-color: transparent;border: none; text-align: center";

                td2.appendChild(lab2);
                td2.className = "border-bottom-1 border-gray";
                td2.style = "height:50px;text-align: center";
                if (fitered[i].KONUM != "") {
                    lab2.innerHTML = fitered[i].KONUM;
                } else {
                    lab2.innerHTML = "-";
                }

                tr.appendChild(td2);
                var td3 = document.createElement("td");
                var lab3 = document.createElement("label");

                lab3.style = "background-color: transparent;border: none; text-align: center";

                td3.appendChild(lab3);
                td3.className = "border-bottom-1 border-gray";
                td3.style = "height:50px;text-align: center";
                if (fitered[i].RENKKODU != "") {
                    lab3.innerHTML = fitered[i].RENKKODU;
                } else {
                    lab3.innerHTML = "-";
                }

                tr.appendChild(td3);
                var td4 = document.createElement("td");
                var lab4 = document.createElement("label");

                lab4.style = "background-color: transparent;border: none ;text-align: center";

                td4.appendChild(lab4);
                td4.className = "border-bottom-1 border-gray";
                td4.style = "height:50px;text-align: center";
                if (fitered[i].KALINLIK != "") {
                    lab4.innerHTML = (parseFloat((fitered[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                } else {
                    lab4.innerHTML = "-";
                }

                tr.appendChild(td4);
                var td5 = document.createElement("td");
                var lab5 = document.createElement("label");

                lab5.style = "background-color: transparent;border: none; text-align: center";

                td5.appendChild(lab5);
                td5.className = "border-bottom-1 border-gray";
                td5.style = "height:50px;text-align: center";
                if (fitered[i].GENISLIK != "") {
                    lab5.innerHTML = fitered[i].GENISLIK;
                } else {
                    lab5.innerHTML = "-";
                }


                tr.appendChild(td5);
                var td6 = document.createElement("td");
                var lab6 = document.createElement("label");

                lab6.style = "background-color: transparent;border: none ;text-align: center";

                td6.appendChild(lab6);
                td6.className = "border-bottom-1 border-gray";
                td6.style = "height:50px;text-align: center";
                if (fitered[i].KALITE != "") {
                    lab6.innerHTML = fitered[i].KALITE;
                } else {
                    lab6.innerHTML = "-";
                }

                tr.appendChild(td6);
                var td7 = document.createElement("td");
                var lab7 = document.createElement("label");

                lab7.style = "background-color: transparent;border: none ;text-align: center";

                td7.appendChild(lab7);
                td7.className = "border-bottom-1 border-gray";
                td7.style = "height:50px;text-align: center";
                if (fitered[i].KAPLAMA != "") {
                    lab7.innerHTML = fitered[i].KAPLAMA;
                } else {
                    lab7.innerHTML = "-";
                }

                tr.appendChild(td7);




                var td8 = document.createElement("td");
                var lab8 = document.createElement("label");

                lab8.style = "background-color: transparent;border: none; text-align: center";

                td8.appendChild(lab8);
                td8.className = "border-bottom-1 border-gray";
                td8.style = "height:50px;text-align: center ";
                if (fitered[i].MENSEI != "") {
                    lab8.innerHTML = fitered[i].MENSEI;
                } else {
                    lab8.innerHTML = "-";
                }

                tr.appendChild(td8);
                var td9 = document.createElement("td");
                var lab9 = document.createElement("label");

                lab9.style = "background-color: transparent;border: none; text-align: center";

                td9.appendChild(lab9);
                td9.className = "border-bottom-1 border-gray";
                td9.style = "height:50px;text-align: center ";
                if (fitered[i].RESERVETARIH != "") {
                    lab9.innerHTML = fitered[i].RESERVETARIH.split(' ')[0];
                } else {
                    lab9.innerHTML = "-";
                }

                tr.appendChild(td9);
                var td10 = document.createElement("td");
                var lab10 = document.createElement("label");

                lab10.style = "background-color: transparent;border: none ;text-align: center";

                td10.appendChild(lab10);
                td10.className = "border-bottom-1 border-gray";
                td10.style = "height:50px;text-align: center";
                if (fitered[i].RESERVEACIKLAMA != "") {
                    lab10.innerHTML = fitered[i].RESERVEACIKLAMA;
                } else {
                    lab10.innerHTML = "-";
                }

                tr.appendChild(td10);
                var td11 = document.createElement("td");
                var lab11 = document.createElement("label");

                lab11.style = "background-color: transparent;border: none ;text-align: center";

                td11.appendChild(lab11);
                td11.className = "border-bottom-1 border-gray";
                td11.style = "height:50px;text-align: center;";
                lab11.innerHTML = (parseFloat(fitered[i].TONAJ)).toLocaleString('tr-TR');
                tr.appendChild(td11);
                var td12 = document.createElement("td");
                var lab12 = document.createElement("label");

                lab12.style = "background-color: transparent;border: none ;text-align: center";

                td12.appendChild(lab12);
                td12.className = "border-bottom-1 border-gray";
                td12.style = "height:50px;text-align: center;";
                lab12.innerHTML = fitered[i].ADET;

                tr.appendChild(td12);
                var td13 = document.createElement("td");
                var lab13 = document.createElement("label");

                lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td13.appendChild(lab13);
                td13.className = "border-bottom-1 border-gray";
                td13.style = "height:50px;text-align: center;font-weight:bold";
                if (fitered[i].TUTAR != "") {
                    lab13.innerHTML = "$ " + parseFloat(fitered[i].TUTAR).toFixed(4);
                } else {
                    lab13.innerHTML = fitered[i].TUTAR;
                }

                tr.appendChild(td13);
                var td14 = document.createElement("td");
                var lab14 = document.createElement("label");

                lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td14.appendChild(lab14);
                td14.className = "border-bottom-1 border-gray";
                td14.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td14);
                if (fitered[i].STOKSAHASI != "") {
                    lab14.innerHTML = fitered[i].STOKSAHASI;
                } else {
                    lab14.innerHTML = "-";
                }

                var td15 = document.createElement("td");
                var lab15 = document.createElement("label");

                lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td15.appendChild(lab15);
                td15.className = "border-bottom-1 border-gray";
                td15.style = "height:50px;text-align: center;display:none";
                if (fitered[i].RULOBANTGIRISTARIH != "") {
                    lab15.innerHTML = fitered[i].RULOBANTGIRISTARIH;
                } else {
                    lab15.innerHTML = "-";
                }

                tr.appendChild(td15);
                var td16 = document.createElement("td");
                var lab16 = document.createElement("label");
                lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td16.appendChild(lab16);
                td16.className = "border-bottom-1 border-gray";
                td16.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRITARIHI != "") {
                    lab16.innerHTML = fitered[i].ISEMRITARIHI;
                } else {
                    lab16.innerHTML = "-";
                }

                tr.appendChild(td16);
                //var td17 = document.createElement("td");
                //var lab17 = document.createElement("label");
                //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td17.appendChild(lab17);
                //td17.className = "border-bottom-1 border-gray";
                //td17.style = "height:50px";
                //lab17.innerHTML = data[i].URETILMETARIHI;
                //tr.appendChild(td17);
                var td17 = document.createElement("td");
                var lab17 = document.createElement("label");

                lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td17.appendChild(lab17);
                td17.className = "border-bottom-1 border-gray";
                td17.style = "height:50px;text-align: center;display:none";
                if (fitered[i].IRSALIYENO != "") {
                    lab17.innerHTML = fitered[i].IRSALIYENO;
                } else {
                    lab17.innerHTML = "-";
                }

                tr.appendChild(td17);
                var td18 = document.createElement("td");
                var lab18 = document.createElement("label");

                lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                if (fitered[i].ISEMRINO != "") {
                    lab18.innerHTML = fitered[i].ISEMRINO;
                } else {
                    lab18.innerHTML = "-";
                }

                td18.appendChild(lab18);
                td18.className = "border-bottom-1 border-gray";
                td18.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td18);
                var td19 = document.createElement("td");
                var lab19 = document.createElement("label");

                lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td19.appendChild(lab19);
                td19.className = "border-bottom-1 border-gray";
                td19.style = "height:50px;text-align: center;display:none";
                if (fitered[i].URETILECEKMALZEMEADI != "") {
                    lab19.innerHTML = fitered[i].URETILECEKMALZEMEADI;
                } else {
                    lab19.innerHTML = "-";
                }

                tr.appendChild(td19);
                //var td20 = document.createElement("td");
                //var lab20 = document.createElement("label");

                //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td20.appendChild(lab20);
                //td20.className = "border-bottom-1 border-gray";
                //td20.style = "height:50px";
                //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                //tr.appendChild(td20);
                //var td21 = document.createElement("td");
                //var lab21 = document.createElement("label");

                //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td21.appendChild(lab21);
                //td21.className = "border-bottom-1 border-gray";
                //td21.style = "height:50px";
                //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                //tr.appendChild(td21);
                //var td22 = document.createElement("td");
                //var lab22 = document.createElement("label");

                //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td22.appendChild(lab22);
                //td22.className = "border-bottom-1 border-gray";
                //td22.style = "height:50px";
                //lab22.innerHTML = data[i].KURAL;
                //tr.appendChild(td22);
                var td23 = document.createElement("td");
                var lab23 = document.createElement("label");

                lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td23.appendChild(lab23);
                td23.className = "border-bottom-1 border-gray";
                td23.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRIKOD != "") {
                    lab23.innerHTML = fitered[i].ISEMRIKOD;
                } else {
                    lab23.innerHTML = "-";
                }

                tr.appendChild(td23);
                document.getElementById("tbody").appendChild(tr);
                fiyatlar.push(parseFloat(fitered[i].TUTAR) * parseFloat(fitered[i].TONAJ));
                fiyatlarton.push(parseFloat(fitered[i].TONAJ));
            }
            var sum = 0;
            var sumton = 0;
            for (let i = 0; i < fiyatlar.length; i++) {
                sum = sum + fiyatlar[i];

            }
            for (let i = 0; i < fiyatlarton.length; i++) {
                sumton = sumton + fiyatlarton[i];
            }

            document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (sum / sumton).toFixed(4);
            document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + sumton.toLocaleString('tr', 'TR');
            var table = document.getElementById("tbody");
            var tr = table.getElementsByTagName("tr");
            var th = document.getElementById("sorttable").getElementsByTagName("th");
            if (g == 1) {
                for (let i = 0; i < tr.length; i++) {
                    var td = tr[i].getElementsByTagName("td");
                    for (let a = 12; a < th.length; a++) {

                        td[a].style.display = "table-cell";


                    }
                }
            }
            filtereddata = fitered;
        }
        function white() {
            w = true;
            k1 = false;
            k3 = false;
            var fiyatlar = [];
            var fiyatlarton = [];
            document.getElementById("tbody").replaceChildren();
            var fitered = filtereddata.filter(x => x.KURAL == "0");
            var values = $("#rulokodufilter").val();
            var renk = $("#renkkodufilter").val();
            var kal = $("#kalinlikfilter").val();
            var gen = $("#genislikfilter").val();
            var men = $("#menseifilter").val();

            if (values != "") {
                fitered = fitered.filter(x => values.includes(x.RULOKODU));
            } else {
                var valf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!valf.includes(fitered[i].RULOKODU)) {
                        valf.push(fitered[i].RULOKODU);
                    }
                }
                valf.sort();
                document.getElementById("rulokodufilter").replaceChildren();
                for (let i = 0; i < valf.length; i++) {

                    var option = document.createElement("option");
                    option.value = valf[i];
                    if (valf[i].length == 6) {
                        option.innerHTML = "0" + valf[i].substring(0, 4) + "." + valf[i].substring(valf[i].length - 2);
                    } else {
                        option.innerHTML = valf[i].substring(0, 5) + "." + valf[i].substring(valf[i].length - 2);
                    }
                    document.getElementById("rulokodufilter").appendChild(option);
                }
            }

            if (renk != "") {

                fitered = fitered.filter(x => renk.includes(x.RENKKODU));

            } else {
                var renkf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!renkf.includes(fitered[i].RENKKODU)) {
                        renkf.push(fitered[i].RENKKODU);
                    }
                }
                renkf.sort();
                document.getElementById("renkkodufilter").replaceChildren();
                for (let i = 0; i < renkf.length; i++) {

                    var option = document.createElement("option");
                    option.value = renkf[i];
                    option.innerHTML = renkf[i];
                    document.getElementById("renkkodufilter").appendChild(option);
                }
            }
            if (kal != "") {

                fitered = fitered.filter(x => kal.includes(x.KALINLIK));
            } else {
                var kalf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!kalf.includes(parseFloat(fitered[i].KALINLIK.replace(",", ".")))) {
                        kalf.push(parseFloat(fitered[i].KALINLIK.replace(",", ".")));
                    }
                }
                document.getElementById("kalinlikfilter").replaceChildren();
                kalf.sort(function (a, b) { return a - b });
                for (let i = 0; i < kalf.length; i++) {

                    var option = document.createElement("option");
                    option.value = (kalf[i]).toString().replace('.', ',');
                    option.innerHTML = (parseFloat((kalf[i].toString()).replace(",", ".")).toFixed(2)).replace(".", ",");
                    document.getElementById("kalinlikfilter").appendChild(option);
                }
            }
            if (gen != "") {

                fitered = fitered.filter(x => gen.includes(x.GENISLIK));
            } else {
                var genf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!genf.includes(parseFloat(fitered[i].GENISLIK.replace(",", ".")))) {
                        genf.push(parseFloat(fitered[i].GENISLIK.replace(",", ".")));
                    }
                }
                document.getElementById("genislikfilter").replaceChildren();
                genf.sort(function (a, b) { return a - b });
                for (let i = 0; i < genf.length; i++) {

                    var option = document.createElement("option");
                    option.value = genf[i];
                    option.innerHTML = genf[i].toString().replace(".", ",");;
                    document.getElementById("genislikfilter").appendChild(option);
                }
            }
            if (men != "") {

                fitered = fitered.filter(x => men.includes(x.MENSEI));
            } else {
                var menf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!menf.includes(fitered[i].MENSEI.trim())) {
                        menf.push(fitered[i].MENSEI.trim());
                    }
                }
                document.getElementById("menseifilter").replaceChildren();
                menf.sort();
                for (let i = 0; i < menf.length; i++) {

                    var option = document.createElement("option");
                    option.value = menf[i];
                    option.innerHTML = menf[i];
                    document.getElementById("menseifilter").appendChild(option);
                }
            }
            for (let i = 0; i < fitered.length; i++) {

                var tr = document.createElement("tr");
                var td = document.createElement("td");
                var lab = document.createElement("label");

                var color = "";
                if (fitered[i].KURAL == 1) {
                    color = "#EAFFF1";
                } else if (fitered[i].KURAL == 0) {
                    color = "white";
                }
                else {
                    color = "#EAF1FF";
                }
                if (fitered[i].RESERVETARIH != "") {
                    color = "#F1EAFF";
                }
                tr.style = "background-color:" + color;
                td.appendChild(lab);
                td.className = "border-bottom-1 border-gray";
                td.style = "background-color:" + color + ";position:sticky;left:0;text-align: center";

                if (fitered[i].RULOKODU.length == 6) {
                    lab.innerHTML = "0" + fitered[i].RULOKODU.substring(0, 4) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                } else {
                    lab.innerHTML = fitered[i].RULOKODU.substring(0, 5) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                }

                lab.style = "font-size:12px;font-weight:bold";
                tr.appendChild(td);
                //var td1 = document.createElement("td");
                //var lab1 = document.createElement("label");

                //lab1.style = "background-color: transparent;border: none; text-align: center";

                //td1.appendChild(lab1);
                //td1.className = "border-bottom-1 border-gray";
                //td1.style = "height:50px;";
                //lab1.innerHTML = data[i].BOBINNO;
                //tr.appendChild(td1);
                var td2 = document.createElement("td");
                var lab2 = document.createElement("label");

                lab2.style = "background-color: transparent;border: none; text-align: center";

                td2.appendChild(lab2);
                td2.className = "border-bottom-1 border-gray";
                td2.style = "height:50px;text-align: center";
                if (fitered[i].KONUM != "") {
                    lab2.innerHTML = fitered[i].KONUM;
                } else {
                    lab2.innerHTML = "-";
                }

                tr.appendChild(td2);
                var td3 = document.createElement("td");
                var lab3 = document.createElement("label");

                lab3.style = "background-color: transparent;border: none; text-align: center";

                td3.appendChild(lab3);
                td3.className = "border-bottom-1 border-gray";
                td3.style = "height:50px;text-align: center";
                if (fitered[i].RENKKODU != "") {
                    lab3.innerHTML = fitered[i].RENKKODU;
                } else {
                    lab3.innerHTML = "-";
                }

                tr.appendChild(td3);
                var td4 = document.createElement("td");
                var lab4 = document.createElement("label");

                lab4.style = "background-color: transparent;border: none ;text-align: center";

                td4.appendChild(lab4);
                td4.className = "border-bottom-1 border-gray";
                td4.style = "height:50px;text-align: center";
                if (fitered[i].KALINLIK != "") {
                    lab4.innerHTML = (parseFloat((fitered[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                } else {
                    lab4.innerHTML = "-";
                }

                tr.appendChild(td4);
                var td5 = document.createElement("td");
                var lab5 = document.createElement("label");

                lab5.style = "background-color: transparent;border: none; text-align: center";

                td5.appendChild(lab5);
                td5.className = "border-bottom-1 border-gray";
                td5.style = "height:50px;text-align: center";
                if (fitered[i].GENISLIK != "") {
                    lab5.innerHTML = fitered[i].GENISLIK;
                } else {
                    lab5.innerHTML = "-";
                }


                tr.appendChild(td5);
                var td6 = document.createElement("td");
                var lab6 = document.createElement("label");

                lab6.style = "background-color: transparent;border: none ;text-align: center";

                td6.appendChild(lab6);
                td6.className = "border-bottom-1 border-gray";
                td6.style = "height:50px;text-align: center";
                if (fitered[i].KALITE != "") {
                    lab6.innerHTML = fitered[i].KALITE;
                } else {
                    lab6.innerHTML = "-";
                }

                tr.appendChild(td6);
                var td7 = document.createElement("td");
                var lab7 = document.createElement("label");

                lab7.style = "background-color: transparent;border: none ;text-align: center";

                td7.appendChild(lab7);
                td7.className = "border-bottom-1 border-gray";
                td7.style = "height:50px;text-align: center";
                if (fitered[i].KAPLAMA != "") {
                    lab7.innerHTML = fitered[i].KAPLAMA;
                } else {
                    lab7.innerHTML = "-";
                }

                tr.appendChild(td7);




                var td8 = document.createElement("td");
                var lab8 = document.createElement("label");

                lab8.style = "background-color: transparent;border: none; text-align: center";

                td8.appendChild(lab8);
                td8.className = "border-bottom-1 border-gray";
                td8.style = "height:50px;text-align: center ";
                if (fitered[i].MENSEI != "") {
                    lab8.innerHTML = fitered[i].MENSEI;
                } else {
                    lab8.innerHTML = "-";
                }

                tr.appendChild(td8);
                var td9 = document.createElement("td");
                var lab9 = document.createElement("label");

                lab9.style = "background-color: transparent;border: none; text-align: center";

                td9.appendChild(lab9);
                td9.className = "border-bottom-1 border-gray";
                td9.style = "height:50px;text-align: center ";
                if (fitered[i].RESERVETARIH != "") {
                    lab9.innerHTML = fitered[i].RESERVETARIH.split(' ')[0];
                } else {
                    lab9.innerHTML = "-";
                }

                tr.appendChild(td9);
                var td10 = document.createElement("td");
                var lab10 = document.createElement("label");

                lab10.style = "background-color: transparent;border: none ;text-align: center";

                td10.appendChild(lab10);
                td10.className = "border-bottom-1 border-gray";
                td10.style = "height:50px;text-align: center";
                if (fitered[i].RESERVEACIKLAMA != "") {
                    lab10.innerHTML = fitered[i].RESERVEACIKLAMA;
                } else {
                    lab10.innerHTML = "-";
                }

                tr.appendChild(td10);
                var td11 = document.createElement("td");
                var lab11 = document.createElement("label");

                lab11.style = "background-color: transparent;border: none ;text-align: center";

                td11.appendChild(lab11);
                td11.className = "border-bottom-1 border-gray";
                td11.style = "height:50px;text-align: center;";
                lab11.innerHTML = (parseFloat(fitered[i].TONAJ)).toLocaleString('tr-TR');
                tr.appendChild(td11);
                var td12 = document.createElement("td");
                var lab12 = document.createElement("label");

                lab12.style = "background-color: transparent;border: none ;text-align: center";

                td12.appendChild(lab12);
                td12.className = "border-bottom-1 border-gray";
                td12.style = "height:50px;text-align: center;";
                lab12.innerHTML = fitered[i].ADET;

                tr.appendChild(td12);
                var td13 = document.createElement("td");
                var lab13 = document.createElement("label");

                lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td13.appendChild(lab13);
                td13.className = "border-bottom-1 border-gray";
                td13.style = "height:50px;text-align: center;font-weight:bold";
                if (fitered[i].TUTAR != "") {
                    lab13.innerHTML = "$ " + parseFloat(fitered[i].TUTAR).toFixed(4);
                } else {
                    lab13.innerHTML = fitered[i].TUTAR;
                }

                tr.appendChild(td13);
                var td14 = document.createElement("td");
                var lab14 = document.createElement("label");

                lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td14.appendChild(lab14);
                td14.className = "border-bottom-1 border-gray";
                td14.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td14);
                if (fitered[i].STOKSAHASI != "") {
                    lab14.innerHTML = fitered[i].STOKSAHASI;
                } else {
                    lab14.innerHTML = "-";
                }

                var td15 = document.createElement("td");
                var lab15 = document.createElement("label");

                lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td15.appendChild(lab15);
                td15.className = "border-bottom-1 border-gray";
                td15.style = "height:50px;text-align: center;display:none";
                if (fitered[i].RULOBANTGIRISTARIH != "") {
                    lab15.innerHTML = fitered[i].RULOBANTGIRISTARIH;
                } else {
                    lab15.innerHTML = "-";
                }

                tr.appendChild(td15);
                var td16 = document.createElement("td");
                var lab16 = document.createElement("label");
                lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td16.appendChild(lab16);
                td16.className = "border-bottom-1 border-gray";
                td16.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRITARIHI != "") {
                    lab16.innerHTML = fitered[i].ISEMRITARIHI;
                } else {
                    lab16.innerHTML = "-";
                }

                tr.appendChild(td16);
                //var td17 = document.createElement("td");
                //var lab17 = document.createElement("label");
                //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td17.appendChild(lab17);
                //td17.className = "border-bottom-1 border-gray";
                //td17.style = "height:50px";
                //lab17.innerHTML = data[i].URETILMETARIHI;
                //tr.appendChild(td17);
                var td17 = document.createElement("td");
                var lab17 = document.createElement("label");

                lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td17.appendChild(lab17);
                td17.className = "border-bottom-1 border-gray";
                td17.style = "height:50px;text-align: center;display:none";
                if (fitered[i].IRSALIYENO != "") {
                    lab17.innerHTML = fitered[i].IRSALIYENO;
                } else {
                    lab17.innerHTML = "-";
                }

                tr.appendChild(td17);
                var td18 = document.createElement("td");
                var lab18 = document.createElement("label");

                lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                if (fitered[i].ISEMRINO != "") {
                    lab18.innerHTML = fitered[i].ISEMRINO;
                } else {
                    lab18.innerHTML = "-";
                }

                td18.appendChild(lab18);
                td18.className = "border-bottom-1 border-gray";
                td18.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td18);
                var td19 = document.createElement("td");
                var lab19 = document.createElement("label");

                lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td19.appendChild(lab19);
                td19.className = "border-bottom-1 border-gray";
                td19.style = "height:50px;text-align: center;display:none";
                if (fitered[i].URETILECEKMALZEMEADI != "") {
                    lab19.innerHTML = fitered[i].URETILECEKMALZEMEADI;
                } else {
                    lab19.innerHTML = "-";
                }

                tr.appendChild(td19);
                //var td20 = document.createElement("td");
                //var lab20 = document.createElement("label");

                //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td20.appendChild(lab20);
                //td20.className = "border-bottom-1 border-gray";
                //td20.style = "height:50px";
                //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                //tr.appendChild(td20);
                //var td21 = document.createElement("td");
                //var lab21 = document.createElement("label");

                //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td21.appendChild(lab21);
                //td21.className = "border-bottom-1 border-gray";
                //td21.style = "height:50px";
                //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                //tr.appendChild(td21);
                //var td22 = document.createElement("td");
                //var lab22 = document.createElement("label");

                //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td22.appendChild(lab22);
                //td22.className = "border-bottom-1 border-gray";
                //td22.style = "height:50px";
                //lab22.innerHTML = data[i].KURAL;
                //tr.appendChild(td22);
                var td23 = document.createElement("td");
                var lab23 = document.createElement("label");

                lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td23.appendChild(lab23);
                td23.className = "border-bottom-1 border-gray";
                td23.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRIKOD != "") {
                    lab23.innerHTML = fitered[i].ISEMRIKOD;
                } else {
                    lab23.innerHTML = "-";
                }

                tr.appendChild(td23);
                document.getElementById("tbody").appendChild(tr);
                fiyatlar.push(parseFloat(fitered[i].TUTAR) * parseFloat(fitered[i].TONAJ));
                fiyatlarton.push(parseFloat(fitered[i].TONAJ));
            }
            var sum = 0;
            var sumton = 0;
            for (let i = 0; i < fiyatlar.length; i++) {
                sum = sum + fiyatlar[i];

            }
            for (let i = 0; i < fiyatlarton.length; i++) {
                sumton = sumton + fiyatlarton[i];
            }

            document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (sum / sumton).toFixed(4);
            document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + sumton.toLocaleString('tr', 'TR');
            var table = document.getElementById("tbody");
            var tr = table.getElementsByTagName("tr");
            var th = document.getElementById("sorttable").getElementsByTagName("th");
            if (g == 1) {
                for (let i = 0; i < tr.length; i++) {
                    var td = tr[i].getElementsByTagName("td");
                    for (let a = 12; a < th.length; a++) {

                        td[a].style.display = "table-cell";


                    }
                }
            }
           
           
        }
        function kural1() {
            k1 = true;
            w = false;
            k3 = false;
            var fiyatlar = [];
            var fiyatlarton = [];
            var values = $("#rulokodufilter").val();
            var renk = $("#renkkodufilter").val();
            var kal = $("#kalinlikfilter").val();
            var gen = $("#genislikfilter").val();
            var men = $("#menseifilter").val();
            document.getElementById("tbody").replaceChildren();
            var fitered = upt.filter(x => x.KURAL == 1);

            if (values != "") {
                fitered = fitered.filter(x => values.includes(x.RULOKODU));
            } else {
                var valf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!valf.includes(fitered[i].RULOKODU)) {
                        valf.push(fitered[i].RULOKODU);
                    }
                }
                valf.sort();
                document.getElementById("rulokodufilter").replaceChildren();
                for (let i = 0; i < valf.length; i++) {

                    var option = document.createElement("option");
                    option.value = valf[i];
                    if (valf[i].length == 6) {
                        option.innerHTML = "0" + valf[i].substring(0, 4) + "." + valf[i].substring(valf[i].length - 2);
                    } else {
                        option.innerHTML = valf[i].substring(0, 5) + "." + valf[i].substring(valf[i].length - 2);
                    }
                    document.getElementById("rulokodufilter").appendChild(option);
                }
            }

            if (renk != "") {

                fitered = fitered.filter(x => renk.includes(x.RENKKODU));

            } else {
                var renkf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!renkf.includes(fitered[i].RENKKODU)) {
                        renkf.push(fitered[i].RENKKODU);
                    }
                }
                renkf.sort();
                document.getElementById("renkkodufilter").replaceChildren();
                for (let i = 0; i < renkf.length; i++) {

                    var option = document.createElement("option");
                    option.value = renkf[i];
                    option.innerHTML = renkf[i];
                    document.getElementById("renkkodufilter").appendChild(option);
                }
            }
            if (kal != "") {
               
                fitered = fitered.filter(x => kal.includes(x.KALINLIK));
                
            } else {
                var kalf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!kalf.includes(parseFloat(fitered[i].KALINLIK.replace(",", ".")))) {
                        kalf.push(parseFloat(fitered[i].KALINLIK.replace(",", ".")));
                    }
                }
                document.getElementById("kalinlikfilter").replaceChildren();
                kalf.sort(function (a, b) { return a - b });
                for (let i = 0; i < kalf.length; i++) {

                    var option = document.createElement("option");
                    option.value = (kalf[i]).toString().replace('.', ',');
                    option.innerHTML = (parseFloat((kalf[i].toString()).replace(",", ".")).toFixed(2)).replace(".", ",");
                    document.getElementById("kalinlikfilter").appendChild(option);
                }
            }
            if (gen != "") {

                fitered = fitered.filter(x => gen.includes(x.GENISLIK));
            } else {
                var genf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!genf.includes(parseFloat(fitered[i].GENISLIK.replace(",", ".")))) {
                        genf.push(parseFloat(fitered[i].GENISLIK.replace(",", ".")));
                    }
                }
                document.getElementById("genislikfilter").replaceChildren();
                genf.sort(function (a, b) { return a - b });
                for (let i = 0; i < genf.length; i++) {

                    var option = document.createElement("option");
                    option.value = genf[i];
                    option.innerHTML = genf[i].toString().replace(".", ",");;
                    document.getElementById("genislikfilter").appendChild(option);
                }
            }
            if (men != "") {

                fitered = fitered.filter(x => men.includes(x.MENSEI));
            } else {
                var menf = [];
                for (let i = 0; i < fitered.length; i++) {
                    if (!menf.includes(fitered[i].MENSEI.trim())) {
                        menf.push(fitered[i].MENSEI.trim());
                    }
                }
                document.getElementById("menseifilter").replaceChildren();
                menf.sort();
                for (let i = 0; i < menf.length; i++) {

                    var option = document.createElement("option");
                    option.value = menf[i];
                    option.innerHTML = menf[i];
                    document.getElementById("menseifilter").appendChild(option);
                }
            }
            for (let i = 0; i < fitered.length; i++) {

                var tr = document.createElement("tr");
                var td = document.createElement("td");
                var lab = document.createElement("label");

                var color = "";
                if (fitered[i].KURAL == 1) {
                    color = "#EAFFF1";
                } else if (fitered[i].KURAL == 0) {
                    color = "white";
                }
                else {
                    color = "#EAF1FF";
                }
                if (fitered[i].RESERVETARIH != "") {
                    color = "#F1EAFF";
                }
                tr.style = "background-color:" + color;
                td.appendChild(lab);
                td.className = "border-bottom-1 border-gray";
                td.style = "background-color:" + color + ";position:sticky;left:0;text-align: center";

                if (fitered[i].RULOKODU.length == 6) {
                    lab.innerHTML = "0" + fitered[i].RULOKODU.substring(0, 4) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                } else {
                    lab.innerHTML = fitered[i].RULOKODU.substring(0, 5) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                }

                lab.style = "font-size:12px;font-weight:bold";
                tr.appendChild(td);
                //var td1 = document.createElement("td");
                //var lab1 = document.createElement("label");

                //lab1.style = "background-color: transparent;border: none; text-align: center";

                //td1.appendChild(lab1);
                //td1.className = "border-bottom-1 border-gray";
                //td1.style = "height:50px;";
                //lab1.innerHTML = data[i].BOBINNO;
                //tr.appendChild(td1);
                var td2 = document.createElement("td");
                var lab2 = document.createElement("label");

                lab2.style = "background-color: transparent;border: none; text-align: center";

                td2.appendChild(lab2);
                td2.className = "border-bottom-1 border-gray";
                td2.style = "height:50px;text-align: center";
                if (fitered[i].KONUM != "") {
                    lab2.innerHTML = fitered[i].KONUM;
                } else {
                    lab2.innerHTML = "-";
                }

                tr.appendChild(td2);
                var td3 = document.createElement("td");
                var lab3 = document.createElement("label");

                lab3.style = "background-color: transparent;border: none; text-align: center";

                td3.appendChild(lab3);
                td3.className = "border-bottom-1 border-gray";
                td3.style = "height:50px;text-align: center";
                if (fitered[i].RENKKODU != "") {
                    lab3.innerHTML = fitered[i].RENKKODU;
                } else {
                    lab3.innerHTML = "-";
                }

                tr.appendChild(td3);
                var td4 = document.createElement("td");
                var lab4 = document.createElement("label");

                lab4.style = "background-color: transparent;border: none ;text-align: center";

                td4.appendChild(lab4);
                td4.className = "border-bottom-1 border-gray";
                td4.style = "height:50px;text-align: center";
                if (fitered[i].KALINLIK != "") {
                    lab4.innerHTML = (parseFloat((fitered[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                } else {
                    lab4.innerHTML = "-";
                }

                tr.appendChild(td4);
                var td5 = document.createElement("td");
                var lab5 = document.createElement("label");

                lab5.style = "background-color: transparent;border: none; text-align: center";

                td5.appendChild(lab5);
                td5.className = "border-bottom-1 border-gray";
                td5.style = "height:50px;text-align: center";
                if (fitered[i].GENISLIK != "") {
                    lab5.innerHTML = fitered[i].GENISLIK;
                } else {
                    lab5.innerHTML = "-";
                }


                tr.appendChild(td5);
                var td6 = document.createElement("td");
                var lab6 = document.createElement("label");

                lab6.style = "background-color: transparent;border: none ;text-align: center";

                td6.appendChild(lab6);
                td6.className = "border-bottom-1 border-gray";
                td6.style = "height:50px;text-align: center";
                if (fitered[i].KALITE != "") {
                    lab6.innerHTML = fitered[i].KALITE;
                } else {
                    lab6.innerHTML = "-";
                }

                tr.appendChild(td6);
                var td7 = document.createElement("td");
                var lab7 = document.createElement("label");

                lab7.style = "background-color: transparent;border: none ;text-align: center";

                td7.appendChild(lab7);
                td7.className = "border-bottom-1 border-gray";
                td7.style = "height:50px;text-align: center";
                if (fitered[i].KAPLAMA != "") {
                    lab7.innerHTML = fitered[i].KAPLAMA;
                } else {
                    lab7.innerHTML = "-";
                }

                tr.appendChild(td7);




                var td8 = document.createElement("td");
                var lab8 = document.createElement("label");

                lab8.style = "background-color: transparent;border: none; text-align: center";

                td8.appendChild(lab8);
                td8.className = "border-bottom-1 border-gray";
                td8.style = "height:50px;text-align: center ";
                if (fitered[i].MENSEI != "") {
                    lab8.innerHTML = fitered[i].MENSEI;
                } else {
                    lab8.innerHTML = "-";
                }

                tr.appendChild(td8);
                var td9 = document.createElement("td");
                var lab9 = document.createElement("label");

                lab9.style = "background-color: transparent;border: none; text-align: center";

                td9.appendChild(lab9);
                td9.className = "border-bottom-1 border-gray";
                td9.style = "height:50px;text-align: center ";
                if (fitered[i].RESERVETARIH != "") {
                    lab9.innerHTML = fitered[i].RESERVETARIH.split(' ')[0];
                } else {
                    lab9.innerHTML = "-";
                }

                tr.appendChild(td9);
                var td10 = document.createElement("td");
                var lab10 = document.createElement("label");

                lab10.style = "background-color: transparent;border: none ;text-align: center";

                td10.appendChild(lab10);
                td10.className = "border-bottom-1 border-gray";
                td10.style = "height:50px;text-align: center";
                if (fitered[i].RESERVEACIKLAMA != "") {
                    lab10.innerHTML = fitered[i].RESERVEACIKLAMA;
                } else {
                    lab10.innerHTML = "-";
                }

                tr.appendChild(td10);
                var td11 = document.createElement("td");
                var lab11 = document.createElement("label");

                lab11.style = "background-color: transparent;border: none ;text-align: center";

                td11.appendChild(lab11);
                td11.className = "border-bottom-1 border-gray";
                td11.style = "height:50px;text-align: center;";
                lab11.innerHTML = (parseFloat(fitered[i].TONAJ)).toLocaleString('tr-TR');
                tr.appendChild(td11);
                var td12 = document.createElement("td");
                var lab12 = document.createElement("label");

                lab12.style = "background-color: transparent;border: none ;text-align: center";

                td12.appendChild(lab12);
                td12.className = "border-bottom-1 border-gray";
                td12.style = "height:50px;text-align: center;";
                lab12.innerHTML = fitered[i].ADET;

                tr.appendChild(td12);
                var td13 = document.createElement("td");
                var lab13 = document.createElement("label");

                lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td13.appendChild(lab13);
                td13.className = "border-bottom-1 border-gray";
                td13.style = "height:50px;text-align: center;font-weight:bold";
                if (fitered[i].TUTAR != "") {
                    lab13.innerHTML = "$ " + parseFloat(fitered[i].TUTAR).toFixed(4);
                } else {
                    lab13.innerHTML = fitered[i].TUTAR;
                }

                tr.appendChild(td13);
                var td14 = document.createElement("td");
                var lab14 = document.createElement("label");

                lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td14.appendChild(lab14);
                td14.className = "border-bottom-1 border-gray";
                td14.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td14);
                if (fitered[i].STOKSAHASI != "") {
                    lab14.innerHTML = fitered[i].STOKSAHASI;
                } else {
                    lab14.innerHTML = "-";
                }

                var td15 = document.createElement("td");
                var lab15 = document.createElement("label");

                lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td15.appendChild(lab15);
                td15.className = "border-bottom-1 border-gray";
                td15.style = "height:50px;text-align: center;display:none";
                if (fitered[i].RULOBANTGIRISTARIH != "") {
                    lab15.innerHTML = fitered[i].RULOBANTGIRISTARIH;
                } else {
                    lab15.innerHTML = "-";
                }

                tr.appendChild(td15);
                var td16 = document.createElement("td");
                var lab16 = document.createElement("label");
                lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td16.appendChild(lab16);
                td16.className = "border-bottom-1 border-gray";
                td16.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRITARIHI != "") {
                    lab16.innerHTML = fitered[i].ISEMRITARIHI;
                } else {
                    lab16.innerHTML = "-";
                }

                tr.appendChild(td16);
                //var td17 = document.createElement("td");
                //var lab17 = document.createElement("label");
                //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td17.appendChild(lab17);
                //td17.className = "border-bottom-1 border-gray";
                //td17.style = "height:50px";
                //lab17.innerHTML = data[i].URETILMETARIHI;
                //tr.appendChild(td17);
                var td17 = document.createElement("td");
                var lab17 = document.createElement("label");

                lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td17.appendChild(lab17);
                td17.className = "border-bottom-1 border-gray";
                td17.style = "height:50px;text-align: center;display:none";
                if (fitered[i].IRSALIYENO != "") {
                    lab17.innerHTML = fitered[i].IRSALIYENO;
                } else {
                    lab17.innerHTML = "-";
                }

                tr.appendChild(td17);
                var td18 = document.createElement("td");
                var lab18 = document.createElement("label");

                lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                if (fitered[i].ISEMRINO != "") {
                    lab18.innerHTML = fitered[i].ISEMRINO;
                } else {
                    lab18.innerHTML = "-";
                }

                td18.appendChild(lab18);
                td18.className = "border-bottom-1 border-gray";
                td18.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td18);
                var td19 = document.createElement("td");
                var lab19 = document.createElement("label");

                lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td19.appendChild(lab19);
                td19.className = "border-bottom-1 border-gray";
                td19.style = "height:50px;text-align: center;display:none";
                if (fitered[i].URETILECEKMALZEMEADI != "") {
                    lab19.innerHTML = fitered[i].URETILECEKMALZEMEADI;
                } else {
                    lab19.innerHTML = "-";
                }

                tr.appendChild(td19);
                //var td20 = document.createElement("td");
                //var lab20 = document.createElement("label");

                //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td20.appendChild(lab20);
                //td20.className = "border-bottom-1 border-gray";
                //td20.style = "height:50px";
                //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                //tr.appendChild(td20);
                //var td21 = document.createElement("td");
                //var lab21 = document.createElement("label");

                //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td21.appendChild(lab21);
                //td21.className = "border-bottom-1 border-gray";
                //td21.style = "height:50px";
                //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                //tr.appendChild(td21);
                //var td22 = document.createElement("td");
                //var lab22 = document.createElement("label");

                //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td22.appendChild(lab22);
                //td22.className = "border-bottom-1 border-gray";
                //td22.style = "height:50px";
                //lab22.innerHTML = data[i].KURAL;
                //tr.appendChild(td22);
                var td23 = document.createElement("td");
                var lab23 = document.createElement("label");

                lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td23.appendChild(lab23);
                td23.className = "border-bottom-1 border-gray";
                td23.style = "height:50px;text-align: center;display:none";
                if (fitered[i].ISEMRIKOD != "") {
                    lab23.innerHTML = fitered[i].ISEMRIKOD;
                } else {
                    lab23.innerHTML = "-";
                }

                tr.appendChild(td23);
                document.getElementById("tbody").appendChild(tr);
                fiyatlar.push(parseFloat(fitered[i].TUTAR) * parseFloat(fitered[i].TONAJ));
                fiyatlarton.push(parseFloat(fitered[i].TONAJ));

            }
            var sum = 0;
            var sumton = 0;
            for (let i = 0; i < fiyatlar.length; i++) {
                sum = sum + fiyatlar[i];

            }
            for (let i = 0; i < fiyatlarton.length; i++) {
                sumton = sumton + fiyatlarton[i];
            }

            document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (sum / sumton).toFixed(4);
            document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + sumton.toLocaleString('tr', 'TR');
            var table = document.getElementById("tbody");
            var tr = table.getElementsByTagName("tr");
            var th = document.getElementById("sorttable").getElementsByTagName("th");

            if (g == 1) {
                for (let i = 0; i < tr.length; i++) {
                    var td = tr[i].getElementsByTagName("td");
                    for (let a = 12; a < th.length; a++) {

                        td[a].style.display = "table-cell";


                    }
                }
            }
            

         
        }
        function kural3() {
            k3 = true;
            k1 = false;
            w = false;
            var fiyatlar = [];
            var fiyatlarton = [];
            document.getElementById("tbody").replaceChildren();
            var fitered = filtereddata.filter(x => x.KURAL == "3");
           
                var values = $("#rulokodufilter").val();
                var renk = $("#renkkodufilter").val();
                var kal = $("#kalinlikfilter").val();
                var gen = $("#genislikfilter").val();
                var men = $("#menseifilter").val();

                if (values != "") {
                    fitered = fitered.filter(x => values.includes(x.RULOKODU));
                } else {
                    var valf = [];
                    for (let i = 0; i < fitered.length; i++) {
                        if (!valf.includes(fitered[i].RULOKODU)) {
                            valf.push(fitered[i].RULOKODU);
                        }
                    }
                    valf.sort();
                    document.getElementById("rulokodufilter").replaceChildren();
                    for (let i = 0; i < valf.length; i++) {

                        var option = document.createElement("option");
                        option.value = valf[i];
                        if (valf[i].length == 6) {
                            option.innerHTML = "0" + valf[i].substring(0, 4) + "." + valf[i].substring(valf[i].length - 2);
                        } else {
                            option.innerHTML = valf[i].substring(0, 5) + "." + valf[i].substring(valf[i].length - 2);
                        }
                        document.getElementById("rulokodufilter").appendChild(option);
                    }
                }

                if (renk != "") {

                    fitered = fitered.filter(x => renk.includes(x.RENKKODU));

                } else {
                    var renkf = [];
                    for (let i = 0; i < fitered.length; i++) {
                        if (!renkf.includes(fitered[i].RENKKODU)) {
                            renkf.push(fitered[i].RENKKODU);
                        }
                    }
                    renkf.sort();
                    document.getElementById("renkkodufilter").replaceChildren();
                    for (let i = 0; i < renkf.length; i++) {

                        var option = document.createElement("option");
                        option.value = renkf[i];
                        option.innerHTML = renkf[i];
                        document.getElementById("renkkodufilter").appendChild(option);
                    }
                }
                if (kal != "") {

                    fitered = fitered.filter(x => kal.includes(x.KALINLIK));
                } else {
                    var kalf = [];
                    for (let i = 0; i < fitered.length; i++) {
                        if (!kalf.includes(parseFloat(fitered[i].KALINLIK.replace(",", ".")))) {
                            kalf.push(parseFloat(fitered[i].KALINLIK.replace(",", ".")));
                        }
                    }
                    kalf.sort(function (a, b) { return a - b });
                    document.getElementById("kalinlikfilter").replaceChildren();
                    for (let i = 0; i < kalf.length; i++) {

                        var option = document.createElement("option");
                        option.value = kalf[i];
                        option.innerHTML = (parseFloat((kalf[i].toString()).replace(",", ".")).toFixed(2)).replace(".", ",");
                        document.getElementById("kalinlikfilter").appendChild(option);
                    }
                }
                if (gen != "") {

                    fitered = fitered.filter(x => gen.includes(x.GENISLIK));
                } else {
                    var genf = [];
                    for (let i = 0; i < fitered.length; i++) {
                        if (!genf.includes(parseFloat(fitered[i].GENISLIK.replace(",", ".")))) {
                            genf.push(parseFloat(fitered[i].GENISLIK.replace(",", ".")));
                        }
                    }
                    document.getElementById("genislikfilter").replaceChildren();
                    genf.sort(function (a, b) { return a - b });
                    for (let i = 0; i < genf.length; i++) {

                        var option = document.createElement("option");
                        option.value = genf[i];
                        option.innerHTML = genf[i].toString().replace(".", ",");
                        document.getElementById("genislikfilter").appendChild(option);
                    }
                }
                if (men != "") {

                    fitered = fitered.filter(x => men.includes(x.MENSEI));
                } else {
                    var menf = [];
                    for (let i = 0; i < fitered.length; i++) {
                        if (!menf.includes(fitered[i].MENSEI.trim())) {
                            menf.push(fitered[i].MENSEI.trim());
                        }
                    }
                    document.getElementById("menseifilter").replaceChildren();
                    menf.sort();
                    for (let i = 0; i < menf.length; i++) {

                        var option = document.createElement("option");
                        option.value = menf[i];
                        option.innerHTML = menf[i];
                        document.getElementById("menseifilter").appendChild(option);
                    }
                }
                
                for (let i = 0; i < fitered.length; i++) {

                    var tr = document.createElement("tr");
                    var td = document.createElement("td");
                    var lab = document.createElement("label");

                    var color = "";
                    if (fitered[i].KURAL == 1) {
                        color = "#EAFFF1";
                    } else if (fitered[i].KURAL == 0) {
                        color = "white";
                    }
                    else {
                        color = "#EAF1FF";
                    }
                    if (fitered[i].RESERVETARIH != "") {
                        color = "#F1EAFF";
                    }
                    tr.style = "background-color:" + color;
                    td.appendChild(lab);
                    td.className = "border-bottom-1 border-gray";
                    td.style = "background-color:" + color + ";position:sticky;left:0;text-align: center";

                    if (fitered[i].RULOKODU.length == 6) {
                        lab.innerHTML = "0" + fitered[i].RULOKODU.substring(0, 4) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                    } else {
                        lab.innerHTML = fitered[i].RULOKODU.substring(0, 5) + "." + fitered[i].RULOKODU.substring(fitered[i].RULOKODU.length - 2);
                    }

                    lab.style = "font-size:12px;font-weight:bold";
                    tr.appendChild(td);
                    //var td1 = document.createElement("td");
                    //var lab1 = document.createElement("label");

                    //lab1.style = "background-color: transparent;border: none; text-align: center";

                    //td1.appendChild(lab1);
                    //td1.className = "border-bottom-1 border-gray";
                    //td1.style = "height:50px;";
                    //lab1.innerHTML = data[i].BOBINNO;
                    //tr.appendChild(td1);
                    var td2 = document.createElement("td");
                    var lab2 = document.createElement("label");

                    lab2.style = "background-color: transparent;border: none; text-align: center";

                    td2.appendChild(lab2);
                    td2.className = "border-bottom-1 border-gray";
                    td2.style = "height:50px;text-align: center";
                    if (fitered[i].KONUM != "") {
                        lab2.innerHTML = fitered[i].KONUM;
                    } else {
                        lab2.innerHTML = "-";
                    }

                    tr.appendChild(td2);
                    var td3 = document.createElement("td");
                    var lab3 = document.createElement("label");

                    lab3.style = "background-color: transparent;border: none; text-align: center";

                    td3.appendChild(lab3);
                    td3.className = "border-bottom-1 border-gray";
                    td3.style = "height:50px;text-align: center";
                    if (fitered[i].RENKKODU != "") {
                        lab3.innerHTML = fitered[i].RENKKODU;
                    } else {
                        lab3.innerHTML = "-";
                    }

                    tr.appendChild(td3);
                    var td4 = document.createElement("td");
                    var lab4 = document.createElement("label");

                    lab4.style = "background-color: transparent;border: none ;text-align: center";

                    td4.appendChild(lab4);
                    td4.className = "border-bottom-1 border-gray";
                    td4.style = "height:50px;text-align: center";
                    if (fitered[i].KALINLIK != "") {
                        lab4.innerHTML = (parseFloat((fitered[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                    } else {
                        lab4.innerHTML = "-";
                    }

                    tr.appendChild(td4);
                    var td5 = document.createElement("td");
                    var lab5 = document.createElement("label");

                    lab5.style = "background-color: transparent;border: none; text-align: center";

                    td5.appendChild(lab5);
                    td5.className = "border-bottom-1 border-gray";
                    td5.style = "height:50px;text-align: center";
                    if (fitered[i].GENISLIK != "") {
                        lab5.innerHTML = fitered[i].GENISLIK;
                    } else {
                        lab5.innerHTML = "-";
                    }


                    tr.appendChild(td5);
                    var td6 = document.createElement("td");
                    var lab6 = document.createElement("label");

                    lab6.style = "background-color: transparent;border: none ;text-align: center";

                    td6.appendChild(lab6);
                    td6.className = "border-bottom-1 border-gray";
                    td6.style = "height:50px;text-align: center";
                    if (fitered[i].KALITE != "") {
                        lab6.innerHTML = fitered[i].KALITE;
                    } else {
                        lab6.innerHTML = "-";
                    }

                    tr.appendChild(td6);
                    var td7 = document.createElement("td");
                    var lab7 = document.createElement("label");

                    lab7.style = "background-color: transparent;border: none ;text-align: center";

                    td7.appendChild(lab7);
                    td7.className = "border-bottom-1 border-gray";
                    td7.style = "height:50px;text-align: center";
                    if (fitered[i].KAPLAMA != "") {
                        lab7.innerHTML = fitered[i].KAPLAMA;
                    } else {
                        lab7.innerHTML = "-";
                    }

                    tr.appendChild(td7);




                    var td8 = document.createElement("td");
                    var lab8 = document.createElement("label");

                    lab8.style = "background-color: transparent;border: none; text-align: center";

                    td8.appendChild(lab8);
                    td8.className = "border-bottom-1 border-gray";
                    td8.style = "height:50px;text-align: center ";
                    if (fitered[i].MENSEI != "") {
                        lab8.innerHTML = fitered[i].MENSEI;
                    } else {
                        lab8.innerHTML = "-";
                    }

                    tr.appendChild(td8);
                    var td9 = document.createElement("td");
                    var lab9 = document.createElement("label");

                    lab9.style = "background-color: transparent;border: none; text-align: center";

                    td9.appendChild(lab9);
                    td9.className = "border-bottom-1 border-gray";
                    td9.style = "height:50px;text-align: center ";
                    if (fitered[i].RESERVETARIH != "") {
                        lab9.innerHTML = fitered[i].RESERVETARIH.split(' ')[0];
                    } else {
                        lab9.innerHTML = "-";
                    }

                    tr.appendChild(td9);
                    var td10 = document.createElement("td");
                    var lab10 = document.createElement("label");

                    lab10.style = "background-color: transparent;border: none ;text-align: center";

                    td10.appendChild(lab10);
                    td10.className = "border-bottom-1 border-gray";
                    td10.style = "height:50px;text-align: center";
                    if (fitered[i].RESERVEACIKLAMA != "") {
                        lab10.innerHTML = fitered[i].RESERVEACIKLAMA;
                    } else {
                        lab10.innerHTML = "-";
                    }

                    tr.appendChild(td10);
                    var td11 = document.createElement("td");
                    var lab11 = document.createElement("label");

                    lab11.style = "background-color: transparent;border: none ;text-align: center";

                    td11.appendChild(lab11);
                    td11.className = "border-bottom-1 border-gray";
                    td11.style = "height:50px;text-align: center;";
                    lab11.innerHTML = (parseFloat(fitered[i].TONAJ)).toLocaleString('tr-TR');
                    tr.appendChild(td11);
                    var td12 = document.createElement("td");
                    var lab12 = document.createElement("label");

                    lab12.style = "background-color: transparent;border: none ;text-align: center";

                    td12.appendChild(lab12);
                    td12.className = "border-bottom-1 border-gray";
                    td12.style = "height:50px;text-align: center;";
                    lab12.innerHTML = fitered[i].ADET;

                    tr.appendChild(td12);
                    var td13 = document.createElement("td");
                    var lab13 = document.createElement("label");

                    lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td13.appendChild(lab13);
                    td13.className = "border-bottom-1 border-gray";
                    td13.style = "height:50px;text-align: center;font-weight:bold";
                    if (fitered[i].TUTAR != "") {
                        lab13.innerHTML = "$ " + parseFloat(fitered[i].TUTAR).toFixed(4);
                    } else {
                        lab13.innerHTML = fitered[i].TUTAR;
                    }

                    tr.appendChild(td13);
                    var td14 = document.createElement("td");
                    var lab14 = document.createElement("label");

                    lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td14.appendChild(lab14);
                    td14.className = "border-bottom-1 border-gray";
                    td14.style = "height:50px;text-align: center;display:none";
                    tr.appendChild(td14);
                    if (fitered[i].STOKSAHASI != "") {
                        lab14.innerHTML = fitered[i].STOKSAHASI;
                    } else {
                        lab14.innerHTML = "-";
                    }

                    var td15 = document.createElement("td");
                    var lab15 = document.createElement("label");

                    lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td15.appendChild(lab15);
                    td15.className = "border-bottom-1 border-gray";
                    td15.style = "height:50px;text-align: center;display:none";
                    if (fitered[i].RULOBANTGIRISTARIH != "") {
                        lab15.innerHTML = fitered[i].RULOBANTGIRISTARIH;
                    } else {
                        lab15.innerHTML = "-";
                    }

                    tr.appendChild(td15);
                    var td16 = document.createElement("td");
                    var lab16 = document.createElement("label");
                    lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td16.appendChild(lab16);
                    td16.className = "border-bottom-1 border-gray";
                    td16.style = "height:50px;text-align: center;display:none";
                    if (fitered[i].ISEMRITARIHI != "") {
                        lab16.innerHTML = fitered[i].ISEMRITARIHI;
                    } else {
                        lab16.innerHTML = "-";
                    }

                    tr.appendChild(td16);
                    //var td17 = document.createElement("td");
                    //var lab17 = document.createElement("label");
                    //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    //td17.appendChild(lab17);
                    //td17.className = "border-bottom-1 border-gray";
                    //td17.style = "height:50px";
                    //lab17.innerHTML = data[i].URETILMETARIHI;
                    //tr.appendChild(td17);
                    var td17 = document.createElement("td");
                    var lab17 = document.createElement("label");

                    lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td17.appendChild(lab17);
                    td17.className = "border-bottom-1 border-gray";
                    td17.style = "height:50px;text-align: center;display:none";
                    if (fitered[i].IRSALIYENO != "") {
                        lab17.innerHTML = fitered[i].IRSALIYENO;
                    } else {
                        lab17.innerHTML = "-";
                    }

                    tr.appendChild(td17);
                    var td18 = document.createElement("td");
                    var lab18 = document.createElement("label");

                    lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                    if (fitered[i].ISEMRINO != "") {
                        lab18.innerHTML = fitered[i].ISEMRINO;
                    } else {
                        lab18.innerHTML = "-";
                    }

                    td18.appendChild(lab18);
                    td18.className = "border-bottom-1 border-gray";
                    td18.style = "height:50px;text-align: center;display:none";
                    tr.appendChild(td18);
                    var td19 = document.createElement("td");
                    var lab19 = document.createElement("label");

                    lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td19.appendChild(lab19);
                    td19.className = "border-bottom-1 border-gray";
                    td19.style = "height:50px;text-align: center;display:none";
                    if (fitered[i].URETILECEKMALZEMEADI != "") {
                        lab19.innerHTML = fitered[i].URETILECEKMALZEMEADI;
                    } else {
                        lab19.innerHTML = "-";
                    }

                    tr.appendChild(td19);
                    //var td20 = document.createElement("td");
                    //var lab20 = document.createElement("label");

                    //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    //td20.appendChild(lab20);
                    //td20.className = "border-bottom-1 border-gray";
                    //td20.style = "height:50px";
                    //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                    //tr.appendChild(td20);
                    //var td21 = document.createElement("td");
                    //var lab21 = document.createElement("label");

                    //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    //td21.appendChild(lab21);
                    //td21.className = "border-bottom-1 border-gray";
                    //td21.style = "height:50px";
                    //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                    //tr.appendChild(td21);
                    //var td22 = document.createElement("td");
                    //var lab22 = document.createElement("label");

                    //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    //td22.appendChild(lab22);
                    //td22.className = "border-bottom-1 border-gray";
                    //td22.style = "height:50px";
                    //lab22.innerHTML = data[i].KURAL;
                    //tr.appendChild(td22);
                    var td23 = document.createElement("td");
                    var lab23 = document.createElement("label");

                    lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                    td23.appendChild(lab23);
                    td23.className = "border-bottom-1 border-gray";
                    td23.style = "height:50px;text-align: center;display:none";
                    if (fitered[i].ISEMRIKOD != "") {
                        lab23.innerHTML = fitered[i].ISEMRIKOD;
                    } else {
                        lab23.innerHTML = "-";
                    }

                    tr.appendChild(td23);
                    document.getElementById("tbody").appendChild(tr);
                    fiyatlar.push(parseFloat(fitered[i].TUTAR) * parseFloat(fitered[i].TONAJ));
                    fiyatlarton.push(parseFloat(fitered[i].TONAJ));
                }
                var sum = 0;
                var sumton = 0;
                for (let i = 0; i < fiyatlar.length; i++) {
                    sum = sum + fiyatlar[i];

                }
                for (let i = 0; i < fiyatlarton.length; i++) {
                    sumton = sumton + fiyatlarton[i];
                }

                document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (sum / sumton).toFixed(4);
                document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + sumton.toLocaleString('tr', 'TR');
                var table = document.getElementById("tbody");
                var tr = table.getElementsByTagName("tr");
                var th = document.getElementById("sorttable").getElementsByTagName("th");
                if (g == 1) {
                    for (let i = 0; i < tr.length; i++) {
                        var td = tr[i].getElementsByTagName("td");
                        for (let a = 12; a < th.length; a++) {

                            td[a].style.display = "table-cell";


                        }
                    }
                }
            } 
           
        
        function refresh() {
            k1 = false;
            k3 = false;
            w = false;
            var fiyatlar = [];
            var fiyatlarton = [];
            document.getElementById('rulokodufilter').replaceChildren();
            document.getElementById('renkkodufilter').replaceChildren();
            document.getElementById('kalinlikfilter').replaceChildren();
            document.getElementById('genislikfilter').replaceChildren();
            document.getElementById('menseifilter').replaceChildren();
            document.getElementById('tbody').replaceChildren();
            
            var renkfilter = [];
            var kalinlikfilter = [];
            var genislikfilter = [];
            var menseifilter = [];
            var data = upt;
           
            for (let i = 0; i < data.length; i++) {

                var tr = document.createElement("tr");
                var td = document.createElement("td");
                var lab = document.createElement("label");
                if (!renkfilter.includes(data[i].RENKKODU)) {
                    renkfilter.push(data[i].RENKKODU);
                }
                if (!kalinlikfilter.includes(parseFloat(data[i].KALINLIK.replace(",", ".")))) {
                    kalinlikfilter.push(parseFloat(data[i].KALINLIK.replace(",", ".")));
                }
                if (!genislikfilter.includes(parseFloat(data[i].GENISLIK.replace(',', '.')))) {
                    genislikfilter.push(parseFloat(data[i].GENISLIK.replace(',', '.')));
                }
                if (!menseifilter.includes(data[i].MENSEI)) {
                    menseifilter.push(data[i].MENSEI);
                }
                var color = "";
                if (data[i].KURAL == 1) {
                    color = "#EAFFF1";
                } else if (data[i].KURAL == 0) {
                    color = "white";
                }
                else {
                    color = "#EAF1FF";
                }
                if (data[i].RESERVETARIH != "") {
                    color = "#F1EAFF";
                }
                tr.style = "background-color:" + color;
                td.appendChild(lab);
                td.className = "border-bottom-1 border-gray";
                td.style = "background-color:" + color + ";position:sticky;left:0;text-align: center";

                if (data[i].RULOKODU.length == 6) {
                    lab.innerHTML = "0" + data[i].RULOKODU.substring(0, 4) + "." + data[i].RULOKODU.substring(data[i].RULOKODU.length - 2);
                } else {
                    lab.innerHTML = data[i].RULOKODU.substring(0, 5) + "." + data[i].RULOKODU.substring(data[i].RULOKODU.length - 2);
                }

                lab.style = "font-size:12px;font-weight:bold";
                tr.appendChild(td);
                //var td1 = document.createElement("td");
                //var lab1 = document.createElement("label");

                //lab1.style = "background-color: transparent;border: none; text-align: center";

                //td1.appendChild(lab1);
                //td1.className = "border-bottom-1 border-gray";
                //td1.style = "height:50px;";
                //lab1.innerHTML = data[i].BOBINNO;
                //tr.appendChild(td1);
                var td2 = document.createElement("td");
                var lab2 = document.createElement("label");

                lab2.style = "background-color: transparent;border: none; text-align: center";

                td2.appendChild(lab2);
                td2.className = "border-bottom-1 border-gray";
                td2.style = "height:50px;text-align: center";
                if (data[i].KONUM != "") {
                    lab2.innerHTML = data[i].KONUM;
                } else {
                    lab2.innerHTML = "-";
                }

                tr.appendChild(td2);
                var td3 = document.createElement("td");
                var lab3 = document.createElement("label");

                lab3.style = "background-color: transparent;border: none; text-align: center";

                td3.appendChild(lab3);
                td3.className = "border-bottom-1 border-gray";
                td3.style = "height:50px;text-align: center";
                if (data[i].RENKKODU != "") {
                    lab3.innerHTML = data[i].RENKKODU;
                } else {
                    lab3.innerHTML = "-";
                }

                tr.appendChild(td3);
                var td4 = document.createElement("td");
                var lab4 = document.createElement("label");

                lab4.style = "background-color: transparent;border: none ;text-align: center";

                td4.appendChild(lab4);
                td4.className = "border-bottom-1 border-gray";
                td4.style = "height:50px;text-align: center";
                if (data[i].KALINLIK != "") {
                    lab4.innerHTML = (parseFloat((data[i].KALINLIK).replace(",", ".")).toFixed(2)).replace(".", ",");
                } else {
                    lab4.innerHTML = "-";
                }

                tr.appendChild(td4);
                var td5 = document.createElement("td");
                var lab5 = document.createElement("label");

                lab5.style = "background-color: transparent;border: none; text-align: center";

                td5.appendChild(lab5);
                td5.className = "border-bottom-1 border-gray";
                td5.style = "height:50px;text-align: center";
                if (data[i].GENISLIK != "") {
                    lab5.innerHTML = data[i].GENISLIK;
                } else {
                    lab5.innerHTML = "-";
                }


                tr.appendChild(td5);
                var td6 = document.createElement("td");
                var lab6 = document.createElement("label");

                lab6.style = "background-color: transparent;border: none ;text-align: center";

                td6.appendChild(lab6);
                td6.className = "border-bottom-1 border-gray";
                td6.style = "height:50px;text-align: center";
                if (data[i].KALITE != "") {
                    lab6.innerHTML = data[i].KALITE;
                } else {
                    lab6.innerHTML = "-";
                }

                tr.appendChild(td6);
                var td7 = document.createElement("td");
                var lab7 = document.createElement("label");

                lab7.style = "background-color: transparent;border: none ;text-align: center";

                td7.appendChild(lab7);
                td7.className = "border-bottom-1 border-gray";
                td7.style = "height:50px;text-align: center";
                if (data[i].KAPLAMA != "") {
                    lab7.innerHTML = data[i].KAPLAMA;
                } else {
                    lab7.innerHTML = "-";
                }

                tr.appendChild(td7);




                var td8 = document.createElement("td");
                var lab8 = document.createElement("label");

                lab8.style = "background-color: transparent;border: none; text-align: center";

                td8.appendChild(lab8);
                td8.className = "border-bottom-1 border-gray";
                td8.style = "height:50px;text-align: center ";
                if (data[i].MENSEI != "") {
                    lab8.innerHTML = data[i].MENSEI;
                } else {
                    lab8.innerHTML = "-";
                }

                tr.appendChild(td8);
                var td9 = document.createElement("td");
                var lab9 = document.createElement("label");

                lab9.style = "background-color: transparent;border: none; text-align: center";

                td9.appendChild(lab9);
                td9.className = "border-bottom-1 border-gray";
                td9.style = "height:50px;text-align: center ";
                if (data[i].RESERVETARIH != "") {
                    lab9.innerHTML = data[i].RESERVETARIH.split(' ')[0];
                } else {
                    lab9.innerHTML = "-";
                }

                tr.appendChild(td9);
                var td10 = document.createElement("td");
                var lab10 = document.createElement("label");

                lab10.style = "background-color: transparent;border: none ;text-align: center";

                td10.appendChild(lab10);
                td10.className = "border-bottom-1 border-gray";
                td10.style = "height:50px;text-align: center";
                if (data[i].RESERVEACIKLAMA != "") {
                    lab10.innerHTML = data[i].RESERVEACIKLAMA;
                } else {
                    lab10.innerHTML = "-";
                }

                tr.appendChild(td10);
                var td11 = document.createElement("td");
                var lab11 = document.createElement("label");

                lab11.style = "background-color: transparent;border: none ;text-align: center";

                td11.appendChild(lab11);
                td11.className = "border-bottom-1 border-gray";
                td11.style = "height:50px;text-align: center;";
                lab11.innerHTML = (parseFloat(data[i].TONAJ)).toLocaleString('tr-TR');
                tr.appendChild(td11);
                var td12 = document.createElement("td");
                var lab12 = document.createElement("label");

                lab12.style = "background-color: transparent;border: none ;text-align: center";

                td12.appendChild(lab12);
                td12.className = "border-bottom-1 border-gray";
                td12.style = "height:50px;text-align: center;";
                lab12.innerHTML = data[i].ADET;

                tr.appendChild(td12);
                var td13 = document.createElement("td");
                var lab13 = document.createElement("label");

                lab13.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td13.appendChild(lab13);
                td13.className = "border-bottom-1 border-gray";
                td13.style = "height:50px;text-align: center;font-weight:bold";
                if (data[i].TUTAR != "") {
                    lab13.innerHTML = "$ " + parseFloat(data[i].TUTAR).toFixed(4);
                } else {
                    lab13.innerHTML = data[i].TUTAR;
                }

                tr.appendChild(td13);
                var td14 = document.createElement("td");
                var lab14 = document.createElement("label");

                lab14.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td14.appendChild(lab14);
                td14.className = "border-bottom-1 border-gray";
                td14.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td14);
                if (data[i].STOKSAHASI != "") {
                    lab14.innerHTML = data[i].STOKSAHASI;
                } else {
                    lab14.innerHTML = "-";
                }

                var td15 = document.createElement("td");
                var lab15 = document.createElement("label");

                lab15.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td15.appendChild(lab15);
                td15.className = "border-bottom-1 border-gray";
                td15.style = "height:50px;text-align: center;display:none";
                if (data[i].RULOBANTGIRISTARIH != "") {
                    lab15.innerHTML = data[i].RULOBANTGIRISTARIH;
                } else {
                    lab15.innerHTML = "-";
                }

                tr.appendChild(td15);
                var td16 = document.createElement("td");
                var lab16 = document.createElement("label");
                lab16.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td16.appendChild(lab16);
                td16.className = "border-bottom-1 border-gray";
                td16.style = "height:50px;text-align: center;display:none";
                if (data[i].ISEMRITARIHI != "") {
                    lab16.innerHTML = data[i].ISEMRITARIHI;
                } else {
                    lab16.innerHTML = "-";
                }

                tr.appendChild(td16);
                //var td17 = document.createElement("td");
                //var lab17 = document.createElement("label");
                //lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td17.appendChild(lab17);
                //td17.className = "border-bottom-1 border-gray";
                //td17.style = "height:50px";
                //lab17.innerHTML = data[i].URETILMETARIHI;
                //tr.appendChild(td17);
                var td17 = document.createElement("td");
                var lab17 = document.createElement("label");

                lab17.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td17.appendChild(lab17);
                td17.className = "border-bottom-1 border-gray";
                td17.style = "height:50px;text-align: center;display:none";
                if (data[i].IRSALIYENO != "") {
                    lab17.innerHTML = data[i].IRSALIYENO;
                } else {
                    lab17.innerHTML = "-";
                }

                tr.appendChild(td17);
                var td18 = document.createElement("td");
                var lab18 = document.createElement("label");

                lab18.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";
                if (data[i].ISEMRINO != "") {
                    lab18.innerHTML = data[i].ISEMRINO;
                } else {
                    lab18.innerHTML = "-";
                }

                td18.appendChild(lab18);
                td18.className = "border-bottom-1 border-gray";
                td18.style = "height:50px;text-align: center;display:none";
                tr.appendChild(td18);
                var td19 = document.createElement("td");
                var lab19 = document.createElement("label");

                lab19.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td19.appendChild(lab19);
                td19.className = "border-bottom-1 border-gray";
                td19.style = "height:50px;text-align: center;display:none";
                if (data[i].URETILECEKMALZEMEADI != "") {
                    lab19.innerHTML = data[i].URETILECEKMALZEMEADI;
                } else {
                    lab19.innerHTML = "-";
                }

                tr.appendChild(td19);
                //var td20 = document.createElement("td");
                //var lab20 = document.createElement("label");

                //lab20.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td20.appendChild(lab20);
                //td20.className = "border-bottom-1 border-gray";
                //td20.style = "height:50px";
                //lab20.innerHTML = data[i].MALZEMEKALINLIK;
                //tr.appendChild(td20);
                //var td21 = document.createElement("td");
                //var lab21 = document.createElement("label");

                //lab21.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td21.appendChild(lab21);
                //td21.className = "border-bottom-1 border-gray";
                //td21.style = "height:50px";
                //lab21.innerHTML = data[i].MALZEMEBOYUZUNLUK;
                //tr.appendChild(td21);
                //var td22 = document.createElement("td");
                //var lab22 = document.createElement("label");

                //lab22.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                //td22.appendChild(lab22);
                //td22.className = "border-bottom-1 border-gray";
                //td22.style = "height:50px";
                //lab22.innerHTML = data[i].KURAL;
                //tr.appendChild(td22);
                var td23 = document.createElement("td");
                var lab23 = document.createElement("label");

                lab23.style = "background-color: transparent;border: none;white-space: nowrap ;text-align: center;";

                td23.appendChild(lab23);
                td23.className = "border-bottom-1 border-gray";
                td23.style = "height:50px;text-align: center;display:none";
                if (data[i].ISEMRIKOD != "") {
                    lab23.innerHTML = data[i].ISEMRIKOD;
                } else {
                    lab23.innerHTML = "-";
                }

                tr.appendChild(td23);
                document.getElementById("tbody").appendChild(tr);
            }
            for (let i = 0; i < data.length; i++) {
                var r = ""
                if (data[i].RULOKODU.length == 6) {
                    r = "0" + data[i].RULOKODU.substring(0, 4) + "." + data[i].RULOKODU.substring(data[i].RULOKODU.length - 2);
                } else {
                    r = data[i].RULOKODU.substring(0, 5) + "." + data[i].RULOKODU.substring(data[i].RULOKODU.length - 2);
                }
                var option = document.createElement("option");
                option.innerHTML = r;
                option.value = data[i].RULOKODU;
                document.getElementById("rulokodufilter").appendChild(option);





            }
            for (let i = 0; i < renkfilter.length; i++) {
                var option1 = document.createElement("option");
                option1.innerHTML = renkfilter[i];
                option1.value = renkfilter[i];

                document.getElementById("renkkodufilter").appendChild(option1);
            }
            kalinlikfilter.sort(function (a, b) { return a - b });
            for (let i = 0; i < kalinlikfilter.length; i++) {
                var option2 = document.createElement("option");
                option2.innerHTML = (parseFloat((kalinlikfilter[i].toString()).replace(",", ".")).toFixed(2)).replace(".", ",");
                option2.value = (kalinlikfilter[i]).toString().replace('.', ',');
                document.getElementById("kalinlikfilter").appendChild(option2);
            }
            genislikfilter.sort(function (a, b) { return a - b });
            for (let i = 0; i < genislikfilter.length; i++) {
                var option3 = document.createElement("option");
                option3.innerHTML = (genislikfilter[i]).toString().replace('.', ',');
                option3.value = (genislikfilter[i]).toString().replace('.', ',');
                document.getElementById("genislikfilter").appendChild(option3);
            }
            menseifilter.sort();
            for (let i = 0; i < menseifilter.length; i++) {
                var option1 = document.createElement("option");
                option1.innerHTML = menseifilter[i];
                option1.value = menseifilter[i];

                document.getElementById("menseifilter").appendChild(option1);
            }
            
          
            var fiyatlar = [];
            var fiyatlarton = [];
            var rows = document.getElementById("tbody").getElementsByTagName("tr");


            for (let i = 1; i < rows.length; i++) {
                fiyatlar.push(parseFloat((rows[i].getElementsByTagName("label")[12].innerHTML).split(' ')[1]) * parseFloat((rows[i].getElementsByTagName("label")[10].innerHTML.replace('.', ''))));
                fiyatlarton.push(parseFloat((rows[i].getElementsByTagName("label")[10].innerHTML.replace('.', ''))));

            }

            document.getElementById("ortfiyat").innerHTML = "<b>Ağ. Ort. Fiyat:</b> $ " + (fiyatlar.reduce((partialSum, a) => partialSum + a, 0) / (fiyatlarton.reduce((partialSum, a) => partialSum + a, 0))).toFixed(4);
            document.getElementById("topton").innerHTML = "<b>∑ Seçilen Stok Miktarı:</b> " + (fiyatlarton.reduce((partialSum, a) => partialSum + a, 0)).toLocaleString('tr-TR');
            
            var table = document.getElementById("tbody");
            var tr = table.getElementsByTagName("tr");
            var table = document.getElementById("tbody");
            var tr = table.getElementsByTagName("tr");
            var th = document.getElementById("sorttable").getElementsByTagName("th");
            if (g == 1) {
                for (let i = 0; i < tr.length; i++) {
                    var td = tr[i].getElementsByTagName("td");
                    for (let a = 12; a < th.length; a++) {

                        td[a].style.display = "table-cell";


                    }
                }
            }
            filtereddata = fitered;

        }
    </script>
    <script>
        function myFunction() {
            var input, filter, table, tr, label, i, txtValue;
            input = document.getElementById("search");
            filter = input.value.toUpperCase();
            table = document.getElementById("sorttable");
            tr = table.getElementsByTagName("tr");
            for (i = 1; i < tr.length; i++) {
               
                label = tr[i].getElementsByTagName("label")[0];
                txtValue = label.textContent || label.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
        
    </script>
</body>
</html>

