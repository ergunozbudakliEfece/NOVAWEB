


<!DOCTYPE html>

<html>
<head>

    <meta charset="utf-8" />
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9">
    <meta name="viewport" content="user-scalable=no, width=device-width" />
    <title>Nova | Efece Galvaniz/Hammadde Listesi</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/img/icons/brands/Nova_White.png" />
    <link href="\assets\boxicons-2.1.2\css\boxicons.css" rel="stylesheet" type="text/css" />
    <link href="\assets\boxicons-2.1.2\css\animations.css" rel="stylesheet" type="text/css" />
    <link href="\assets\boxicons-2.1.2\css\transformations.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="\assets\vendor\css\core.css" class="template-customizer-core-css" />
    <link rel="stylesheet" type="text/css" href="\assets\vendor\css\theme-default.css" class="template-customizer-theme-css" />
    <link rel="stylesheet" type="text/css" href="\assets\css\demo.css" />

    <link rel="stylesheet" type="text/css" href="\assets\vendor\libs\perfect-scrollbar\perfect-scrollbar.css" />

    <link rel="stylesheet" type="text/css" href="\assets\vendor\libs/apex-charts/apex-charts.css" />
    <script type="text/javascript" src="\assets\vendor\js\helpers.js"></script>

    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script type="text/javascript" src="\assets\js\config.js"></script>
    <script src="/Scripts/jquery.validate.js" type='text/javascript'></script>
    <script src="/Scripts/jquery.validate.unobtrusive.js" type='text/javascript'></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
          rel="stylesheet" type="text/css" />
    <meta name="viewport" content="user-scalable=no, width=device-width" />

    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />


    <link href="~/assets/vendor/css/cssprogress.min.css" rel="stylesheet" />

    <link href="~/assets/vendor/css/accordion.css" rel="stylesheet" />
    <link href="~/assets/vendor/css/Chart.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <style>
        #sil:hover{opacity:0.7}
        .centercontent {
            position: absolute;
            max-width: 100%;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 5;
        }
        .table input {
            text-align: center;
        }

        th[name="bstable-actions"] {
            background-color: white;
            border-top: hidden;
            border-right: hidden;
        }

        .table.user-select-none {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        #ilkziyaret:hover {
            color: cornflowerblue;
        }
        .select2-container{
            float:right;
        }
        .centercontent {
            position: absolute;
            max-width: 100%;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 5;
        }


        .btn-grad {
            background-image: linear-gradient(to right, #616161 0%, #9bc5c3 51%, #616161 100%);
            margin: 10px;
            padding: 5px 15px;
            text-align: center;
            text-transform: uppercase;
            transition: 0.5s;
            background-size: 200% auto;
            color: white;
            box-shadow: 0 0 20px #eee;
            border-radius: 10px;
            display: block;
            border-style: none;
        }

            .btn-grad:hover {
                background-position: right center; /* change the direction of the change here */
                color: #fff;
                text-decoration: none;
            }

        .btn1:hover {
            background-position: right center; /* change the direction of the change here */
            color: #009ffb;
            text-decoration: none;
        }

        .btn1 {
            display: inline-block;
            font-weight: 400;
            line-height: 1.53;
            color: #697a8d;
            text-align: center;
            vertical-align: middle;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
            background-color: transparent;
            border: 1px solid transparent;
            padding: 0.4375rem 1.25rem;
            padding-top: 0.4375rem;
            padding-right: 1.25rem;
            padding-bottom: 0.4375rem;
            padding-left: 1.25rem;
            font-size: 0.9375rem;
            border-radius: 0.375rem;
            transition: all 0.2s ease-in-out;
        }
    </style>
    <style>
        .swal2-container {
            z-index: 20000 !important;
        }

        table {
            border: 1px solid #ccc;
            border-collapse: collapse;
            margin: 0;
            padding: 0;
            width: 100%;
            table-layout: fixed;
        }

            table caption {
                font-size: 1.5em;
                margin: .5em 0 .75em;
            }

            table tr {
                background-color: #f8f8f8;
                border: 1px solid #ddd;
                padding: .35em;
            }

            table th,
            table td {
                padding: .625em;
                text-align: center;
            }

            table th {
                font-size: .85em;
                letter-spacing: .1em;
                text-transform: uppercase;
            }

        .menu1 {
            display: none;
        }

        .label {
            display: none;
        }

        .foot {
            display: none;
        }

        @@media screen and (max-width: 600px) {
            .foot {
                display: block;
            }

            .footer {
                display: none;
            }

            .btn-group {
                display: none;
            }

            table {
                border: 0;
            }

            .menu1 {
                display: inline-flex;
            }

            .label {
                display: block;
            }

            table caption {
                font-size: 1.3em;
            }

            table thead {
                border: none;
                clip: rect(0 0 0 0);
                height: 1px;
                margin: -1px;
                overflow: hidden;
                padding: 0;
                position: absolute;
                width: 1px;
                display: none;
            }

            table tr {
                border-bottom: 3px solid #ddd;
                display: block;
                margin-bottom: .625em;
            }

            table td {
                border-bottom: 1px solid #ddd;
                display: block;
                font-size: .8em;
                text-align: right;
            }

                table td::before {
                    /*
        * aria-label has no advantage, it won't be read inside a table
        content: attr(aria-label);
        */
                    content: attr(data-label);
                    float: left;
                    font-weight: bold;
                    text-transform: uppercase;
                }

                table td:last-child {
                    border-bottom: 0;
                }
        }
    </style>
    <script data-require="jquery@2.0.3" data-semver="2.0.3" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>

    <script src="~/assets/vendor/css/scripts.js"></script>
    <script>


        var activeusers = null;

        var cities = null;

       
        
        var constant = 0;
        var constant1 = 0;

        var mahalleler = null;
        var urungruplari = null;
        $.getJSON('http://192.168.2.13:83/api/musteri/urungruplari', function (data) {

            urungruplari = data;
        })


        var musteriler = null;
        var filt = null;
        var c = "";

            var urunler =@Html.Raw(Json.Encode(ViewBag.Urunler));
    </script>
</head>
<body style="background-color:white">
    
    <div class="container-fluid mt-2">
        
        
        <form id="myForm" method="post" autocomplete="off">



            <div class="btn-group menu1 mt-1 mb-1 h-25">
                <button type="button" class="btn btn-primary btn-icon rounded-pill dropdown-toggle hide-arrow" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bx bx-dots-vertical-rounded"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" style="">
                    <li><a class="dropdown-item" onclick="change(1)">Yeni Müşteri</a></li>
                    <li>
                        <hr class="dropdown-divider">
                    </li>
                    <li><a class="dropdown-item" onclick="change(2)">Kayıtlı Müşteri</a></li>


                </ul>
            </div>
            <div class="btn-group menu2 mb-2" role="group" aria-label="Basic radio toggle button group">
                <input type="radio" class="btn-check" onclick="change(1)" name="btnradio" id="btnradio1" checked="" autocomplete="off">
                <label class="btn btn-outline-primary" for="btnradio1">Yeni Müşteri</label>
                <input type="radio" class="btn-check" onclick="change(2)" name="btnradio" id="btnradio2" autocomplete="off">
                <label class="btn btn-outline-primary" for="btnradio2">Kayıtlı Müşteri</label>
            </div>
           


            @{
if (ViewBag.OzelYetki)
            {

                        <div class="row mb-2" id="degistir" style="display: none;">
                                        <div class="col-sm-6">
                                                        <div class="form-check form-switch mb-2" style="padding-left:0 !important">

                                                            <label style="float:left !important" class="form-check-label" for="flexSwitchCheckChecked"><img data-bs-toggle="tooltip" data-popup="tooltip-custom" data-bs-placement="top" data-bs-html="true" data-bs-original-title="<span>Müşterinin Plasiyerini Değiştir</span>" style="cursor: pointer;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAASRJREFUSEu1leFVAkEMhL+rQDpQKxA7sAQ7QCsAKsAStAK1A0ugA7UD7UAqwDe8XV7eshc3i9wfflxuZjKThIETP8OJ8fEIboEVMA2K+AKWwJu+8whUeB4Ez+UfwPVfBNsR8O+k7ge4c0TsxHsd1AgEflEQj3XaRfAELAqCh5RV2XAXwWuyxYI9AvOKnQcE2ZJsW80i+X4J6FfPBHiv2La332bQQpCFvgDyXiGXmeSarg4iU9tFoJClXnOuR0uo0GfHZrABbgxwiSeiNXBmXoQ6uE/KPYuUx3MvQetRtJMX6iASbvMUHXPsPvMV9vZA51pn4CooX/dKk3VwrstFC+LWy70O/p1A98XOcSuBO2H2pRZJWxr9F2smaFUcqmtdoBCoLf4FuuU7GTcbBFoAAAAASUVORK5CYII=" /></label>
                                                            <input class="form-check-input ms-2" type="checkbox" id="flexSwitchCheckChecked" onchange="plasiyerdegistir()" unchecked="">
                                                        </div>
                                            
                                        </div>

                            @*<div class="col-sm" id="plasiyerdeg" style="display:none">
                                <select class="form-control" id="plasiyer1" onchange="plasiyerdegistir(this.value)" name="PLASIYERD" style="width: 100%">
                                </select>
                            </div>*@
                        </div>
            }
            }
            
                <div class="row">
                    <div class="col-sm">
                        <div class="row">
                            <div class="col-sm d-flex mb-2">


                                <input class="form-control" type="text" value="" placeholder="Müşteri İsmi" id="ISIM" name="MUSTERI_ADI">
                                <select id="musteriselect" onchange="musterichange(this.value)" style="display:none;width:100%" name="MUSTERI_ID">
                                </select>
                                <img id="sil" onclick="deletemusteri()" style="cursor:pointer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAKlJREFUSEvtlcERQDAQRZ9KlIBOlEIFlKQUOqASJjM4hJ0fIje5ZTbZ9//uJJuReGWJ86MANdABpSFkBlpgsIQqgEuQC5cjUL0FrPtFS4iKyxKpBCp+ARwXYnt/OvatJwccyqV1z6J5/nXzvgb4CtX+5Ic6UAmjS/QDLu/qaUn+HsivKbpEivAYEDJofOh0N/msl+xGZQ8USvoeX4DmbnSqkRmY3z6WHLABUDk4GfuOp84AAAAASUVORK5CYII=" />


                            </div>
                            <div class="col-sm mb-2">

                                <select class="form-control" id="plasiyer" onchange="plasiyerchange(this.value)" name="PLASIYER" style="width: 100%">
                                </select>
                            </div>
                        </div>
                        <div class="row ">
                            <div class="col-sm mb-2">


                                <select class="form-select" id="ilselect" name="MUSTERI_IL" onchange="citychange(this.value)" style="width: 100%">
                                </select>

                            </div>
                        </div>
                        <div class="row ">
                            <div class="col-sm mb-2">


                                <select class="form-select" id="ilceselect" name="MUSTERI_ILCE" onchange="ilcechange(this.value)" style="width: 100%">
                                </select>

                            </div>
                        </div>
                        <div class="row ">
                            <div class="col-sm mb-2">


                                <select class="form-select" id="mahalleselect" name="MUSTERI_MAHALLE" style="width: 100%">
                                </select>

                            </div>
                        </div>
                        <div class="row ">
                            <div class="col-sm mb-2">


                                <textarea class="form-control" id="adres" name="MUSTERI_ADRES" rows="2" placeholder="Açık Adres"></textarea>

                            </div>
                            <div class="col-sm mb-2">


                                <input class="form-control" type="text" value="" placeholder="Firma Yetkilisi" id="yetkili" name="FIRMA_YETKILISI">

                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6 mb-2">


                                <input class="form-control" type="text" value="" placeholder="Tel 1" id="tel1" name="MUSTERI_TEL1">

                            </div>
                            <div class="col-sm-6 mb-2">


                                <input class="form-control" type="text" value="" placeholder="Tel 2" id="tel2" name="MUSTERI_TEL2">

                            </div>

                        </div>
                        <div class="row">
                            <div class="col-sm d-flex mb-2">


                                <input class="form-control" type="email" value="" placeholder="example@example.com" id="mail" name="MUSTERI_MAIL">

                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm d-flex mb-2">
                                <select class="form-select" onchange="sektorchange(this.value)" id="sektor" name="MUSTERI_SEKTOR" style="width: 100%">

                                    <option value="Metal">
                                        Metal
                                    </option>
                                    <option value="Mobilya">
                                        Mobilya
                                    </option>
                                    <option value="Ticaret">Ticaret</option>
                                    <option value="Tarım">
                                        Tarım
                                    </option>
                                    <option value="Çit">
                                        Çit
                                    </option>
                                    <option value="Pvc Doğrama">
                                        Pvc Doğrama
                                    </option>
                                    <option value="Enerji">
                                        Enerji
                                    </option>
                                    <option value="Otomotiv">Otomotiv</option>
                                    <option value="Beyaz Eşya">
                                        Beyaz Eşya
                                    </option>
                                    <option value="Prefabrik">
                                        Prefabrik
                                    </option>
                                    <option value="Orman Ürünleri">
                                        Orman Ürünleri
                                    </option>
                                    <option value="İnşaat">
                                        İnşaat
                                    </option>
                                    <option value="Makine Endüstrisi">
                                        Makine Endüstrisi
                                    </option>
                                    <option value="Turizm">
                                        Turizm
                                    </option>
                                    <option value="Ulaştırma">Ulaştırma</option>
                                    <option value="Diger">
                                        Diğer
                                    </option>

                                </select>

                            </div>
                            <div class="col-sm d-flex mb-2">


                                <input class="form-control" style="display:none" type="text" name="MUSTERI_SEKTOR_DIGER" id="diger" value="" placeholder="Sektör Girin" />

                            </div>

                        </div>
                        <div class="row">
                            <div class="col-sm mb-2">


                                <select class="form-select" id="nitelik" name="MUSTERI_NITELIK" style="width: 100%">

                                    <optgroup label="Nitelik">
                                        <option value="Üretici">
                                            Üretici
                                        </option>
                                        <option value="Toptancı">
                                            Toptancı
                                        </option>
                                        <option value="Perakendeci">
                                            Perakendeci
                                        </option>
                                        <option value="Uygulayıcı">
                                            Uygulayıcı
                                        </option>
                                        <option value="Tüketici">
                                            Tüketici
                                        </option>
                                    </optgroup>

                                </select>

                            </div>

                        </div>
                        <div class="row mb-2">
                            <div class="col-sm">


                                <textarea class="form-control" id="not" name="MUSTERI_NOTU" placeholder="Not" rows="2" cols="50"></textarea>

                            </div>

                        </div>
                    </div>
                </div>




                <div class="row">
                    <div class="col">
                        <button class="btn btn-info me-3" id="save" type="submit" style="background-image: linear-gradient(to right, #E0EAFC 0%, #CFDEF3 51%, #E0EAFC 100%);color:black;font-size:11px">KAYDET</button>

                    </div>

                </div>
                <div class="row">
                    <div class="col">
                        <button class="btn btn-info" type="button" id="update" onclick="updatemusteri()" style="background-image: linear-gradient(to right, #E0EAFC 0%, #CFDEF3 51%, #E0EAFC 100%);color:black;font-size:11px">GÜNCELLE</button>



                        <button type="button" class="btn btn-info " id="urunekle" onclick="openModal(1)" style="background-image: linear-gradient(to right, #E0EAFC 0%, #CFDEF3 51%, #E0EAFC 100%);color:black;font-size:11px">
                            ÜRÜN EKLE
                        </button>


                        <button type="button" id="ziyaretplani" class="btn btn-info" onclick="openModal(2)" style="background-image: linear-gradient(to right, #E0EAFC 0%, #CFDEF3 51%, #E0EAFC 100%);color:black;font-size:11px">
                            ZİYARET PLANLARIM
                        </button>

                    </div>
                </div>

                <script>
                    function openModal(value) {
                        if (value == 1) {
                            var m = document.getElementById("musteriselect");
                            if (m.value != "") {
                                $('#basicModal').modal({ backdrop: 'static', keyboard: false })
                                $('#basicModal').modal('show');
                                $('#closebtn').modal('hide');
                            } else {
                                const Toast = Swal.mixin({
                                    toast: true,
                                    position: 'center',
                                    showConfirmButton: false,
                                    timer: 3000,
                                    timerProgressBar: true,
                                    didOpen: (toast) => {
                                        toast.addEventListener('mouseenter', Swal.stopTimer)
                                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                                    }
                                })

                                Toast.fire({
                                    icon: 'error',
                                    title: 'Müşteri seçilmedi!'
                                });
                            }
                        } else {
                            var m = document.getElementById("musteriselect");
                            if (m.value != "") {
                                $('#datepickermodal').modal({ backdrop: 'static', keyboard: false });
                                $('#datepickermodal').modal('show');
                            } else {
                                const Toast = Swal.mixin({
                                    toast: true,
                                    position: 'center',
                                    showConfirmButton: false,
                                    timer: 3000,
                                    timerProgressBar: true,
                                    didOpen: (toast) => {
                                        toast.addEventListener('mouseenter', Swal.stopTimer)
                                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                                    }
                                })

                                Toast.fire({
                                    icon: 'error',
                                    title: 'Müşteri seçilmedi!'
                                });
                            }
                        }
                    }
                </script>





</form>
        <div class="modal fade" id="basicModal" tabindex="-1" aria-hidden="true" style="display: none;">

            <div class="modal-dialog  modal-fullscreen" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel1">Ürün Ekleme</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        <div class="row mb-2">
                            <div class="col-sm">

                            </div>
                        </div>
                    </div>
                    <div id="mb" class="modal-body">
                        <div class="row">
                            <div class="col">



                                <table class="table table-striped table-bordered" id="example">
                                    <thead class="thead-dark" id="thead">
                                        <tr>
                                            <th scope="col" width="40%">Ürün Grubu</th>
                                            <th scope="col">Yıllık Kullanım</th>
                                            <th scope="col">Ölçü Birimi</th>
                                            <th scope="col">Onay</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bdy">
                                    </tbody>
                                </table>

                                <button class="float-end" id="new-row-button" onclick="addRw1()" style="cursor: pointer; background-color: transparent; background-repeat: no-repeat; border: none;"><img style="width:20px" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAmlJREFUWEftmOFxFDEMhd9VQKiApAJIBUkHQAVABZAKQiogVABUAHRAKiCpINABVEDmu7FuhM5ey3s3zE4G/dm5W9l6lp7l511pYbZaGB7dG0BPJL2QxPOgPEn2taRf5fmpPIeKMJqht5JeFxCZQIC7lHSRccYnC+iZpHeSDrMTB78fks4kfemNzwAiK+dhop9l8m+SCEapMEoI6FNJLOJRGMdck9nqAfpYuGLzAoRJ+T9jL4u/B8bYV63BU4BiZr5KIgC8GDFID4inbhBZYv4tawEi3Z+dNzsGMLtYzPbzGqdagOCFpZnMALBl8OWkvLySBK9aBqktU8Q4io41QL5UcAaiTpXJ+zdLUQJTPoA8KL+3/GuACG4DIF+PwCOAwEHpPxRAxHrosxQBkY3vxYHsZPrOKCCm95Q49h09AqKr0omx95LeJFg8B1AzTgQEIY2g1V1QATgHkN/FbAQ2xtoiIDru4/Lur1SWQQbW42Iym5AF1XZZ3H2eGsQkVhXQHxcpgq0dIYmKrl1qu68aKwZdHKBeyTa1dqnJNMZYSl+yG6entji0OFIvbtv7VFbPmj1t+3RjJN6/PDp+RzncO1xZCT1in4frrQOROlzjWYNkoGu3LNMYbayXH9WzMivQJmVnsjvuJNCIETszq0OOzJGwyA0v8oYlrC06rgpOARRJmzG0D9cnhJnZpBzu3TpqmTKOkTEaKVzw1yCkr12Dop7qKcqhiyJNM96zMlnCB9Boq71cFH1QysXEJnF7gOgzLKR65akNzpSsNo6ODj/sY4NpKA5K+9gA/6yUPeCb93MBpQOMOv4H1MvYHYPjoiWLe0qnAAAAAElFTkSuQmCC" /></button>


                            </div>


                        </div>
                    </div>
                </div>

            </div>

            <script>
                function sektorchange(value) {
                    if (value == "Diger") {
                        document.getElementById("diger").style.display = "block";
                    }
                    else {
                        document.getElementById("diger").style.display = "none";
                    }
                }
                $('.form-select').select2({
                    dropdownParent: $('#basicModal'),
                    width: 'resolve'
                });
            </script>

            <script>
           $(function(){
        $("#myForm").submit(function(){
            event.preventDefault();
            var m = document.getElementById("ISIM");
            if (m.value != "" && m.value != null) {
                var formdata = $("#myForm").serialize();    // Serializes the form
                document.body.style.cursor = "wait";
                $.ajax({
                    url: '@Url.Action("PostData", "Satis")',
                    type: 'POST',
                    data: formdata,
                    success: function (result) {
                        const Toast = Swal.mixin({
                            toast: true,
                            position: 'center',
                            showConfirmButton: false,
                            timer: 1000,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })

                        Toast.fire({
                            icon: 'success',
                            title: 'Müşteri başarıyla kaydedildi!'
                        });
                        document.body.style.cursor = "default";
                        $('#ISIM').val(null);
                        $('#ilselect').val(null).trigger("change");
                        $('#ilceselect').val(null).trigger("change");
                        $('#mahalleselect').val(null).trigger("change");
                        $('#sektor').val(null).trigger("change");
                        $('#nitelik').val(null).trigger("change");
                        $('#adres').val(null);
                        document.getElementById("tel1").value = null;
                        $('#not').val(null);
                        $('#diger').val(null);
                        document.getElementById("tel2").value = null;
                        document.getElementById("mail").value = null;
                        getMusteriler();
                    },
                    error: function () {
                        const Toast = Swal.mixin({
                            toast: true,
                            position: 'center',
                            showConfirmButton: false,
                            timer: 3000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })

                        Toast.fire({
                            icon: 'error',
                            title: 'Müşteri kaydedilemedi!'
                        });

                    }
                });
            } else {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'center',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })

                Toast.fire({
                    icon: 'error',
                    title: 'Müşteri ismi girilmedi!'
                });
            }

        });
         $("#randevuForm").submit(function(){
            event.preventDefault();    // Stops the default Beginform functionallity

             var formdata = $("#randevuForm").serialize();    // Serializes the form
            document.body.style.cursor = "wait";
            $.ajax({
                url: '@Url.Action("RandevuOlustur", "Satis")',
                type:'POST',
                data: formdata,
                success: function(result){
                    const Toast = Swal.mixin({
                        toast: true,
                        position: 'center',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.addEventListener('mouseenter', Swal.stopTimer)
                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    })

                    Toast.fire({
                        icon: 'success',
                        title: 'Randevu başarıyla kaydedildi!'
                    });
                    window.location.reload();
                },
                error: function () {
                    const Toast = Swal.mixin({
                        toast: true,
                        position: 'center',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.addEventListener('mouseenter', Swal.stopTimer)
                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    })

                    Toast.fire({
                        icon: 'error',
                        title: 'Randevu kaydedilemedi!'
                    });
                    window.location.reload();
                }
            });
        });
    })
            </script>

        </div>
        <div class="modal fade" id="datepickermodal" tabindex="-1" aria-hidden="true" style="display: none;">

            <div class="modal-dialog modal-fullscreen" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="btn-group menu1">
                            <button type="button" class="btn btn-primary btn-icon rounded-pill dropdown-toggle hide-arrow" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bx bx-dots-vertical-rounded"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" style="">
                                <li><a class="dropdown-item" onclick="changeplan(1)">PLANLANAN</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>


                                <li><a class="dropdown-item" onclick="changeplan(3)">GERCEKLESEN</a></li>

                            </ul>
                        </div>
                        <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                            <input type="radio" class="btn-check" onclick="changeplan(1)" name="btnradio" id="gecmis" checked="" autocomplete="off">
                            <label class="btn btn-outline-primary" for="gecmis">PLANLANAN</label>

                            <input type="radio" class="btn-check" onclick="changeplan(3)" name="btnradio" id="gerceklesen" autocomplete="off">
                            <label class="btn btn-outline-primary" for="gerceklesen">GERCEKLESEN</label>

                        </div>


                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

                    </div>
                    <div id="planlarim" class="modal-body" style="display:block">
                        <div class="row">





                            <div class="col-sm">

                                <div class="text-center" id="ilk">
                                    <span>Planlanan hiçbir ziyaret yoktur.<br /> <a id="ilkziyaret" onclick="ilkziyaret()" style="cursor:pointer;">Eklemek için tıklayın.</a></span>
                                </div>

                                <table class="table table-striped table-bordered" id="example1">
                                    <thead class="thead-dark" id="thead">
                                        <tr>
                                            <th scope="col">Planlanan Tarih</th>
                                            <th scope="col">Gerçekleşen Tarih</th>
                                            <th scope="col">Ziyaret Notu</th>
                                            <th scope="col">Onay</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bdy1">
                                    </tbody>
                                </table>
                                <button class="float-end" onclick="addRw()" style="cursor: pointer; background-color: transparent; background-repeat: no-repeat; border: none;"><img style="width:20px" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAmlJREFUWEftmOFxFDEMhd9VQKiApAJIBUkHQAVABZAKQiogVABUAHRAKiCpINABVEDmu7FuhM5ey3s3zE4G/dm5W9l6lp7l511pYbZaGB7dG0BPJL2QxPOgPEn2taRf5fmpPIeKMJqht5JeFxCZQIC7lHSRccYnC+iZpHeSDrMTB78fks4kfemNzwAiK+dhop9l8m+SCEapMEoI6FNJLOJRGMdck9nqAfpYuGLzAoRJ+T9jL4u/B8bYV63BU4BiZr5KIgC8GDFID4inbhBZYv4tawEi3Z+dNzsGMLtYzPbzGqdagOCFpZnMALBl8OWkvLySBK9aBqktU8Q4io41QL5UcAaiTpXJ+zdLUQJTPoA8KL+3/GuACG4DIF+PwCOAwEHpPxRAxHrosxQBkY3vxYHsZPrOKCCm95Q49h09AqKr0omx95LeJFg8B1AzTgQEIY2g1V1QATgHkN/FbAQ2xtoiIDru4/Lur1SWQQbW42Iym5AF1XZZ3H2eGsQkVhXQHxcpgq0dIYmKrl1qu68aKwZdHKBeyTa1dqnJNMZYSl+yG6entji0OFIvbtv7VFbPmj1t+3RjJN6/PDp+RzncO1xZCT1in4frrQOROlzjWYNkoGu3LNMYbayXH9WzMivQJmVnsjvuJNCIETszq0OOzJGwyA0v8oYlrC06rgpOARRJmzG0D9cnhJnZpBzu3TpqmTKOkTEaKVzw1yCkr12Dop7qKcqhiyJNM96zMlnCB9Boq71cFH1QysXEJnF7gOgzLKR65akNzpSsNo6ODj/sY4NpKA5K+9gA/6yUPeCb93MBpQOMOv4H1MvYHYPjoiWLe0qnAAAAAElFTkSuQmCC" /></button>

                            </div>
                        </div>
                    </div>
                    <div id="planolustur" class="modal-body" style="display:none">
                        <form id="randevuForm" method="post">
                            <div class="row">
                                <div class="col-sm">
                                    <input class="form-control" type="datetime-local" name="PLANLANAN_TARIH" value="" />

                                </div>
                                <div class="col-sm">
                                    <textarea class="form-control" placeholder="Not" rows="4" cols="50" name="RANDEVU_NOTU"></textarea>
                                </div>
                                <div class="col-sm d-none">
                                    <input id="randevumusteri" class="form-control" type="text" name="MUSTERI_ID" value="100001" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm">
                                    <button class="btn btn-info" type="submit" style="background-color: #595cd9">Ekle</button>

                                </div>

                            </div>
                        </form>
                    </div>
                    <div id="gerceklesenplanlar" class="modal-body" style="display:none">
                        <div class="text-center" id="gen">
                            <span>Gerçekleşen hiçbir ziyaret yoktur.</span>
                        </div>
                        <table class="table table-striped table-bordered" id="example3">
                            <thead class="thead-dark" id="thead">
                                <tr>
                                    <th scope="col">Planlanan Tarih</th>

                                    <th scope="col">Ziyaret Notu</th>
                                    <th scope="col">Gerçekleşme Tarihi</th>
                                    <th scope="col">Onay</th>
                                </tr>
                            </thead>
                            <tbody id="bdy2">
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>

            <script>
                function changeplan(value) {
                    if (value == 1) {
                        $('#planlarim').show()
                        $('#planolustur').hide()
                        $('#gerceklesenplanlar').hide()
                    }
                    else {
                        $('#planlarim').hide()
                        $('#planolustur').hide()
                        $('#gerceklesenplanlar').show()
                    }
                }
            </script>



        </div>
        <script type="text/javascript" src="/assets/vendor/libs/jquery/jquery.js"></script>
        <script type="text/javascript" src="/assets/vendor/libs/popper/popper.js"></script>
        <script type="text/javascript" src="/assets/vendor/js/bootstrap.js"></script>
        <script type="text/javascript" src="/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

        <script type="text/javascript" src="/assets/vendor/js/menu.js"></script>
        <!-- endbuild -->
        <!-- Vendors JS -->
        <script type="text/javascript" src="/assets/vendor/libs/apex-charts/apexcharts.js"></script>

        <!-- Main JS -->
        <script type="text/javascript" src="/assets/js/main.js"></script>

        <!-- Page JS -->
        <script type="text/javascript" src="/assets/js/dashboards-analytics.js"></script>

        <!-- Place this tag in your head or just before your close body tag. -->


        <script type="text/javascript" async defer src="/Scripts/buttons.js"></script>
        <script type="text/javascript" src="/Scripts/boxicons.js"></script>

        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/i18n/tr.js"></script>

        <script src="~/crud-bstable/bstable.js"></script>




        <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        <script>


            function updatemusteri() {
                var m = document.getElementById("musteriselect");
                if (m.value != "") {
                    var formdata = $("#myForm").serialize();
                    document.body.style.cursor = "wait";
                    $.ajax({
                        url: '@Url.Action("MusteriGuncelle", "Satis")',
                        type: 'POST',
                        data: formdata,
                        success: function (result) {
                            const Toast = Swal.mixin({
                                toast: true,
                                position: 'center',
                                showConfirmButton: false,
                                timer: 3000,
                                timerProgressBar: true,
                                didOpen: (toast) => {
                                    toast.addEventListener('mouseenter', Swal.stopTimer)
                                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                                }
                            })

                            Toast.fire({
                                icon: 'success',
                                title: 'Müşteri başarıyla güncellendi!'
                            });
                            document.body.style.cursor = "default";

                        },
                        error: function () {
                            const Toast = Swal.mixin({
                                toast: true,
                                position: 'center',
                                showConfirmButton: false,
                                timer: 3000,
                                timerProgressBar: true,
                                didOpen: (toast) => {
                                    toast.addEventListener('mouseenter', Swal.stopTimer)
                                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                                }
                            })

                            Toast.fire({
                                icon: 'error',
                                title: 'Müşteri güncellenemedi!'
                            });
                            document.body.style.cursor = "default";
                        },
                        complate: function (data) {
                            getMusteriler();
                        }
                    })
                } else {
                    const Toast = Swal.mixin({
                        toast: true,
                        position: 'center',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.addEventListener('mouseenter', Swal.stopTimer)
                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    })

                    Toast.fire({
                        icon: 'error',
                        title: 'Müşteri seçilmedi!'
                    });
                }

            }
             function deletemusteri() {
                var m = document.getElementById("musteriselect");
                 if (m.value != "") {
                     var id = m.value;
                     document.body.style.cursor = "wait";
                     Swal.fire({
                         title: 'Onay',
                         icon: 'question',
                         confirmButtonColor: '#3085d6',
                         denyButtonColor: '#d33',
                         text: "Seçili müşteriyi silmek istediğinizden emin misiniz?",
                         showDenyButton: true,
                         confirmButtonText: 'Sil',
                         denyButtonText: `Hayır!`,
                     }).then((result) => {

                         if (result.isConfirmed) {
                              $.ajax({
                         url: '@Url.Action("MusteriSil", "Satis")',
                         type: 'POST',
                         data: { "id":id },
                        success: function (result) {
                            const Toast = Swal.mixin({
                                toast: true,
                                position: 'center',
                                showConfirmButton: false,
                                timer: 1000,
                                didOpen: (toast) => {
                                    toast.addEventListener('mouseenter', Swal.stopTimer)
                                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                                }
                            })

                            Toast.fire({
                                icon: 'success',
                                title: 'Müşteri başarıyla silindi!'
                            });
                            document.body.style.cursor = "default";
                            $('#myForm').trigger("reset");
                            $('#btnradio2').trigger("click");
                        }

                    })
                         }

                     })

                } else {
                    const Toast = Swal.mixin({
                        toast: true,
                        position: 'center',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.addEventListener('mouseenter', Swal.stopTimer)
                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    })

                    Toast.fire({
                        icon: 'error',
                        title: 'Müşteri seçilmedi!'
                    });
                }

            }
            $(document).ready(function () {
               
                $("#sil").hide();
                $("#save").show();
                $("#update").hide();
                $("#urunekle").hide();
                $("#ziyaretplani").hide();

                $.ajax({
                    url: '@Url.Action("GetCities", "Satis")',
                    type: 'POST',
                    success: function (result) {

                        var f = JSON.parse(result);
                        cities = f;
                        var sl = document.getElementById("ilselect");
                        sl.replaceChildren();
                        for (let i = 0; i < f.length; i++) {
                            var option = document.createElement("option");
                            option.innerHTML = f[i].CITYNAME;
                            option.value = f[i].CITYNAME;
                            sl.appendChild(option);
                        }
                        $('#ilselect').val(null).trigger("change");
                    }
                })

                async function getPlasiyer() {
                let response = await fetch(`@Url.Action("GetActiveUsers", "Satis")`);
                    let data = await response.json()
                    return JSON.parse(data);
                }
                var plasiyer = document.getElementById("plasiyer");
               /* var plasiyer1 = document.getElementById("plasiyer1");*/
                var cc = @Html.Raw(Json.Encode(Request.Cookies["UserName"].Value));
                getPlasiyer().then(function (data) {
                    for (let i = 0; i < data.length; i++) {
                        if (data[i].USER_NAME != "admin" && data[i].USER_NAME != "test") {
                            var option = document.createElement("option");
                            /*var option1 = document.createElement("option");*/
                            option.innerHTML = data[i].USER_NAME;
                            option.value = data[i].USER_NAME;
                            //option1.innerHTML = data[i].USER_NAME;
                            //option1.value = data[i].USER_NAME;
                            if (data[i].USER_NAME == cc) {
                                option.selected = "true";
                            }
                            plasiyer.appendChild(option);
                            //plasiyer1.appendChild(option1);
                        }

                    }
                })

                 var ozelyetki = @Html.Raw(Json.Encode(ViewBag.OzelYetki));
                $("#plasiyer").select2(
                    { sorter: data => data.sort((a, b) => a.text.localeCompare(b.text)), }
                );

                $("#plasiyer").val(cc).trigger("change");
                if (ozelyetki != 1) {
                    $("#plasiyer").select2('destroy');
                    $("#plasiyer").hide();
                }

                document.body.style.cursor = "default";
                var uruntable = document.getElementById("bdy");
                if (urunler != null) {
                    for (let i = 0; i < 1; i++) {
                        var tr = document.createElement("tr");
                        var td = document.createElement("td");
                        var urungrubu = document.createElement("select");
                        $.getJSON('http://192.168.2.13:83/api/musteri/urungruplari', function (data) {
                            var data = JSON.parse(data);
                            for (let i = 0; i < data.length; i++) {
                                var opt = document.createElement("option");
                                opt.innerHTML = data[i].URUN_GRUBU;
                                opt.value = data[i].ID;
                                urungrubu.appendChild(opt);
                            }

                        })
                        td.appendChild(urungrubu);
                        var td2 = document.createElement("td");
                        td2.innerHTML = "";
                        var td3 = document.createElement("td");

                        td3.innerHTML = "<select class='form-select w-100' id='olcubirimi'> <option>AD</option> <option>KG</option><option>MT</option> <option>M2</option><option>M3</option><option>PK</option></select> ";
                        td3.setAttribute("name", "bstable-select");
                        tr.appendChild(td);
                        tr.appendChild(td2);
                        tr.appendChild(td3);

                        uruntable.appendChild(tr);

                    }

                }

                $('#ilselect').select2({
                    placeholder: "İl Seçin",
                    allowClear: true,
                    sorter: data => data.sort((a, b) => a.text.localeCompare(b.text)),
                });

                $('#ilceselect').select2({

                    placeholder: "İlçe Seçin",
                    allowClear: true,
                });
                $('#mahalleselect').select2({

                    placeholder: "Mahalle Seçin",
                    allowClear: true,
                });
                $('#nitelik').select2({
                    placeholder: "Nitelik Seçin",
                    allowClear: true,
                });
                $('#sektor').select2({
                    placeholder: "Sektör Seçin",
                    allowClear: true,
                });


                    $('#olcubirimi').select2({
                        dropdownParent: $('#basicModal'),
                        width: 'resolve'
                    });
            $('#urungrubu').select2({
                dropdownParent: $('#basicModal'),
                width: 'resolve'
            });




            })
            function ilkziyaret() {
                document.getElementById("ilk").style.display = "none";
                document.getElementById("example1").style.display = "table";
                addRw();
            }
            function getMusteriler() {


                $.ajax({
                    url: '@Url.Action("GetMusteriler", "Satis")',
                    type: 'POST',
                    success: function (result) {
                        var l = "";
                        if (c == "") {
                            l = @Html.Raw(Json.Encode(ViewBag.Name));
                        } else {
                            l = c;
                        }

                        var f = JSON.parse(result).filter(x => x.PLASIYER == l);
                        var musteri = document.getElementById("musteriselect");
                        musteri.replaceChildren();
                        for (let i = 0; i < f.length; i++) {
                            var option = document.createElement("option");
                            option.innerHTML = f[i].MUSTERI_ADI;
                            option.value = f[i].MUSTERI_ID;
                            musteri.appendChild(option);
                        }

                    },
                    complete: function (data) {
                        if (constant == 1) {
                            $("#musteriselect").select2(
                                {
                                    placeholder: "Müşteri Seçin",
                                    allowClear: true
                                });
                            $("#musteriselect").val(null).trigger("change");
                        }

                         $.ajax({
                            url: '@Url.Action("GetCities", "Satis")',
                            type: 'POST',
                            success: function (result) {

                                var f = JSON.parse(result);

                                var sl = document.getElementById("il");
                                sl.replaceChildren();
                                for (let i = 0; i < f.length; i++) {
                                    var option = document.createElement("option");
                                    option.innerHTML = f[i].CITYNAME;
                                    option.value = f[i].CITYNAME;
                                    sl.appendChild(option);
                                }
                             },
                             complete: function () {
                                  $.ajax({
                            url: '@Url.Action("GetDistricts", "Satis")',
                            type: 'POST',
                            success: function (result) {

                                var f = JSON.parse(result);
                                var ilce = document.getElementById("ilceselect");
                                ilce.replaceChildren();
                                for (let i = 0; i < f.length; i++) {
                                    var option = document.createElement("option");
                                    option.innerHTML = f[i].ILCEADI;
                                    option.value = f[i].ILCEID;
                                    ilce.appendChild(option);

                                }
                                      },
                                      complete: function () {
                                          if (constant == 1) {
                                              $("#musteri").trigger("change");
                                          }

                                      }
                 })
                             }
                        })


                    }
                })

            }
        function change(value) {

            if (value == 1) {
                $("#sil").hide();
                $("#save").show();
                $("#update").hide();
                $("#urunekle").hide();
                $("#ziyaretplani").hide();
                $("#degistir").hide();

                $("#ISIM").show();
                $("#musteriselect").val(null);
                $("#musteriselect").select2("destroy");
                $("#musteriselect").removeAttr("style").hide();
                $("#ilselect").val(null).trigger("change");
                $("#ilceselect").val(null).trigger("change");
                $("#ISIM").val(null);
                $("#tel1").val(null);
                $("#tel2").val(null);
                $("#mail").val(null);
                $("#not").val(null);
                $("#yetkili").val(null);
                $("#sektor").val(null).trigger("change");
                $("#nitelik").val(null).trigger("change");
                constant = 0;
                var cc = @Html.Raw(Json.Encode(Request.Cookies["UserName"].Value));
                $("#plasiyer").val(cc).trigger("change");
                var ozelyetki = @Html.Raw(Json.Encode(ViewBag.OzelYetki));

                if (ozelyetki != 1) {
                    $("#plasiyer").select2('destroy');
                    $("#plasiyer").hide();
                }

            } else {
                constant1 = 2;
                constant = 1;
                $("#sil").show();
                $("#degistir").show();
                $("#save").hide();
                $("#urunekle").show();
                $("#ziyaretplani").show();
                $("#update").show();
                $("#ISIM").removeAttr("style").hide();
                $("#musteriselect").show();
                $("#ilselect").val(null).trigger("change");
                $("#ilceselect").val(null).trigger("change");
                $("#mahalleselect").val(null).trigger("change");
                $("#tel1").val(null);
                $("#tel2").val(null);
                $("#mail").val(null);
                $("#not").val(null);
                $("#sektor").val(null).trigger("change");
                $("#yetkili").val(null);
                $("#nitelik").val(null).trigger("change");
                $("#musteriselect").attr("style", "width:100%");
                $("#musteriselect").select2({
                    maximumSelectionLength: 1,
                    placeholder: "Müşteri Seçin",
                    allowClear:true
                });
                var cc = @Html.Raw(Json.Encode(Request.Cookies["UserName"].Value));
                var ozelyetki = @Html.Raw(Json.Encode(ViewBag.OzelYetki));
                $("#plasiyer").val(cc).trigger("change");
                if (ozelyetki != 1) {
                    $("#plasiyer").select2('destroy');
                    $("#plasiyer").hide();
                }
                c = "";
                getMusteriler();

            }


        }
            async function getDis() {
                let response = await fetch(`@Url.Action("GetDistricts", "Satis")`);
                    let data = await response.json()
                    return JSON.parse(data);
            }
           
            function citychange(value) {
                getDis().then(function (data) {
                    var selected = data.filter(x => x.SEHIRADI == value);

                    var ilce = document.getElementById("ilceselect");
                    ilce.replaceChildren();
                    for (let i = 0; i < selected.length; i++) {
                        var option = document.createElement("option");
                        option.innerHTML = selected[i].ILCEADI;
                        option.value = selected[i].ILCEID;
                        ilce.appendChild(option);

                    }
                    $("#ilceselect").val(null).trigger("change");
                })





            }
            function ilcechange(value) {
                var d = null;
                $.getJSON("http://192.168.2.13:83/api/location/mahalle/" + value).then(function (data) {
                    d = data;
                }).then(function () {
                    var mah = document.getElementById("mahalleselect");
                 
                    mah.replaceChildren();
                    for (let i = 0; i < d.length; i++) {
                        var option = document.createElement("option");
                        option.innerHTML = d[i].MAHALLEADI;
                        option.value = d[i].MAHID;
                        mah.appendChild(option);

                    }
                })
                
                 
                   
               

            }

            function plasiyerchange(value) {

                if (constant != 0) {

                    c = value;
                    getMusteriler();
                    //$("#plasiyer1").select2();
                    //$("#plasiyer1").val(value).trigger("change");
                    /*$("#plasiyerdeg").hide();*/
                }
                
                $("#ilselect").val(null).trigger("change");
                $("#ilceselect").val(null).trigger("change");
                $("#ISIM").val(null);
                $("#tel1").val(null);
                $("#tel2").val(null);
                $("#mail").val(null);
                $("#not").val(null);
                
                $("#yetkili").val(null);
                $("#sektor").val(null).trigger("change");
                $("#nitelik").val(null).trigger("change");
                
            }
            function musterichange(value) {
                $.ajax({
                    type: "POST",
                    url: "@Url.Action("GetRandevu")",
                    dataType: "json",
                    success: function (data) {

                        var filt = JSON.parse(data).filter(x => x.MUSTERI_ID == value);
                        if (filt.length > 0) {
                            document.getElementById("ilk").style.display = "none";
                            var d = JSON.parse(data);
                            var u = d.filter(x => x.MUSTERI_ID == value && x.GERCEKLESEN_TARIH == null);
                            var u2 = d.filter(x => x.MUSTERI_ID == value && x.GERCEKLESEN_TARIH != null);
                            if (u.length == 0) {
                                document.getElementById("example1").style.display = "none";
                                document.getElementById("ilk").style.display = "block";
                                document.getElementById("bdy1").replaceChildren();
                                document.getElementById("bdy2").replaceChildren();
                            } else {
                                document.getElementById("example1").style.display = "table";
                                document.getElementById("ilk").style.display = "none";
                                document.getElementById("bdy1").replaceChildren();
                                document.getElementById("bdy2").replaceChildren();
                            }
                            document.getElementById("bdy1").replaceChildren();
                            document.getElementById("bdy2").replaceChildren();
                            for (let i = 0; i < u.length; i++) {
                                var tr = document.createElement("tr");
                                var td = document.createElement("td");
                                var td2 = document.createElement("td");
                                var td3 = document.createElement("td");
                                var td4 = document.createElement("td");
                                var td5 = document.createElement("td");
                                td5.innerHTML = u[i].INCKEY;
                                td5.style.display = "none";
                                var span = document.createElement("a");
                                span.innerHTML = "<i class='bx bx-edit bx-md bx-tada-hover'></i>"
                                span.style.cursor = "pointer";
                                var d = "";
                                var y = "";
                                span.onclick = function () {
                                    var bdy1 = document.getElementById("bdy1");
                                    var t = bdy1.getElementsByTagName("tr");
                                    d = t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value;
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].removeAttribute("readonly");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].removeAttribute("disabled");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[4].style.display = "inline-block";
                                };
                                var span2 = document.createElement("a");
                                span2.style.cursor = "pointer";
                                span2.onclick = function () {
                                    var bdy1 = document.getElementById("bdy1");
                                    var t = bdy1.getElementsByTagName("tr");
                                    if (t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("td")[4].innerHTML != "") {
                                        $.ajax({
                                            type: 'POST',
                                            url: '@Url.Action("RandevuSil", "Satis")',
                                            data: JSON.stringify({ "INCKEY": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("td")[4].innerHTML }),
                                            contentType: "application/json",
                                            success: function () {
                                                const Toast = Swal.mixin({
                                                    toast: true,
                                                    position: 'center',
                                                    showConfirmButton: false,
                                                    timer: 3000,
                                                    timerProgressBar: true,
                                                    didOpen: (toast) => {
                                                        toast.addEventListener('mouseenter', Swal.stopTimer)
                                                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                                                    }
                                                })

                                                Toast.fire({
                                                    icon: 'success',
                                                    title: 'Ziyaret başarıyla silindi!'
                                                });
                                            },
                                            error: function () {

                                            },
                                            dataType: 'json'
                                        });
                                    }
                                    document.getElementById("bdy1").deleteRow(this.parentNode.parentNode.rowIndex - 1);
                                };
                                span2.innerHTML = "<i class='bx bx-trash bx-md bx-tada-hover'></i>";
                                var span3 = document.createElement("a");
                                span3.innerHTML = "<i class='bx bx-like bx-md bx-tada-hover'></i>";
                                span3.style.cursor = "pointer";
                                span3.onclick = function () {
                                    var bdy1 = document.getElementById("bdy1");
                                    var t = bdy1.getElementsByTagName("tr");
                                    y = t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].value;
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].removeAttribute("readonly");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].removeAttribute("disabled");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[4].style.display = "inline-block";
                                }
                                var span4 = document.createElement("a");
                                span4.innerHTML = "<i class='bx bx-md bxs-check-circle bx-md bx-tada-hover'></i>";
                                span4.style.display = "none";
                                span4.style.cursor = "pointer";
                                span4.onclick = function () {
                                    var bdy1 = document.getElementById("bdy1");
                                    var t = bdy1.getElementsByTagName("tr");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].setAttribute("readonly", "");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[4].style.display = "none";

                                    $.ajax({
                                        type: 'POST',
                                        url: '@Url.Action("RandevuEkleGuncelle", "Satis")',
                                        data: JSON.stringify({ "INCKEY": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("td")[4].innerHTML, "MUSTERI_ID": parseInt(document.getElementById("musteriselect").value), "RANDEVU_NOTU": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].value, "PLANLANAN_TARIH": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value, "GERCEKLESEN_TARIH": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].value }),
                                        contentType: "application/json",
                                        success: function () {
                                            const Toast = Swal.mixin({
                                                toast: true,
                                                position: 'center',
                                                showConfirmButton: false,
                                                timer: 1000,
                                                timerProgressBar: true,
                                                didOpen: (toast) => {
                                                    toast.addEventListener('mouseenter', Swal.stopTimer)
                                                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                                                }
                                            })
                                            musterichange(value);
                                            Toast.fire({
                                                icon: 'success',
                                                title: 'Ziyaret başarıyla güncellendi!'
                                            });
                                        },
                                        error: function () {

                                        },
                                        dataType: 'json'
                                    });
                                }
                                var span5 = document.createElement("a");
                                span5.style.cursor = "pointer";
                                span5.onclick = function () {
                                    var bdy1 = document.getElementById("bdy1");
                                    var t = bdy1.getElementsByTagName("tr");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].setAttribute("readonly", "");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].setAttribute("disabled", "true");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value = d;
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].value = y;
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[4].style.display = "none";
                                };
                                span5.innerHTML = "<i class='bx bxs-x-circle bx-md bx-tada-hover'></i>";
                                span5.style.display = "none";

                                td.innerHTML = "<label class='label text-center mb-2'><b>ZİYARET TARİHİ</b></label><input class='form-control' style='width:100%' type='datetime-local' value='" + u[i].PLANLANAN_TARIH + "' disabled='true'></input>";
                                td2.innerHTML = "<label class='label text-center mb-2'><b>GERÇEKLEŞEN TARİH</b></label><input class='form-control' style='width:100%' type='datetime-local'  disabled='true'></input>";
                                var n = " ";
                                if (u[i].RANDEVU_NOTU != null) {
                                    n = u[i].RANDEVU_NOTU;
                                }
                                td3.innerHTML = "<label class='label text-center  mb-2'><b>ZİYARET NOTU</b></label><textarea readonly class='form-control' placeholder='Not' rows='4' cols='50'>" + n + "</textarea>";
                                tr.appendChild(td);
                                tr.appendChild(td2);
                                tr.appendChild(td3);

                                td4.appendChild(span);
                                td4.appendChild(span2);
                                td4.appendChild(span3);
                                td4.appendChild(span4);
                                td4.appendChild(span5);
                                tr.appendChild(td4);
                                tr.appendChild(td5);

                                document.getElementById("bdy1").appendChild(tr);
                            }
                            if (u2.length > 0) {

                                document.getElementById("gen").style.display = "none";
                                for (let i = 0; i < u2.length; i++) {
                                    var tru = document.createElement("tr");
                                    var tdu = document.createElement("td");
                                    var tdu2 = document.createElement("td");
                                    tdu2.innerHTML = u2[i].INCKEY;
                                    tdu2.style.display = "none";
                                var span = document.createElement("a");
                                span.innerHTML = "<i class='bx bx-edit bx-md bx-tada-hover'></i>"
                                span.style.cursor = "pointer";
                                var y = "";
                                span.onclick = function () {
                                    var bdy1 = document.getElementById("bdy2");
                                    var t = bdy1.getElementsByTagName("tr");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].removeAttribute("readonly");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].removeAttribute("disabled");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].removeAttribute("disabled");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "inline-block";

                                };
                                var span2 = document.createElement("a");
                                span2.style.cursor = "pointer";

                                span2.innerHTML = "<i class='bx bx-trash bx-md bx-tada-hover'></i>";
                                span2.onclick = function () {
                                    var bdy1 = document.getElementById("bdy2");
                                    var t = bdy1.getElementsByTagName("tr");
                                    if (t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("td")[1].innerHTML != "") {
                                        $.ajax({
                                            type: 'POST',
                                            url: '@Url.Action("RandevuSil", "Satis")',
                                            data: JSON.stringify({ "INCKEY": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("td")[1].innerHTML }),
                                            contentType: "application/json",
                                            success: function () {
                                                const Toast = Swal.mixin({
                                                    toast: true,
                                                    position: 'center',
                                                    showConfirmButton: false,
                                                    timer: 3000,
                                                    timerProgressBar: true,
                                                    didOpen: (toast) => {
                                                        toast.addEventListener('mouseenter', Swal.stopTimer)
                                                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                                                    }
                                                })
                                                musterichange(value);
                                                Toast.fire({
                                                    icon: 'success',
                                                    title: 'Ziyaret başarıyla silindi!'
                                                });
                                            },
                                            error: function () {

                                            },
                                            dataType: 'json'
                                        });
                                    }
                                    document.getElementById("bdy1").deleteRow(this.parentNode.parentNode.rowIndex - 1);
                                };
                                var span4 = document.createElement("a");
                                span4.innerHTML = "<i class='bx bx-md bxs-check-circle bx-md bx-tada-hover'></i>";
                                span4.style.display = "none";
                                span4.style.cursor = "pointer";
                                span4.onclick = function () {
                                    var bdy1 = document.getElementById("bdy2");
                                    var t = bdy1.getElementsByTagName("tr");

                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].setAttribute("readonly", "");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].setAttribute("disabled", "true");
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";

                                    $.ajax({
                                        type: 'POST',
                                        url: '@Url.Action("RandevuEkleGuncelle", "Satis")',
                                        data: JSON.stringify({ "INCKEY": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("td")[1].innerHTML, "MUSTERI_ID": parseInt(document.getElementById("musteriselect").value), "RANDEVU_NOTU": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].value, "PLANLANAN_TARIH": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value, "GERCEKLESEN_TARIH": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].value }),
                                        contentType: "application/json",
                                        success: function () {
                                            const Toast = Swal.mixin({
                                                toast: true,
                                                position: 'center',
                                                showConfirmButton: false,
                                                timer: 3000,
                                                timerProgressBar: true,
                                                didOpen: (toast) => {
                                                    toast.addEventListener('mouseenter', Swal.stopTimer)
                                                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                                                }
                                            })

                                            Toast.fire({
                                                icon: 'success',
                                                title: 'Ziyaret başarıyla güncellendi!'
                                            });
                                        },
                                        error: function () {

                                        },
                                        dataType: 'json'
                                    });
                                }
                                var span5 = document.createElement("a");
                                span5.style.cursor = "pointer";

                                span5.innerHTML = "<i class='bx bxs-x-circle bx-md bx-tada-hover'></i>";
                                span5.style.display = "none";
                                    span5.onclick = function () {
                                        var bdy1 = document.getElementById("bdy2");
                                        var t = bdy1.getElementsByTagName("tr");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].setAttribute("readonly", "");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].setAttribute("disabled", "true");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                                    }

                                    var td3u = document.createElement("td");
                                    var td5u = document.createElement("td");
                                    var td6u = document.createElement("td");

                                    td5u.innerHTML = "<label class='label text-center mb-2'><b>GERÇEKLEŞEN TARİH</b></label><input class='form-control text-left' disabled='true' style='width:100%' type='datetime-local' value='" + u2[i].GERCEKLESEN_TARIH + "'></input>";


                                    tdu.innerHTML = "<label class='label text-center mb-2'><b>ZİYARET TARİHİ</b></label><input disabled='true' class='form-control text-left' style='width:100%' type='datetime-local' value='" + u2[i].PLANLANAN_TARIH + "'></input>";
                                    var n1 = "";
                                    if (u2[i].RANDEVU_NOTU != null) {
                                        n1 = u2[i].RANDEVU_NOTU;
                                    }
                                    td3u.innerHTML = "<label class='label text-center mb-2'><b>ZİYARET NOTU</b></label><textarea readonly class='form-control' placeholder='Not' rows='4' cols='50'>" + n1 + "</textarea>";
                                    tru.appendChild(tdu);
                                    tru.appendChild(tdu2);
                                    tru.appendChild(td3u);
                                    tru.appendChild(td5u);
                                    td6u.appendChild(span);
                                    td6u.appendChild(span2);
                                    td6u.appendChild(span4);
                                    td6u.appendChild(span5);
                                    tru.appendChild(td6u);
                                    document.getElementById("bdy2").appendChild(tru);
                                }

                            } else {

                                document.getElementById("example3").style.display = "none";
                                document.getElementById("gen").style.display = "block";
                            }

                        }
                        else {
                            document.getElementById("example1").style.display = "none";
                            document.getElementById("ilk").style.display = "block";
                            document.getElementById("bdy1").replaceChildren();
                            document.getElementById("bdy2").replaceChildren();
                        }

                    },
                    failure: function (errMsg) {
                        document.getElementById("bdy1").replaceChildren();


                    }

                });
                $.ajax({
                    url: '@Url.Action("GetMusteriler", "Satis")',
                    type: 'POST',
                    success: function (result) {
                        var l = c;
                        if (l == "") {
                            l = @Html.Raw(Json.Encode(ViewBag.Name));
                        }
                        var ozelyetki = @Html.Raw(Json.Encode(ViewBag.OzelYetki));
                        if (ozelyetki != 1) {
                            musteriler = JSON.parse(result).filter(x => x.KAYIT_YAPAN_KULLANICI == l);
                        } else {
                            musteriler = JSON.parse(result);
                        }

                        var bilgiler = musteriler.filter(x => x.MUSTERI_ID == $('#musteriselect').val());


                        //document.getElementById("thead").getElementsByTagName("tr")[0].getElementsByTagName("th")[3].remove();


                        $('#sektor').val(bilgiler[0].MUSTERI_SEKTOR).trigger('change');
                        $('#nitelik').val(bilgiler[0].MUSTERI_NITELIK).trigger('change');
                        $('#adres').val(bilgiler[0].MUSTERI_ADRES);
                        document.getElementById("tel1").value = bilgiler[0].MUSTERI_TEL1;
                        $('#not').val(bilgiler[0].MUSTERI_NOTU);
                        $('#randevumusteri').val(bilgiler[0].MUSTERI_ID);
                        $('#yetkili').val(bilgiler[0].FIRMA_YETKILISI);
                        $('#diger').val(bilgiler[0].MUSTERI_SEKTOR_DIGER);
                        document.getElementById("tel2").value = bilgiler[0].MUSTERI_TEL2;
                        document.getElementById("mail").value = bilgiler[0].MUSTERI_MAIL;

                        $('#ilselect').val(bilgiler[0].MUSTERI_IL).trigger('change');


                        setTimeout(function () {
                             $.ajax({
                    url: '@Url.Action("GetDistricts", "Satis")',
                    type: 'POST',
                    success: function (result) {

                        var f = JSON.parse(result);

                        var selected = f.filter(x => x.SEHIRADI == bilgiler[0].MUSTERI_IL && x.ILCEADI == bilgiler[0].MUSTERI_ILCE);
                        $('#ilceselect').val(selected[0].ILCEID).trigger('change');
                        setTimeout(function () {
                             $.ajax({
                            url: '@Url.Action("GetMahalleler", "Satis")',
                    type: 'POST',
                                 data: { "e": selected[0].ILCEID },
                                 success: function (result) {
                                     var d = JSON.parse(result).filter(x => x.MAHALLEADI == bilgiler[0].MUSTERI_MAHALLE);
                                     $('#mahalleselect').val(d[0].MAHID).trigger('change');


                    }
                 })

                        },200)}

                })

                        }, 450);

                    },
                    complete: function (result) {








                        var uruntable = document.getElementById("bdy");
                        uruntable.replaceChildren();
                        $.ajax({
                            type: "POST",
                            url: "@Url.Action("GetMusteriUrun")",
                            dataType: "json",
                            success: function (data) {
                                var e = @Html.Raw(Json.Encode(Request.Cookies["UserName"].Value));
                                var ozelyetki = @Html.Raw(Json.Encode(ViewBag.OzelYetki));
                                var filt = null;
                                if (ozelyetki != 1) {
                                    filt = JSON.parse(data).filter(x => x.MUSTERI_ID == value && x.KAYIT_YAPAN_KULLANICI == e);

                                } else {

                                    filt = JSON.parse(data).filter(x => x.MUSTERI_ID == value);

                                }

                                if (filt.length > 0) {
                                    for (let i = 0; i < filt.length; i++) {
                                        var tr = document.createElement("tr");
                                        var td = document.createElement("td");
                                        td.setAttribute("scope", "row");
                                        td.setAttribute("data-label", "ÜRÜN GRUBU");
                                        var urungrubu = document.createElement("select");
                                        urungrubu.className = "form-select";
                                        for (let a = 0; a < urungruplari.length; a++) {
                                            var opt = document.createElement("option");
                                            opt.innerHTML = urungruplari[a].URUN_GRUBU;
                                            opt.value = urungruplari[a].ID;
                                            if (filt[i].URUN_GRUBU == urungruplari[a].URUN_GRUBU) {
                                                opt.selected = true;
                                            }
                                            urungrubu.appendChild(opt);

                                        }
                                        td.appendChild(urungrubu);

                                        var td2 = document.createElement("td");
                                        var input2 = document.createElement("input");
                                        input2.className = "form-control";
                                        input2.name = "yillik";
                                        input2.type = "text";
                                        input2.value = filt[i].YILLIK_KULLANIM.toLocaleString("en");
                                        input2.onkeydown = function (event) {
                                            var key = event.which;
                                            if (((key < 48 || key > 57) && (key < 96 || key > 105)) && key != 8) event.preventDefault();
                                        }
                                        input2.onkeyup = function (event) {

                                            var value = this.value.replace(/,/g, "");
                                            this.dataset.currentValue = parseInt(value);
                                            var caret = value.length - 1;
                                            while ((caret - 3) > -1) {
                                                caret -= 3;
                                                value = value.split('');
                                                value.splice(caret + 1, 0, ",");
                                                value = value.join('');
                                            }
                                            this.value = value;
                                        }
                                        input2.disabled = "true";
                                        td2.appendChild(input2);
                                        td2.setAttribute("scope", "row");
                                        td2.setAttribute("data-label", "YILLIK KULLANIM");
                                        var td3 = document.createElement("td");
                                        td3.setAttribute("scope", "row");
                                        td3.setAttribute("data-label", "ÖLÇÜ BİRİMİ");
                                        var select = document.createElement("select");
                                        select.innerHTML = "<option value='AD'>AD</option> <option value='KG'>KG</option><option value='MT'>MT</option> <option value='M2'>M2</option><option value='M3'>M3</option><option value='PK'>PK</option>";
                                        select.className = "form-select hop w-100";
                                        select.value = filt[i].OLCU_BIRIMI;

                                        td3.appendChild(select);
                                        td3.setAttribute("name", "bstable-select");
                                        var td5 = document.createElement("td");
                                        var span = document.createElement("a");
                                        span.innerHTML = "<i class='bx bx-edit bx-md bx-tada-hover'></i>"
                                        span.style.cursor = "pointer";
                                        span.onclick = function () {
                                            var bdy1 = document.getElementById("bdy");
                                            var t = bdy1.getElementsByTagName("tr");
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].removeAttribute("disabled");
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].removeAttribute("disabled");
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "none";
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "none";
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "inline-block";
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "inline-block";


                                        };
                                        var span2 = document.createElement("a");
                                        span2.style.cursor = "pointer";
                                        span2.onclick = function () {
                                            var bdy1 = document.getElementById("bdy");
                                            var t = bdy1.getElementsByTagName("tr");

                                            if (t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value != "") {
                                                $.ajax({
                                                    type: 'POST',
                                                    url: '@Url.Action("UrunSil", "Satis")',
                                                    data: JSON.stringify({ "MUSTERI_ID": parseInt(document.getElementById("musteriselect").value), "URUN_GRUBU": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value }),
                                                    contentType: "application/json",
                                                    success: function () {
                                                        const Toast = Swal.mixin({
                                                            toast: true,
                                                            position: 'center',
                                                            showConfirmButton: false,
                                                            timer: 3000,
                                                            timerProgressBar: true,
                                                            didOpen: (toast) => {
                                                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                                                            }
                                                        })

                                                        Toast.fire({
                                                            icon: 'success',
                                                            title: 'Ürün başarıyla silindi!'
                                                        });
                                                    },
                                                    error: function () {

                                                    },
                                                    dataType: 'json'
                                                });
                                            }
                                            document.getElementById("bdy").deleteRow(this.parentNode.parentNode.rowIndex - 1);
                                        };
                                        span2.innerHTML = "<i class='bx bx-trash bx-md bx-tada-hover'></i>";

                                        var span4 = document.createElement("a");


                                        span4.innerHTML = "<i class='bx bx-md bxs-check-circle bx-md bx-tada-hover'></i>";
                                        span4.style.cursor = "pointer";
                                        span4.onclick = function () {
                                            var bdy1 = document.getElementById("bdy");
                                            var t = bdy1.getElementsByTagName("tr");
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].setAttribute("disabled", "true");
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                                            if (this.parentNode.parentNode.rowIndex != 0) {
                                                for (let i = this.parentNode.parentNode.rowIndex - 2; i > 0; i--) {
                                                    if (t[i].getElementsByTagName("input")[0].value == t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value) {
                                                        return false;
                                                    }
                                                }
                                            }

                                            var f = filt.filter(x => x.URUN_ID == t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].value);
                                            if (f.length > 0) {
                                                $.ajax({
                                                    type: 'POST',
                                                    url: '@Url.Action("UrunGuncelle", "Satis")',
                                                    data: JSON.stringify({ "URUN_GRUBU": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value, "OLCU_BIRIMI": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].value, "YILLIK_KULLANIM": parseInt(t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].value.replace(',', '')), "MUSTERI_ID": document.getElementById("musteriselect").value }),
                                                    contentType: "application/json",
                                                    success: function () {
                                                        const Toast = Swal.mixin({
                                                            toast: true,
                                                            position: 'center',
                                                            showConfirmButton: false,
                                                            timer: 3000,
                                                            timerProgressBar: true,
                                                            didOpen: (toast) => {
                                                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                                                            }
                                                        })

                                                        Toast.fire({
                                                            icon: 'success',
                                                            title: 'Ürün başarıyla güncellendi!'
                                                        });
                                                        musterichange(parseInt(document.getElementById("musteriselect").value));
                                                    },
                                                    error: function () {

                                                    },
                                                    dataType: 'json'
                                                });
                                            }
                                            else {
                                                $.ajax({
                                                    type: 'POST',
                                                    url: '@Url.Action("UrunGonder", "Satis")',
                                                    data: JSON.stringify({ "URUN_GRUBU": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value, "OLCU_BIRIMI": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].value, "YILLIK_KULLANIM": parseInt(t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].value.replace(',', '')), "MUSTERI_ID": document.getElementById("musteriselect").value }),
                                                    contentType: "application/json",
                                                    success: function () {
                                                        const Toast = Swal.mixin({
                                                            toast: true,
                                                            position: 'center',
                                                            showConfirmButton: false,
                                                            timer: 3000,
                                                            timerProgressBar: true,
                                                            didOpen: (toast) => {
                                                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                                                            }
                                                        })

                                                        Toast.fire({
                                                            icon: 'success',
                                                            title: 'Ürün başarıyla eklendi!'
                                                        });
                                                        musterichange(parseInt(document.getElementById("musteriselect").value));
                                                    },
                                                    error: function () {

                                                    },
                                                    dataType: 'json'
                                                });
                                            }
                                        }
                                        var span5 = document.createElement("a");
                                        span5.style.cursor = "pointer";
                                        span5.onclick = function () {
                                            var bdy1 = document.getElementById("bdy");
                                            var t = bdy1.getElementsByTagName("tr");
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].setAttribute("disabled", "true");
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                                            t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                                        };
                                        span5.innerHTML = "<i class='bx bxs-x-circle bx-md bx-tada-hover'></i>";
                                        span4.style.display = "none";
                                        span5.style.display = "none";
                                        tr.appendChild(td);
                                        tr.appendChild(td2);
                                        tr.appendChild(td3);
                                        td5.appendChild(span);
                                        td5.appendChild(span2);
                                        td5.appendChild(span4);
                                        td5.appendChild(span5);
                                        tr.appendChild(td5);

                                        uruntable.appendChild(tr);


                                        uruntable.appendChild(tr);
                                        $('.hop').select2({
                                            dropdownParent: $('#basicModal'),
                                            width: 'resolve'
                                        });
                                    }

                                }
                                else {

                                    var tr = document.createElement("tr");
                                    var td = document.createElement("td");
                                    var urungrubu = document.createElement("select");
                                    urungrubu.className = "form-select hop";


                                        for (let a = 0; a < urungruplari.length; a++) {
                                            var opt = document.createElement("option");
                                            opt.innerHTML = urungruplari[a].URUN_GRUBU;
                                            opt.value = urungruplari[a].ID;
                                            urungrubu.appendChild(opt);
                                        }

                                    td.appendChild(urungrubu);
                                    var td2 = document.createElement("td");
                                    var input2 = document.createElement("input");
                                    input2.className = "form-control";
                                    input2.name = "yillik";
                                    td2.appendChild(input2);
                                    input2.type = "text";
                                    input2.onkeydown = function (event) {
                                        var key = event.which;
                                        if ((((key < 48 || key > 57) && (key < 96 || key > 105)) && (key < 96 || key > 105) ) && key != 8) event.preventDefault();
                                    }
                                    input2.onkeyup = function (event) {
                                        var value = event.target.value.replace(/,/g, "");
                                        this.dataset.currentValue = parseInt(value);
                                        var caret = value.length - 1;
                                        while ((caret - 3) > -1) {
                                            caret -= 3;
                                            value = value.split('');
                                            value.splice(caret + 1, 0, ",");
                                            value = value.join('');
                                        }
                                        this.value = value;
                                    }

                                    var td3 = document.createElement("td");

                                    td3.innerHTML = "<select class='form-select hop'><option value='AD'>AD</option> <option value='KG'>KG</option><option value='MT'>MT</option> <option value='M2'>M2</option><option value='M3'>M3</option><option value='PK'>PK</option></select> ";
                                    td3.setAttribute("name", "bstable-select");
                                    var td5 = document.createElement("td");
                                    var span = document.createElement("a");
                                    span.innerHTML = "<i class='bx bx-edit bx-md bx-tada-hover'></i>"
                                    span.style.cursor = "pointer";
                                    span.onclick = function () {
                                        var bdy1 = document.getElementById("bdy");
                                        var t = bdy1.getElementsByTagName("tr");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].removeAttribute("disabled");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].removeAttribute("disabled");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "none";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "none";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "inline-block";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "inline-block";
                                    };
                                    var span2 = document.createElement("a");
                                    span2.style.cursor = "pointer";
                                    span2.onclick = function () {
                                        document.getElementById("bdy").deleteRow(this.parentNode.parentNode.rowIndex - 1);
                                        if (t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value != "") {
                                            $.ajax({
                                                type: 'POST',
                                                url: '@Url.Action("UrunSil", "Satis")',
                                                data: JSON.stringify({ "MUSTERI_ID": document.getElementById("musteriselect").value, "URUN_GRUBU": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value }),
                                                contentType: "application/json",
                                                success: function () {
                                                    const Toast = Swal.mixin({
                                                        toast: true,
                                                        position: 'center',
                                                        showConfirmButton: false,
                                                        timer: 3000,
                                                        timerProgressBar: true,
                                                        didOpen: (toast) => {
                                                            toast.addEventListener('mouseenter', Swal.stopTimer)
                                                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                                                        }
                                                    })

                                                    Toast.fire({
                                                        icon: 'success',
                                                        title: 'Ürün başarıyla silindi!'
                                                    });
                                                },
                                                error: function () {

                                                },
                                                dataType: 'json'
                                            });
                                        }
                                    };
                                    span2.innerHTML = "<i class='bx bx-trash bx-md bx-tada-hover'></i>";

                                    var span4 = document.createElement("a");

                                    span2.style.display = "none";
                                    span.style.display = "none";
                                    span4.innerHTML = "<i class='bx bx-md bxs-check-circle bx-md bx-tada-hover'></i>";
                                    span4.style.cursor = "pointer";
                                    span4.onclick = function () {
                                        var bdy1 = document.getElementById("bdy");
                                        var t = bdy1.getElementsByTagName("tr");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].setAttribute("disabled", "true");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                                        $.ajax({
                                            type: 'POST',
                                            url: '@Url.Action("UrunGonder", "Satis")',
                                            data: JSON.stringify({ "URUN_ID": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].value,"URUN_GRUBU": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].options[t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].selectedIndex].text, "OLCU_BIRIMI": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[1].value, "YILLIK_KULLANIM": parseInt(t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value.replace(',', '')), "MUSTERI_ID": document.getElementById("musteriselect").value }),
                                            contentType: "application/json",
                                            success: function () {
                                                const Toast = Swal.mixin({
                                                    toast: true,
                                                    position: 'center',
                                                    showConfirmButton: false,
                                                    timer: 3000,
                                                    timerProgressBar: true,
                                                    didOpen: (toast) => {
                                                        toast.addEventListener('mouseenter', Swal.stopTimer)
                                                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                                                    }
                                                })

                                                Toast.fire({
                                                    icon: 'success',
                                                    title: 'Ürün başarıyla eklendi!'
                                                });
                                                musterichange(parseInt(document.getElementById("musteriselect").value));
                                            },
                                            error: function () {

                                            },
                                            dataType: 'json'
                                        });
                                    }
                                    var span5 = document.createElement("a");
                                    span5.style.cursor = "pointer";
                                    span5.onclick = function () {
                                        var bdy1 = document.getElementById("bdy");
                                        var t = bdy1.getElementsByTagName("tr");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].setAttribute("disabled", "true");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                                        t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                                    };
                                    span5.innerHTML = "<i class='bx bxs-x-circle bx-md bx-tada-hover'></i>";
                                    tr.appendChild(td);
                                    tr.appendChild(td2);
                                    tr.appendChild(td3);
                                    td5.appendChild(span);
                                    td5.appendChild(span2);
                                    td5.appendChild(span4);
                                    td5.appendChild(span5);
                                    tr.appendChild(td5);

                                    uruntable.appendChild(tr);
                                }
                                $('.hop').select2({
                                    dropdownParent: $('#basicModal'),
                                    width: 'resolve'
                                });
                            }
                        });
                    }
                })

            }




            function yenile() {
                window.location.reload();

            }
            function getRow(x) {
                alert(x.rowIndex);
            }
        </script>
        <script>
           function addRw() {

                             var tr = document.createElement("tr");
                            var td = document.createElement("td");
                            var td2 = document.createElement("td");




                            var td3 = document.createElement("td");


                            var td4 = document.createElement("td");

                            var td5 = document.createElement("td");
                            td5.style.display = "none";
                            var span = document.createElement("a");
                            span.innerHTML = "<i class='bx bx-edit bx-md bx-tada-hover'></i>"
                            span.style.cursor = "pointer";
               var d = "";
               var y = "";
                            span.onclick = function () {
                                var bdy1 = document.getElementById("bdy1");
                                var t = bdy1.getElementsByTagName("tr");
                                d = t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value;
                                y = t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].value;
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].removeAttribute("readonly");
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].removeAttribute("disabled");
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].removeAttribute("disabled");
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "none";
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "none";
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "inline-block";
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[4].style.display = "inline-block";
                            };
                            var span2 = document.createElement("a");
                            span2.style.cursor = "pointer";
               span2.onclick = function () {
                   document.getElementById("bdy1").deleteRow(this.parentNode.parentNode.rowIndex - 1);
                   if (t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("td")[3].innerHTML!="") {
                        $.ajax({
                        type: 'POST',
                        url: '@Url.Action("RandevuSil", "Satis")',
                            data: JSON.stringify({ "INCKEY": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("td")[3].innerHTML }),
                                contentType: "application/json",
                                success: function () {
                                    const Toast = Swal.mixin({
                                        toast: true,
                                        position: 'center',
                                        showConfirmButton: false,
                                        timer: 3000,
                                        timerProgressBar: true,
                                        didOpen: (toast) => {
                                            toast.addEventListener('mouseenter', Swal.stopTimer)
                                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                                        }
                                    })

                                    Toast.fire({
                                        icon: 'success',
                                        title: 'Ziyaret başarıyla silindi!'
                                    });
                                },
                                error: function () {

                                },
                                dataType: 'json'
                            });
                   }
               };
                            span2.innerHTML = "<i class='bx bx-trash bx-md bx-tada-hover'></i>";
                            var span3 = document.createElement("a");
                            span3.innerHTML = "<i class='bx bx-like bx-md bx-tada-hover'></i>";
                            span3.style.cursor = "pointer";
                            span3.onclick = function () {
                                Swal.fire({
                                    title: 'Ziyaret Onay',
                                    text: "Ziyareti gerçekleşti olarak güncellemek istediğinize emin misiniz?",
                                    icon: 'warning',
                                    showCancelButton: true,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    cancelButtonText:'Hayır',
                                    confirmButtonText: 'Evet, güncelle'
                                }).then((result) => {
                                    if (result.isConfirmed) {
                                       $.ajax({
                                type: 'POST',
                                           url: '@Url.Action("RandevuGerceklesen", "Satis")',
                                           data: JSON.stringify({ "id": parseInt(td5.innerHTML) }),
                                contentType: "application/json",
                                success: function () {
                                    const Toast = Swal.mixin({
                                        toast: true,
                                        position: 'center',
                                        showConfirmButton: false,
                                        timer: 3000,
                                        timerProgressBar: true,
                                        didOpen: (toast) => {
                                            toast.addEventListener('mouseenter', Swal.stopTimer)
                                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                                        }
                                    })

                                    Toast.fire({
                                        icon: 'success',
                                        title: 'Ziyaret başarıyla güncellendi!'
                                    });
                                    musterichange(document.getElementById("musteriselect").value);
                                },
                                error: function () {

                                },
                                dataType: 'json'
                            });
                                    }
                                })
                            }
               var span4 = document.createElement("a");
               span3.style.display = "none";
               span2.style.display = "none";
               span.style.display = "none";
                            span4.innerHTML = "<i class='bx bx-md bxs-check-circle bx-md bx-tada-hover'></i>";
               span4.style.cursor = "pointer";
               span4.onclick = function () {
                   var bdy1 = document.getElementById("bdy1");
                   var t = bdy1.getElementsByTagName("tr");
                   d = t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value;
                   t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].setAttribute("readonly","");
                   t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                   t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].setAttribute("disabled", "true");
                   t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                   t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                   t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "inline-block";
                   t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                   t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[4].style.display = "none";
                         $.ajax({
                        type: 'POST',
                        url: '@Url.Action("RandevuEkleGuncelle", "Satis")',
                             data: JSON.stringify({ "INCKEY": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("td")[3].innerHTML, "MUSTERI_ID": parseInt(document.getElementById("musteriselect").value), "RANDEVU_NOTU": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].value, "PLANLANAN_TARIH": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value }),
                                contentType: "application/json",
                                success: function () {
                                    const Toast = Swal.mixin({
                                        toast: true,
                                        position: 'center',
                                        showConfirmButton: false,
                                        timer: 3000,
                                        timerProgressBar: true,
                                        didOpen: (toast) => {
                                            toast.addEventListener('mouseenter', Swal.stopTimer)
                                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                                        }
                                    })

                                    Toast.fire({
                                        icon: 'success',
                                        title: 'Ziyaret başarıyla güncellendi!'
                                    });
                                    musterichange(parseInt(document.getElementById("musteriselect").value));
                                },
                                error: function () {

                                },
                                dataType: 'json'
                            });
               }
                            var span5 = document.createElement("a");
                            span5.style.cursor = "pointer";
                            span5.onclick = function () {
                                var bdy1 = document.getElementById("bdy1");
                                var t = bdy1.getElementsByTagName("tr");
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("textarea")[0].setAttribute("readonly","");
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value = d;
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].setAttribute("disabled", "true");
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[1].value = y;
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "inline-block";
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                                t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[4].style.display = "none";
                            };
                            span5.innerHTML = "<i class='bx bxs-x-circle bx-md bx-tada-hover'></i>";

                            td.innerHTML = "<label class='label text-center mb-2'><b>ZİYARET TARİHİ</b></label><input class='form-control' style='width:100%' type='datetime-local' value=''></input>";
                            td2.innerHTML = "<label class='label text-center mb-2'><b>GERCEKLEŞME TARİHİ</b></label><input class='form-control' style='width:100%' type='datetime-local' value=''></input>";
                            td3.innerHTML = "<label class='label text-center  mb-2'><b>ZİYARET NOTU</b></label><textarea class='form-control' placeholder='Not' rows='4' cols='50'></textarea>";
                            tr.appendChild(td);
               tr.appendChild(td2);
                            tr.appendChild(td3);
                            td4.appendChild(span);
                            td4.appendChild(span2);
                            td4.appendChild(span3);
                            td4.appendChild(span4);
                            td4.appendChild(span5);
                            tr.appendChild(td4);
                            tr.appendChild(td5);

                            document.getElementById("bdy1").appendChild(tr);

            }
            function addRw1() {

                var tr = document.createElement("tr");
                var td = document.createElement("td");
                var urungrubu = document.createElement("select");
                urungrubu.className = "form-select";


                for (let a = 0; a < urungruplari.length; a++) {
                    var opt = document.createElement("option");
                    opt.innerHTML = urungruplari[a].URUN_GRUBU;
                    opt.value = urungruplari[a].ID;
                    urungrubu.appendChild(opt);
                }

                td.appendChild(urungrubu);
                var td2 = document.createElement("td");
                var input2 = document.createElement("input");
                input2.className = "form-control";
                input2.type = "text";
                input2.onkeydown = function (event) {
                    var key = event.which;
                    if (((key < 48 || key > 57) && (key < 96 || key > 105)) && key != 8) event.preventDefault();
                }
                input2.onkeyup = function (event) {

                    var value = this.value.replace(/,/g, "");
                    this.dataset.currentValue = parseInt(value);
                    var caret = value.length - 1;
                    while ((caret - 3) > -1) {
                        caret -= 3;
                        value = value.split('');
                        value.splice(caret + 1, 0, ",");
                        value = value.join('');
                    }
                    this.value = value;
                }
                td2.appendChild(input2);

                var td3 = document.createElement("td");

                td3.innerHTML = "<select class='form-select hop'><option value='AD'>AD</option> <option value='KG'>KG</option><option value='MT'>MT</option> <option value='M2'>M2</option><option value='M3'>M3</option><option value='PK'>PK</option></select> ";
                td3.setAttribute("name", "bstable-select");
                var td5 = document.createElement("td");
                var span = document.createElement("a");
                span.innerHTML = "<i class='bx bx-edit bx-md bx-tada-hover'></i>"
                span.style.cursor = "pointer";
                span.onclick = function () {
                    var bdy1 = document.getElementById("bdy");
                    var t = bdy1.getElementsByTagName("tr");
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].removeAttribute("disabled");
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].removeAttribute("disabled");
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "none";
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "none";
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "inline-block";
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "inline-block";
                };
                var span2 = document.createElement("a");
                span2.style.cursor = "pointer";
                span2.onclick = function () {
                    document.getElementById("bdy").deleteRow(this.parentNode.parentNode.rowIndex - 1);
                    if (t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].value != "") {
                        $.ajax({
                            type: 'POST',
                            url: '@Url.Action("UrunSil", "Satis")',
                            data: JSON.stringify({ "MUSTERI_ID": document.getElementById("musteriselect").value, "URUN_ID": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].value }),
                            contentType: "application/json",
                            success: function () {
                                const Toast = Swal.mixin({
                                    toast: true,
                                    position: 'center',
                                    showConfirmButton: false,
                                    timer: 3000,
                                    timerProgressBar: true,
                                    didOpen: (toast) => {
                                        toast.addEventListener('mouseenter', Swal.stopTimer)
                                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                                    }
                                })

                                Toast.fire({
                                    icon: 'success',
                                    title: 'Ürün başarıyla silindi!'
                                });
                            },
                            error: function () {

                            },
                            dataType: 'json'
                        });
                    }
                };
                span2.innerHTML = "<i class='bx bx-trash bx-md bx-tada-hover'></i>";

                var span4 = document.createElement("a");

                span2.style.display = "none";
                span.style.display = "none";
                span4.innerHTML = "<i class='bx bx-md bxs-check-circle bx-md bx-tada-hover'></i>";
                span4.style.cursor = "pointer";
                span4.onclick = function () {
                    var bdy1 = document.getElementById("bdy");
                    var t = bdy1.getElementsByTagName("tr");
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].setAttribute("disabled", "true");
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                    $.ajax({
                        type: 'POST',
                        url: '@Url.Action("UrunGonder", "Satis")',
                        data: JSON.stringify({ "URUN_ID": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].value, "URUN_GRUBU": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].options[t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].selectedIndex].text, "OLCU_BIRIMI": t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[1].value, "YILLIK_KULLANIM": parseInt(t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].value.replace(',', '')), "MUSTERI_ID": document.getElementById("musteriselect").value }),
                        contentType: "application/json",
                        success: function () {
                            const Toast = Swal.mixin({
                                toast: true,
                                position: 'center',
                                showConfirmButton: false,
                                timer: 3000,
                                timerProgressBar: true,
                                didOpen: (toast) => {
                                    toast.addEventListener('mouseenter', Swal.stopTimer)
                                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                                }
                            })

                            Toast.fire({
                                icon: 'success',
                                title: 'Ürün başarıyla eklendi!'
                            });
                            musterichange(parseInt(document.getElementById("musteriselect").value));
                        },
                        error: function () {

                        },
                        dataType: 'json'
                    });

                }
                var span5 = document.createElement("a");
                span5.style.cursor = "pointer";
                span5.onclick = function () {
                    var bdy1 = document.getElementById("bdy");
                    var t = bdy1.getElementsByTagName("tr");
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("select")[0].setAttribute("disabled", "true");
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("input")[0].setAttribute("disabled", "true");
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[0].style.display = "inline-block";
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[1].style.display = "inline-block";
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[2].style.display = "none";
                    t[this.parentNode.parentNode.rowIndex - 1].getElementsByTagName("a")[3].style.display = "none";
                };
                span5.innerHTML = "<i class='bx bxs-x-circle bx-md bx-tada-hover'></i>";
                tr.appendChild(td);
                tr.appendChild(td2);
                tr.appendChild(td3);
                td5.appendChild(span);
                td5.appendChild(span2);
                td5.appendChild(span4);
                td5.appendChild(span5);
                tr.appendChild(td5);

                document.getElementById("bdy").appendChild(tr);

                $('.hop').select2({
                    dropdownParent: $('#basicModal'),
                    width: 'resolve'
                });

            }
            $('#basicModal').on('hidden.bs.modal', function () {
                $('#closebtn').show()
            })
            function plasiyerdegistir() {

                if (event.currentTarget.checked) {
                    document.getElementById("plasiyer").removeAttribute("onchange");
                } else {
                    document.getElementById("plasiyer").setAttribute("onchange","plasiyerchange(this.value)");
                }

            }
        </script>

    </div>
</body>
</html>
